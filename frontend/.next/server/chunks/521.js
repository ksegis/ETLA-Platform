"use strict";exports.id=521,exports.ids=[521],exports.modules={411:(e,r,t)=>{t.d(r,{A:()=>s});let s=(0,t(9377).A)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2643:(e,r,t)=>{t.d(r,{$:()=>a});var s=t(687),o=t(3210),n=t(4780);let a=o.forwardRef(({className:e,variant:r="default",size:t="default",...o},a)=>(0,s.jsx)("button",{className:(0,n.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-blue-600 text-white hover:bg-blue-700":"default"===r,"bg-red-600 text-white hover:bg-red-700":"destructive"===r,"border border-gray-300 bg-white hover:bg-gray-50":"outline"===r,"bg-gray-100 text-gray-900 hover:bg-gray-200":"secondary"===r,"hover:bg-gray-100":"ghost"===r,"text-blue-600 underline-offset-4 hover:underline":"link"===r},{"h-10 px-4 py-2":"default"===t,"h-9 rounded-md px-3":"sm"===t,"h-11 rounded-md px-8":"lg"===t,"h-10 w-10":"icon"===t},e),ref:a,...o}));a.displayName="Button"},3106:(e,r,t)=>{t.d(r,{A:()=>s});let s=(0,t(9377).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},3435:(e,r,t)=>{t.d(r,{A:()=>s});let s=(0,t(9377).A)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},4870:(e,r,t)=>{t.d(r,{A:()=>s});let s=(0,t(9377).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},6075:(e,r,t)=>{t.d(r,{K:()=>n});var s=t(9285);class o{constructor(){this.currentUserId="demo-user-id",this.currentTenantId="54afbd1d-e72a-41e1-9d39-2c8a08a257ff",this.isInitialized=!1,this.supabase=(0,s.UU)(process.env.NEXT_PUBLIC_SUPABASE_URL||"",process.env.NEXT_PUBLIC_SUPABASE_ANON_TOKEN||""),console.log("\uD83D\uDD27 PMBOK Service: Created with default demo context")}async initialize(e,r){e&&r?(this.currentUserId=e,this.currentTenantId=r,this.isInitialized=!0,console.log("✅ PMBOK Service: Initialized with user context:",{userId:e,tenantId:r})):console.log("⚠️ PMBOK Service: Using demo context - no user/tenant provided")}updateUserContext(e,r){(this.currentUserId!==e||this.currentTenantId!==r)&&(console.log("\uD83D\uDD04 PMBOK Service: Updating user context:",{from:{userId:this.currentUserId,tenantId:this.currentTenantId},to:{userId:e,tenantId:r}}),this.currentUserId=e,this.currentTenantId=r,this.isInitialized=!0)}async handleMissingCustomers(e){let r=Array.from(new Set(e.map(e=>e.customer_id).filter(Boolean)));if(0===r.length)return console.log("⚠️ No customer IDs found in work requests"),e.map(e=>({...e,customer_name:"Unknown Customer"}));try{console.log("\uD83D\uDC65 Fetching customer information for IDs:",r);let{data:t,error:s}=await this.supabase.from("profiles").select("id, name, email").in("id",r);if(s)return console.error("❌ Error fetching customer profiles:",s),e.map(e=>({...e,customer_name:"Unknown Customer"}));console.log("✅ Profile query succeeded, found:",t?.length||0,"profiles");let o=new Map;return t?.forEach(e=>{o.set(e.id,e.name||e.email||"Unknown Customer")}),e.map(e=>({...e,customer_name:o.get(e.customer_id)||"Missing Customer"}))}catch(r){return console.error("❌ Exception during customer lookup:",r),e.map(e=>({...e,customer_name:"Unknown Customer"}))}}async getWorkRequests(){try{console.log("\uD83D\uDD0D Loading work requests from database..."),console.log("\uD83C\uDFE2 Current context:",{userId:this.currentUserId,tenantId:this.currentTenantId,initialized:this.isInitialized});let{data:e,error:r}=await this.supabase.from("work_requests").select("*").eq("tenant_id",this.currentTenantId).order("created_at",{ascending:!1});if(r)throw console.error("❌ Error fetching work requests:",r),r;if(console.log("✅ Work requests query succeeded, found:",e?.length||0,"records"),e&&e.length>0){console.log("\uD83D\uDCCB Sample work request:",e[0]);let r=await this.handleMissingCustomers(e);return console.log("✅ Data transformation completed, returning",r.length,"records"),r}return[]}catch(e){return console.error("❌ Error in getWorkRequests:",e),[]}}async getProjects(){try{console.log("\uD83D\uDCCA Loading projects from database...");let{data:e,error:r}=await this.supabase.from("project_charters").select("*").eq("tenant_id",this.currentTenantId).order("created_at",{ascending:!1});if(r)throw console.error("❌ Error fetching projects:",r),r;return console.log("✅ Projects query succeeded, found:",e?.length||0,"records"),e||[]}catch(e){return console.error("❌ Error in getProjects:",e),[]}}async getRisks(){try{console.log("⚠️ Loading risks from database...");let{data:e,error:r}=await this.supabase.from("risks").select("*").eq("tenant_id",this.currentTenantId).order("created_at",{ascending:!1});if(r)throw console.error("❌ Error fetching risks:",r),r;return console.log("✅ Risks query succeeded, found:",e?.length||0,"records"),e||[]}catch(e){return console.error("❌ Error in getRisks:",e),[]}}async approveWorkRequest(e,r){try{console.log("✅ Approving work request:",e);let{error:r}=await this.supabase.from("work_requests").update({approval_status:"converted_to_project",approved_by:this.currentUserId,approved_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e).eq("tenant_id",this.currentTenantId);if(r)return console.error("❌ Error updating work request:",r),{success:!1,error:r.message};return console.log("✅ Work request approved successfully"),{success:!0,projectId:`proj_${Date.now()}`}}catch(e){return console.error("❌ Error in approveWorkRequest:",e),{success:!1,error:"Failed to approve work request"}}}async declineWorkRequest(e,r){try{console.log("❌ Declining work request:",e,"Reason:",r);let{error:t}=await this.supabase.from("work_requests").update({approval_status:"declined",decline_reason:r,reviewed_by:this.currentUserId,reviewed_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e).eq("tenant_id",this.currentTenantId);if(t)return console.error("❌ Error declining work request:",t),{success:!1,error:t.message};return console.log("✅ Work request declined successfully"),{success:!0}}catch(e){return console.error("❌ Error in declineWorkRequest:",e),{success:!1,error:"Failed to decline work request"}}}async setWorkRequestUnderReview(e){try{console.log("\uD83D\uDD0D Setting work request under review:",e);let{error:r}=await this.supabase.from("work_requests").update({approval_status:"under_review",reviewed_by:this.currentUserId,reviewed_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e).eq("tenant_id",this.currentTenantId);if(r)return console.error("❌ Error setting work request under review:",r),{success:!1,error:r.message};return console.log("✅ Work request set under review successfully"),{success:!0}}catch(e){return console.error("❌ Error in setWorkRequestUnderReview:",e),{success:!1,error:"Failed to set work request under review"}}}async createMissingCustomer(e,r){try{console.log("\uD83D\uDC64 Creating missing customer:",{name:e,email:r});let t=`cust_${Date.now()}`,{data:s,error:o}=await this.supabase.from("profiles").insert({id:t,name:e,email:r,tenant_id:this.currentTenantId,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(o)return console.error("❌ Error creating customer:",o),{success:!1,error:o.message};return console.log("✅ Customer created successfully:",t),{success:!0,customerId:t}}catch(e){return console.error("❌ Error in createMissingCustomer:",e),{success:!1,error:"Failed to create customer"}}}async linkWorkRequestToCustomer(e,r){try{console.log("\uD83D\uDD17 Linking work request to customer:",{workRequestId:e,customerId:r});let{error:t}=await this.supabase.from("work_requests").update({customer_id:r,updated_at:new Date().toISOString()}).eq("id",e).eq("tenant_id",this.currentTenantId);if(t)return console.error("❌ Error linking work request to customer:",t),{success:!1,error:t.message};return console.log("✅ Work request linked to customer successfully"),{success:!0}}catch(e){return console.error("❌ Error in linkWorkRequestToCustomer:",e),{success:!1,error:"Failed to link work request to customer"}}}async getAvailableCustomers(){try{let{data:e,error:r}=await this.supabase.from("profiles").select("id, name, email").eq("tenant_id",this.currentTenantId).order("name",{ascending:!0});if(r)return console.error("❌ Error fetching available customers:",r),[];return e||[]}catch(e){return console.error("❌ Error in getAvailableCustomers:",e),[]}}async getWorkRequestStats(){try{let e=await this.getWorkRequests();return{total:e.length,pending:e.filter(e=>"submitted"===e.approval_status||"under_review"===e.approval_status||"submitted"===e.status||"under_review"===e.status).length,approved:e.filter(e=>"approved"===e.approval_status).length,declined:e.filter(e=>"declined"===e.approval_status).length,converted:e.filter(e=>"converted_to_project"===e.approval_status).length}}catch(e){return console.error("❌ Error getting work request stats:",e),{total:0,pending:0,approved:0,declined:0,converted:0}}}}let n=new o},6228:(e,r,t)=>{t.d(r,{A:()=>s});let s=(0,t(9377).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},8520:(e,r,t)=>{t.d(r,{A:()=>s});let s=(0,t(9377).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},8749:(e,r,t)=>{t.d(r,{BT:()=>l,Wu:()=>d,ZB:()=>c,Zp:()=>a,aR:()=>i});var s=t(687),o=t(3210),n=t(4780);let a=o.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border border-gray-200 bg-white text-gray-950 shadow-sm",e),...r}));a.displayName="Card";let i=o.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...r}));i.displayName="CardHeader";let c=o.forwardRef(({className:e,...r},t)=>(0,s.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));c.displayName="CardTitle";let l=o.forwardRef(({className:e,...r},t)=>(0,s.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-gray-500",e),...r}));l.displayName="CardDescription";let d=o.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",e),...r}));d.displayName="CardContent",o.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",e),...r})).displayName="CardFooter"},9446:(e,r,t)=>{t.d(r,{A:()=>s});let s=(0,t(9377).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},9720:(e,r,t)=>{t.d(r,{A:()=>s});let s=(0,t(9377).A)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},9987:(e,r,t)=>{t.d(r,{A:()=>s});let s=(0,t(9377).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])}};