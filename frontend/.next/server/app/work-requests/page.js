(()=>{var e={};e.id=415,e.ids=[415],e.modules={2643:(e,t,s)=>{"use strict";s.d(t,{$:()=>l});var r=s(60687),i=s(43210),a=s(4780);let l=i.forwardRef(({className:e,variant:t="default",size:s="default",...i},l)=>(0,r.jsx)("button",{className:(0,a.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-blue-600 text-white hover:bg-blue-700":"default"===t,"bg-red-600 text-white hover:bg-red-700":"destructive"===t,"border border-gray-300 bg-white hover:bg-gray-50":"outline"===t,"bg-gray-100 text-gray-900 hover:bg-gray-200":"secondary"===t,"hover:bg-gray-100":"ghost"===t,"text-blue-600 underline-offset-4 hover:underline":"link"===t},{"h-10 px-4 py-2":"default"===s,"h-9 rounded-md px-3":"sm"===s,"h-11 rounded-md px-8":"lg"===s,"h-10 w-10":"icon"===s},e),ref:l,...i}));l.displayName="Button"},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29374:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>A});var r=s(60687),i=s(43210),a=s(49987),l=s(78520),n=s(9362),d=s(94870),o=s(80761),c=s(71787),u=s(30983),m=s(85215),x=s(69202),p=s(7130),h=s(26228),g=s(89082),b=s(77473),j=s(2643),f=s(51907),y=s(28749),v=s(71170),N=s(60149);let _=({isOpen:e,onClose:t,onSave:s,request:a=null,title:l="Create New Work Request",userRole:n,availableTenants:d=[],selectedCustomerId:o,onCustomerChange:c})=>{let[u,m]=(0,i.useState)({title:"",description:"",category:"",priority:"medium",urgency:"medium",status:"submitted",business_justification:"",impact_assessment:"",budget:"",estimated_budget:"",required_completion_date:"",requested_completion_date:"",estimated_hours:""}),[x,p]=(0,i.useState)({});(0,i.useEffect)(()=>{a?m({title:a.title||"",description:a.description||"",category:a.category||"",priority:a.priority||"medium",urgency:a.urgency||"medium",status:a.status||"submitted",business_justification:a.business_justification||"",impact_assessment:a.impact_assessment||"",budget:a.budget?.toString()||"",estimated_budget:a.estimated_budget?.toString()||"",required_completion_date:a.required_completion_date||"",requested_completion_date:a.requested_completion_date||"",estimated_hours:a.estimated_hours?.toString()||""}):m({title:"",description:"",category:"",priority:"medium",urgency:"medium",status:"submitted",business_justification:"",impact_assessment:"",budget:"",estimated_budget:"",required_completion_date:"",requested_completion_date:"",estimated_hours:""}),p({})},[a,e]);let h=()=>{let e={};return u.title.trim()?u.title.length>255&&(e.title="Title must be 255 characters or less"):e.title="Title is required",u.description.trim()||(e.description="Description is required"),u.category.trim()?u.category.length>100&&(e.category="Category must be 100 characters or less"):e.category="Category is required",u.budget&&isNaN(parseFloat(u.budget))&&(e.budget="Budget must be a valid number"),u.estimated_budget&&isNaN(parseFloat(u.estimated_budget))&&(e.estimated_budget="Estimated budget must be a valid number"),u.estimated_hours&&isNaN(parseInt(u.estimated_hours))&&(e.estimated_hours="Estimated hours must be a valid number"),p(e),0===Object.keys(e).length};return e?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-6 border-b",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:l}),(0,r.jsx)(j.$,{variant:"ghost",size:"sm",onClick:t,children:(0,r.jsx)(b.A,{className:"h-4 w-4"})})]}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),h()&&s({title:u.title.trim(),description:u.description.trim(),category:u.category.trim(),priority:u.priority,urgency:u.urgency,status:u.status,business_justification:u.business_justification.trim()||void 0,impact_assessment:u.impact_assessment.trim()||void 0,budget:u.budget?parseFloat(u.budget):void 0,estimated_budget:u.estimated_budget?parseFloat(u.estimated_budget):void 0,required_completion_date:u.required_completion_date||void 0,requested_completion_date:u.requested_completion_date||void 0,estimated_hours:u.estimated_hours?parseInt(u.estimated_hours):void 0})},className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Basic Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),(0,r.jsx)(f.p,{value:u.title,onChange:e=>m(t=>({...t,title:e.target.value})),placeholder:"Enter work request title",maxLength:255,className:x.title?"border-red-500":""}),x.title&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x.title})]}),("host_admin"===n||"primary_customer_admin"===n)&&d.length>0&&(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer/Tenant *"}),(0,r.jsxs)("select",{value:o||"",onChange:e=>c?.(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Select Customer/Tenant"}),d.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),(0,r.jsxs)("select",{value:u.category,onChange:e=>m(t=>({...t,category:e.target.value})),className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${x.category?"border-red-500":""}`,children:[(0,r.jsx)("option",{value:"",children:"Select Category"}),(0,r.jsx)("option",{value:"development",children:"Development"}),(0,r.jsx)("option",{value:"infrastructure",children:"Infrastructure"}),(0,r.jsx)("option",{value:"security",children:"Security"}),(0,r.jsx)("option",{value:"maintenance",children:"Maintenance"}),(0,r.jsx)("option",{value:"enhancement",children:"Enhancement"}),(0,r.jsx)("option",{value:"support",children:"Support"}),(0,r.jsx)("option",{value:"training_support",children:"Training Support"}),(0,r.jsx)("option",{value:"database",children:"Database"}),(0,r.jsx)("option",{value:"web_development",children:"Web Development"}),(0,r.jsx)("option",{value:"general",children:"General"})]}),x.category&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x.category})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority *"}),(0,r.jsxs)("select",{value:u.priority,onChange:e=>m(t=>({...t,priority:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"low",children:"Low"}),(0,r.jsx)("option",{value:"medium",children:"Medium"}),(0,r.jsx)("option",{value:"high",children:"High"}),(0,r.jsx)("option",{value:"critical",children:"Critical"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Urgency *"}),(0,r.jsxs)("select",{value:u.urgency,onChange:e=>m(t=>({...t,urgency:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"low",children:"Low"}),(0,r.jsx)("option",{value:"medium",children:"Medium"}),(0,r.jsx)("option",{value:"high",children:"High"}),(0,r.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,r.jsxs)("select",{value:u.status,onChange:e=>m(t=>({...t,status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"submitted",children:"Submitted"}),(0,r.jsx)("option",{value:"under_review",children:"Under Review"}),(0,r.jsx)("option",{value:"approved",children:"Approved"}),(0,r.jsx)("option",{value:"rejected",children:"Rejected"}),(0,r.jsx)("option",{value:"scheduled",children:"Scheduled"}),(0,r.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,r.jsx)("option",{value:"completed",children:"Completed"}),(0,r.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,r.jsx)("textarea",{value:u.description,onChange:e=>m(t=>({...t,description:e.target.value})),placeholder:"Describe the work request in detail",rows:4,className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${x.description?"border-red-500":""}`}),x.description&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x.description})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Budget and Timeline"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Budget"}),(0,r.jsx)(f.p,{type:"number",value:u.budget,onChange:e=>m(t=>({...t,budget:e.target.value})),placeholder:"0.00",min:"0",step:"0.01",className:x.budget?"border-red-500":""}),x.budget&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x.budget})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Budget"}),(0,r.jsx)(f.p,{type:"number",value:u.estimated_budget,onChange:e=>m(t=>({...t,estimated_budget:e.target.value})),placeholder:"0.00",min:"0",step:"0.01",className:x.estimated_budget?"border-red-500":""}),x.estimated_budget&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x.estimated_budget})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Hours"}),(0,r.jsx)(f.p,{type:"number",value:u.estimated_hours,onChange:e=>m(t=>({...t,estimated_hours:e.target.value})),placeholder:"0",min:"0",step:"1",className:x.estimated_hours?"border-red-500":""}),x.estimated_hours&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x.estimated_hours})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Required Completion Date"}),(0,r.jsx)(f.p,{type:"date",value:u.required_completion_date,onChange:e=>m(t=>({...t,required_completion_date:e.target.value}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Requested Completion Date"}),(0,r.jsx)(f.p,{type:"date",value:u.requested_completion_date,onChange:e=>m(t=>({...t,requested_completion_date:e.target.value}))})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Additional Information"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Justification"}),(0,r.jsx)("textarea",{value:u.business_justification,onChange:e=>m(t=>({...t,business_justification:e.target.value})),placeholder:"Explain the business need and expected benefits",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Impact Assessment"}),(0,r.jsx)("textarea",{value:u.impact_assessment,onChange:e=>m(t=>({...t,impact_assessment:e.target.value})),placeholder:"Describe the potential impact if this request is not fulfilled",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,r.jsx)(j.$,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),(0,r.jsx)(j.$,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:a?"Update Request":"Create Request"})]})]})]})}):null};var w=s(16391),k=s(13732),q=s(61523);let C={submitted:{icon:a.A,color:"text-blue-600",bg:"bg-blue-100",label:"Submitted"},under_review:{icon:l.A,color:"text-yellow-600",bg:"bg-yellow-100",label:"Under Review"},approved:{icon:n.A,color:"text-green-600",bg:"bg-green-100",label:"Approved"},rejected:{icon:d.A,color:"text-red-600",bg:"bg-red-100",label:"Rejected"},scheduled:{icon:o.A,color:"text-purple-600",bg:"bg-purple-100",label:"Scheduled"},in_progress:{icon:a.A,color:"text-indigo-600",bg:"bg-indigo-100",label:"In Progress"},completed:{icon:n.A,color:"text-green-600",bg:"bg-green-100",label:"Completed"},cancelled:{icon:d.A,color:"text-gray-600",bg:"bg-gray-100",label:"Cancelled"}};function A(){let[e,t]=(0,i.useState)([]),[s,o]=(0,i.useState)([]),[A,S]=(0,i.useState)(!0),[E,R]=(0,i.useState)(null),[P,D]=(0,i.useState)(""),[$,T]=(0,i.useState)(""),[I,z]=(0,i.useState)(""),[L,W]=(0,i.useState)(""),[B,F]=(0,i.useState)("list"),[U,Z]=(0,i.useState)(!1),[M,O]=(0,i.useState)(!1),[G,H]=(0,i.useState)(!1),[K,X]=(0,i.useState)(null),[J,V]=(0,i.useState)(""),[Q,Y]=(0,i.useState)([]),ee=async()=>{if(ei?.role==="host_admin")try{let{data:e,error:t}=await w.ND.from("tenants").select("id, name").order("name");if(t)throw t;Y(e||[])}catch(e){console.error("Error loading tenants:",e)}else ei?.role==="primary_customer_admin"&&ea&&(Y([{id:ea.id,name:ea.name}]),V(ea.id))},[et,es]=(0,i.useState)({total:0,submitted:0,under_review:0,approved:0,in_progress:0,completed:0}),{user:er,tenantUser:ei}=(0,k.h)(),{selectedTenant:ea}=(0,q.Ku)(),el=(0,q.wz)(),{isMultiTenant:en,availableTenants:ed}=(0,q.un)(),eo=async()=>{if(!el||0===el.length){console.log("No accessible tenants, skipping load"),S(!1);return}try{S(!0),R(null),console.log("Loading work requests for tenants:",el);let{data:e,error:s}=await w.ND.from("work_requests").select("*").in("tenant_id",el).order("created_at",{ascending:!1});if(s){console.error("Database query error:",s),R(`Failed to load work requests: ${s.message||"Unknown error"}`),t([]),o([]);return}console.log("Loaded work requests from all tenants:",e),t(e||[]),o(e||[]);let r={total:e?.length||0,submitted:e?.filter(e=>"submitted"===e.status).length||0,under_review:e?.filter(e=>"under_review"===e.status).length||0,approved:e?.filter(e=>"approved"===e.status).length||0,in_progress:e?.filter(e=>"in_progress"===e.status).length||0,completed:e?.filter(e=>"completed"===e.status).length||0};es(r)}catch(e){console.error("Error loading work requests:",e),R("Failed to load work requests"),t([]),o([])}finally{S(!1)}},ec=async e=>{if(!ea?.id||!er?.id)return void R("Missing tenant or user information");try{let s;ei?.role==="host_admin"?(s=er.id,console.log("Using host_admin user ID as customer_id:",s)):(ei?.role==="client_admin"||ei?.role,s=er.id),console.log("Determined customer_id (profile ID):",s,"for user role:",ei?.role);let r={tenant_id:ea.id,title:e.title,description:e.description,category:e.category,priority:e.priority,urgency:e.urgency||"medium",customer_id:s,status:e.status||"submitted",assigned_to:null,estimated_hours:e.estimated_hours||null,actual_hours:0,budget:e.budget||null,estimated_budget:e.estimated_budget||null,required_completion_date:e.required_completion_date||null,requested_completion_date:e.requested_completion_date||null,scheduled_start_date:null,scheduled_end_date:null,actual_start_date:null,actual_completion_date:null,rejection_reason:null,internal_notes:null,customer_notes:null,tags:null,attachments:[],request_id:null,approval_status:"submitted",decline_reason:null,approved_by:null,approved_at:null,project_id:null,business_justification:e.business_justification||null,impact_assessment:e.impact_assessment||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("Creating work request with proper mapping:",r);let{data:i,error:a}=await w.ND.from("work_requests").insert([r]).select().single();if(a){console.error("Error creating work request:",a),console.error("Error details:",{message:a.message,details:a.details,hint:a.hint,code:a.code}),console.error("Request data that failed:",r),R(`Failed to create work request: ${a.message}`);return}console.log("Created work request:",i),t(e=>[i,...e]),Z(!1),eo(),R(null)}catch(e){console.error("Error creating work request:",e),R("Failed to create work request. Please try again.")}},eu=async e=>{if(!K?.id)return void R("No request selected for update");try{let s={title:e.title,description:e.description,category:e.category,priority:e.priority,urgency:e.urgency,status:e.status,budget:e.budget||null,estimated_budget:e.estimated_budget||null,estimated_hours:e.estimated_hours||null,required_completion_date:e.required_completion_date||null,requested_completion_date:e.requested_completion_date||null,business_justification:e.business_justification||null,impact_assessment:e.impact_assessment||null,updated_at:new Date().toISOString()};console.log("Updating work request with proper mapping:",s);let{data:r,error:i}=await w.ND.from("work_requests").update(s).eq("id",K.id).select().single();if(i){console.error("Error updating work request:",i),R(`Failed to update work request: ${i.message}`);return}console.log("Updated work request:",r),t(e=>e.map(e=>e.id===K.id?r:e)),O(!1),X(null),R(null)}catch(e){console.error("Error updating work request:",e),R("Failed to update work request. Please try again.")}},em=async e=>{if(confirm("Are you sure you want to delete this work request?"))try{let{error:s}=await w.ND.from("work_requests").delete().eq("id",e);if(s){console.error("Error deleting work request:",s),R(`Failed to delete work request: ${s.message}`);return}t(t=>t.filter(t=>t.id!==e)),eo(),R(null)}catch(e){console.error("Error deleting work request:",e),R("Failed to delete work request. Please try again.")}};(0,i.useEffect)(()=>{eo(),ee()},[el.join(","),ei?.role]);let ex=e=>new Date(e).toLocaleDateString(),ep=e=>e.title||`Request ${e.id?.slice(0,8)}`,eh=e=>e.budget||e.estimated_budget||0;return(0,r.jsx)(N.A,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[E&&(0,r.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(d.A,{className:"h-5 w-5 text-red-400"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("p",{className:"text-sm text-red-700",children:E}),(0,r.jsx)("button",{onClick:()=>R(null),className:"text-red-700 underline text-sm mt-1",children:"Dismiss"})]})]})}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Work Requests"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Manage and track your work requests"})]}),(0,r.jsxs)(j.$,{onClick:()=>Z(!0),className:"bg-blue-600 hover:bg-blue-700",children:[(0,r.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"New Request"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[(0,r.jsx)(y.Zp,{children:(0,r.jsx)(y.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:et.total})]}),(0,r.jsx)(a.A,{className:"h-8 w-8 text-gray-400"})]})})}),(0,r.jsx)(y.Zp,{children:(0,r.jsx)(y.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Submitted"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:et.submitted})]}),(0,r.jsx)(a.A,{className:"h-8 w-8 text-blue-500"})]})})}),(0,r.jsx)(y.Zp,{children:(0,r.jsx)(y.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-yellow-600",children:"Under Review"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:et.under_review})]}),(0,r.jsx)(l.A,{className:"h-8 w-8 text-yellow-500"})]})})}),(0,r.jsx)(y.Zp,{children:(0,r.jsx)(y.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Approved"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-900",children:et.approved})]}),(0,r.jsx)(n.A,{className:"h-8 w-8 text-green-500"})]})})}),(0,r.jsx)(y.Zp,{children:(0,r.jsx)(y.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-indigo-600",children:"In Progress"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-indigo-900",children:et.in_progress})]}),(0,r.jsx)(a.A,{className:"h-8 w-8 text-indigo-500"})]})})}),(0,r.jsx)(y.Zp,{children:(0,r.jsx)(y.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Completed"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-900",children:et.completed})]}),(0,r.jsx)(n.A,{className:"h-8 w-8 text-green-500"})]})})})]}),(0,r.jsx)(y.Zp,{children:(0,r.jsx)(y.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,r.jsx)(f.p,{placeholder:"Search requests...",value:P,onChange:e=>D(e.target.value),className:"pl-10"})]})}),(0,r.jsxs)("select",{value:$,onChange:e=>T(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"All Status"}),(0,r.jsx)("option",{value:"submitted",children:"Submitted"}),(0,r.jsx)("option",{value:"under_review",children:"Under Review"}),(0,r.jsx)("option",{value:"approved",children:"Approved"}),(0,r.jsx)("option",{value:"rejected",children:"Rejected"}),(0,r.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,r.jsx)("option",{value:"completed",children:"Completed"})]}),(0,r.jsxs)("select",{value:I,onChange:e=>z(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"All Priority"}),(0,r.jsx)("option",{value:"low",children:"Low"}),(0,r.jsx)("option",{value:"medium",children:"Medium"}),(0,r.jsx)("option",{value:"high",children:"High"}),(0,r.jsx)("option",{value:"critical",children:"Critical"})]}),en&&(0,r.jsxs)("select",{value:L,onChange:e=>W(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"All Tenants"}),ed.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,r.jsxs)("div",{className:"flex border border-gray-300 rounded-md",children:[(0,r.jsx)(j.$,{variant:"list"===B?"default":"ghost",size:"sm",onClick:()=>F("list"),className:"rounded-r-none",children:(0,r.jsx)(m.A,{className:"h-4 w-4"})}),(0,r.jsx)(j.$,{variant:"grid"===B?"default":"ghost",size:"sm",onClick:()=>F("grid"),className:"rounded-l-none",children:(0,r.jsx)(x.A,{className:"h-4 w-4"})})]})]})})}),(0,r.jsxs)(y.Zp,{children:[(0,r.jsxs)(y.aR,{children:[(0,r.jsxs)(y.ZB,{children:["Work Requests (",s.length,")"]}),(0,r.jsxs)(y.BT,{children:[s.length," of ",e.length," requests",en?(0,r.jsxs)("span",{className:"ml-2",children:["| ",L?`Filtered to: ${ed.find(e=>e.id===L)?.name}`:`From ${ed.length} tenants`]}):ea&&(0,r.jsxs)("span",{className:"ml-2",children:["| Tenant: ",ea.name]})]})]}),(0,r.jsx)(y.Wu,{children:A?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Loading work requests..."})]}):0===s.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No work requests found"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:0===e.length?"Get started by creating your first work request.":"Try adjusting your search or filter criteria."}),0===e.length&&(0,r.jsxs)(j.$,{onClick:()=>Z(!0),children:[(0,r.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Create First Request"]})]}):"list"===B?(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Request"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Budget"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>{let t=C[e.status]?.icon||a.A,s=C[e.status]||C.submitted;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:ep(e)}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[e.description?.slice(0,100),"..."]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)(v.E,{variant:"approved"===e.status?"default":"secondary",children:[(0,r.jsx)(t,{className:"w-3 h-3 mr-1"}),s.label]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)(v.E,{variant:"high"===e.priority||"critical"===e.priority?"destructive":"secondary",children:e.priority||"medium"})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",eh(e).toLocaleString()]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ex(e.created_at)}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(j.$,{variant:"ghost",size:"sm",onClick:()=>{X(e),H(!0)},children:(0,r.jsx)(p.A,{className:"h-4 w-4"})}),(0,r.jsx)(j.$,{variant:"ghost",size:"sm",onClick:()=>{X(e),O(!0)},children:(0,r.jsx)(h.A,{className:"h-4 w-4"})}),(0,r.jsx)(j.$,{variant:"ghost",size:"sm",onClick:()=>em(e.id),children:(0,r.jsx)(g.A,{className:"h-4 w-4"})})]})})]},e.id)})})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>{let t=C[e.status]?.icon||a.A,s=C[e.status]||C.submitted;return(0,r.jsxs)(y.Zp,{className:"hover:shadow-lg transition-shadow",children:[(0,r.jsx)(y.aR,{children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(y.ZB,{className:"text-lg",children:ep(e)}),(0,r.jsxs)(y.BT,{children:[e.description?.slice(0,100),"..."]})]}),(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)(j.$,{variant:"ghost",size:"sm",onClick:()=>{X(e),H(!0)},children:(0,r.jsx)(p.A,{className:"h-4 w-4"})}),(0,r.jsx)(j.$,{variant:"ghost",size:"sm",onClick:()=>{X(e),O(!0)},children:(0,r.jsx)(h.A,{className:"h-4 w-4"})})]})]})}),(0,r.jsx)(y.Wu,{children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Status:"}),(0,r.jsxs)(v.E,{variant:"approved"===e.status?"default":"secondary",children:[(0,r.jsx)(t,{className:"w-3 h-3 mr-1"}),s.label]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Priority:"}),(0,r.jsx)(v.E,{variant:"high"===e.priority||"critical"===e.priority?"destructive":"secondary",children:e.priority||"medium"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Budget:"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:["$",eh(e).toLocaleString()]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Created:"}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:ex(e.created_at)})]})]})})]},e.id)})})})]}),(0,r.jsx)(_,{isOpen:U,onClose:()=>{Z(!1),V("")},onSave:ec,title:"Create New Work Request",userRole:ei?.role,availableTenants:Q,selectedCustomerId:J,onCustomerChange:V}),(0,r.jsx)(_,{isOpen:M,onClose:()=>{O(!1),X(null)},onSave:eu,request:K,title:"Edit Work Request",userRole:ei?.role,availableTenants:Q,selectedCustomerId:J,onCustomerChange:V}),G&&K&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"View Work Request"}),(0,r.jsx)(j.$,{variant:"ghost",size:"sm",onClick:()=>H(!1),children:(0,r.jsx)(b.A,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:K.title})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:K.description})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,r.jsx)(v.E,{className:"mt-1",children:K.status})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Priority"}),(0,r.jsx)(v.E,{className:"mt-1",children:K.priority})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:K.category})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Budget"}),(0,r.jsxs)("p",{className:"mt-1 text-sm text-gray-900",children:["$",eh(K).toLocaleString()]})]})]}),K.required_completion_date&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Required Completion Date"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:ex(K.required_completion_date)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:ex(K.created_at)})]}),K.internal_notes&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Internal Notes"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:K.internal_notes})]})]}),(0,r.jsx)("div",{className:"flex justify-end mt-6",children:(0,r.jsx)(j.$,{variant:"outline",onClick:()=>H(!1),children:"Close"})})]})})]})})}},33873:e=>{"use strict";e.exports=require("path")},51907:(e,t,s)=>{"use strict";s.d(t,{p:()=>l});var r=s(60687),i=s(43210),a=s(4780);let l=i.forwardRef(({className:e,type:t,...s},i)=>(0,r.jsx)("input",{type:t,className:(0,a.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...s}));l.displayName="Input"},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},71037:(e,t,s)=>{Promise.resolve().then(s.bind(s,71641))},71170:(e,t,s)=>{"use strict";s.d(t,{E:()=>l});var r=s(60687),i=s(43210),a=s(4780);let l=i.forwardRef(({className:e,variant:t="default",...s},i)=>(0,r.jsx)("div",{ref:i,className:(0,a.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",{"border-transparent bg-blue-600 text-white hover:bg-blue-700":"default"===t,"border-transparent bg-gray-100 text-gray-900 hover:bg-gray-200":"secondary"===t,"border-transparent bg-red-600 text-white hover:bg-red-700":"destructive"===t,"text-gray-950 border-gray-200 bg-white hover:bg-gray-50":"outline"===t},e),...s}));l.displayName="Badge"},71641:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/ubuntu/ETLA-Platform/frontend/src/app/work-requests/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/ubuntu/ETLA-Platform/frontend/src/app/work-requests/page.tsx","default")},74075:e=>{"use strict";e.exports=require("zlib")},78520:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(19377).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},89597:(e,t,s)=>{Promise.resolve().then(s.bind(s,29374))},92515:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o});var r=s(65239),i=s(48088),a=s(88170),l=s.n(a),n=s(30893),d={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);s.d(t,d);let o={children:["",{children:["work-requests",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,71641)),"/home/ubuntu/ETLA-Platform/frontend/src/app/work-requests/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,94431)),"/home/ubuntu/ETLA-Platform/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/home/ubuntu/ETLA-Platform/frontend/src/app/work-requests/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/work-requests/page",pathname:"/work-requests",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},94870:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(19377).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[197,147,671,897,1],()=>s(92515));module.exports=r})();