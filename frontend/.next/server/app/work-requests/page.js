(()=>{var e={};e.id=415,e.ids=[415],e.modules={2643:(e,s,t)=>{"use strict";t.d(s,{$:()=>a});var r=t(60687),i=t(43210),l=t(4780);let a=i.forwardRef(({className:e,variant:s="default",size:t="default",...i},a)=>(0,r.jsx)("button",{className:(0,l.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-blue-600 text-white hover:bg-blue-700":"default"===s,"bg-red-600 text-white hover:bg-red-700":"destructive"===s,"border border-gray-300 bg-white hover:bg-gray-50":"outline"===s,"bg-gray-100 text-gray-900 hover:bg-gray-200":"secondary"===s,"hover:bg-gray-100":"ghost"===s,"text-blue-600 underline-offset-4 hover:underline":"link"===s},{"h-10 px-4 py-2":"default"===t,"h-9 rounded-md px-3":"sm"===t,"h-11 rounded-md px-8":"lg"===t,"h-10 w-10":"icon"===t},e),ref:a,...i}));a.displayName="Button"},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},51907:(e,s,t)=>{"use strict";t.d(s,{p:()=>a});var r=t(60687),i=t(43210),l=t(4780);let a=i.forwardRef(({className:e,type:s,...t},i)=>(0,r.jsx)("input",{type:s,className:(0,l.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...t}));a.displayName="Input"},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},71037:(e,s,t)=>{Promise.resolve().then(t.bind(t,71641))},71170:(e,s,t)=>{"use strict";t.d(s,{E:()=>a});var r=t(60687),i=t(43210),l=t(4780);let a=i.forwardRef(({className:e,variant:s="default",...t},i)=>(0,r.jsx)("div",{ref:i,className:(0,l.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",{"border-transparent bg-blue-600 text-white hover:bg-blue-700":"default"===s,"border-transparent bg-gray-100 text-gray-900 hover:bg-gray-200":"secondary"===s,"border-transparent bg-red-600 text-white hover:bg-red-700":"destructive"===s,"text-gray-950 border-gray-200 bg-white hover:bg-gray-50":"outline"===s},e),...t}));a.displayName="Badge"},71641:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/ubuntu/ETLA-Platform/frontend/src/app/work-requests/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/ubuntu/ETLA-Platform/frontend/src/app/work-requests/page.tsx","default")},74075:e=>{"use strict";e.exports=require("zlib")},78520:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(19377).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},89597:(e,s,t)=>{Promise.resolve().then(t.bind(t,90651))},90651:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>q});var r=t(60687),i=t(43210),l=t(49987),a=t(78520),n=t(9362),d=t(94870),o=t(71787),c=t(30983),x=t(85215),u=t(69202),m=t(7130),h=t(26228),p=t(89082),g=t(2643),f=t(51907),j=t(28749),b=t(71170),y=t(60149),v=t(16391),w=t(13732),N=t(61523);let k={draft:{icon:l.A,color:"text-gray-600",bg:"bg-gray-100",label:"Draft"},submitted:{icon:l.A,color:"text-blue-600",bg:"bg-blue-100",label:"Submitted"},under_review:{icon:a.A,color:"text-yellow-600",bg:"bg-yellow-100",label:"Under Review"},approved:{icon:n.A,color:"text-green-600",bg:"bg-green-100",label:"Approved"},declined:{icon:d.A,color:"text-red-600",bg:"bg-red-100",label:"Declined"},in_progress:{icon:l.A,color:"text-indigo-600",bg:"bg-indigo-100",label:"In Progress"},completed:{icon:n.A,color:"text-green-600",bg:"bg-green-100",label:"Completed"},cancelled:{icon:d.A,color:"text-gray-600",bg:"bg-gray-100",label:"Cancelled"}};function q(){let[e,s]=(0,i.useState)([]),[t,q]=(0,i.useState)([]),[A,_]=(0,i.useState)(!0),[P,C]=(0,i.useState)(null),[S,E]=(0,i.useState)(""),[R,$]=(0,i.useState)(""),[z,L]=(0,i.useState)(""),[T,W]=(0,i.useState)("list"),[Z,B]=(0,i.useState)(!1),[D,F]=(0,i.useState)(!1),[G,I]=(0,i.useState)(null),[M,U]=(0,i.useState)({total:0,submitted:0,under_review:0,approved:0,in_progress:0,completed:0}),{user:K}=(0,w.h)(),{selectedTenant:X}=(0,N.K)(),H=async()=>{if(!X?.id){console.log("No tenant selected, skipping load"),_(!1);return}try{_(!0),C(null),console.log("Loading work requests for tenant:",X.id,X.name);let{data:e,error:t}=await v.ND.from("work_requests").select("*").eq("tenant_id",X.id).order("created_at",{ascending:!1});if(t){console.error("Database query error:",t),C(`Failed to load work requests: ${t.message||"Unknown error"}`),s([]),q([]);return}console.log("Loaded work requests:",e),s(e||[]),q(e||[]);let r={total:e?.length||0,submitted:e?.filter(e=>"submitted"===e.status).length||0,under_review:e?.filter(e=>"under_review"===e.status).length||0,approved:e?.filter(e=>"approved"===e.status).length||0,in_progress:e?.filter(e=>"in_progress"===e.status).length||0,completed:e?.filter(e=>"completed"===e.status).length||0};U(r)}catch(e){console.error("Error loading work requests:",e),C("Failed to load work requests"),s([]),q([])}finally{_(!1)}},O=async e=>{if(confirm("Are you sure you want to delete this work request?"))try{let{error:t}=await v.ND.from("work_requests").delete().eq("id",e);if(t){console.error("Error deleting work request:",t),C("Failed to delete work request. Please try again.");return}s(s=>s.filter(s=>s.id!==e)),H()}catch(e){console.error("Error deleting work request:",e),C("Failed to delete work request. Please try again.")}},J=e=>new Date(e).toLocaleDateString(),Q=e=>e.title||`Request ${e.id?.slice(0,8)}`;return X?(0,r.jsx)(y.A,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[P&&(0,r.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(d.A,{className:"h-5 w-5 text-red-400"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("p",{className:"text-sm text-red-700",children:P}),(0,r.jsx)("button",{onClick:()=>C(null),className:"text-red-700 underline text-sm mt-1",children:"Dismiss"})]})]})}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Work Requests"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Manage and track your work requests"})]}),(0,r.jsxs)(g.$,{onClick:()=>B(!0),className:"bg-blue-600 hover:bg-blue-700",children:[(0,r.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"New Request"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[(0,r.jsx)(j.Zp,{children:(0,r.jsx)(j.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.total})]}),(0,r.jsx)(l.A,{className:"h-8 w-8 text-gray-400"})]})})}),(0,r.jsx)(j.Zp,{children:(0,r.jsx)(j.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Submitted"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:M.submitted})]}),(0,r.jsx)(l.A,{className:"h-8 w-8 text-blue-500"})]})})}),(0,r.jsx)(j.Zp,{children:(0,r.jsx)(j.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-yellow-600",children:"Under Review"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:M.under_review})]}),(0,r.jsx)(a.A,{className:"h-8 w-8 text-yellow-500"})]})})}),(0,r.jsx)(j.Zp,{children:(0,r.jsx)(j.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Approved"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-900",children:M.approved})]}),(0,r.jsx)(n.A,{className:"h-8 w-8 text-green-500"})]})})}),(0,r.jsx)(j.Zp,{children:(0,r.jsx)(j.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-indigo-600",children:"In Progress"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-indigo-900",children:M.in_progress})]}),(0,r.jsx)(l.A,{className:"h-8 w-8 text-indigo-500"})]})})}),(0,r.jsx)(j.Zp,{children:(0,r.jsx)(j.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Completed"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-900",children:M.completed})]}),(0,r.jsx)(n.A,{className:"h-8 w-8 text-green-500"})]})})})]}),(0,r.jsx)(j.Zp,{children:(0,r.jsx)(j.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,r.jsx)(f.p,{placeholder:"Search requests...",value:S,onChange:e=>E(e.target.value),className:"pl-10"})]})}),(0,r.jsxs)("select",{value:R,onChange:e=>$(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"All Status"}),(0,r.jsx)("option",{value:"submitted",children:"Submitted"}),(0,r.jsx)("option",{value:"under_review",children:"Under Review"}),(0,r.jsx)("option",{value:"approved",children:"Approved"}),(0,r.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,r.jsx)("option",{value:"completed",children:"Completed"})]}),(0,r.jsxs)("select",{value:z,onChange:e=>L(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"All Priority"}),(0,r.jsx)("option",{value:"low",children:"Low"}),(0,r.jsx)("option",{value:"medium",children:"Medium"}),(0,r.jsx)("option",{value:"high",children:"High"}),(0,r.jsx)("option",{value:"critical",children:"Critical"})]}),(0,r.jsxs)("div",{className:"flex border border-gray-300 rounded-md",children:[(0,r.jsx)(g.$,{variant:"list"===T?"default":"ghost",size:"sm",onClick:()=>W("list"),className:"rounded-r-none",children:(0,r.jsx)(x.A,{className:"h-4 w-4"})}),(0,r.jsx)(g.$,{variant:"grid"===T?"default":"ghost",size:"sm",onClick:()=>W("grid"),className:"rounded-l-none",children:(0,r.jsx)(u.A,{className:"h-4 w-4"})})]})]})})}),(0,r.jsxs)(j.Zp,{children:[(0,r.jsxs)(j.aR,{children:[(0,r.jsxs)(j.ZB,{children:["Work Requests (",t.length,")"]}),(0,r.jsxs)(j.BT,{children:[t.length," of ",e.length," requests",X&&(0,r.jsxs)("span",{className:"ml-2",children:["| Tenant: ",X.name]})]})]}),(0,r.jsx)(j.Wu,{children:A?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Loading work requests..."})]}):0===t.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No work requests found"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:0===e.length?"Get started by creating your first work request.":"Try adjusting your search or filter criteria."}),0===e.length&&(0,r.jsxs)(g.$,{onClick:()=>B(!0),children:[(0,r.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Create First Request"]})]}):"list"===T?(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Request"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Budget"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>{let s=k[e.status]?.icon||l.A,t=k[e.status]||k.submitted;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:Q(e)}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[e.description?.slice(0,100),"..."]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)(b.E,{variant:"approved"===e.status?"default":"secondary",children:[(0,r.jsx)(s,{className:"w-3 h-3 mr-1"}),t.label]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)(b.E,{variant:"high"===e.priority||"critical"===e.priority?"destructive":"secondary",children:e.priority||"medium"})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",(e.estimated_budget||0).toLocaleString()]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:J(e.created_at)}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(g.$,{variant:"ghost",size:"sm",children:(0,r.jsx)(m.A,{className:"h-4 w-4"})}),(0,r.jsx)(g.$,{variant:"ghost",size:"sm",onClick:()=>{I(e),F(!0)},children:(0,r.jsx)(h.A,{className:"h-4 w-4"})}),(0,r.jsx)(g.$,{variant:"ghost",size:"sm",onClick:()=>O(e.id),children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})]})})]},e.id)})})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>{let s=k[e.status]?.icon||l.A,t=k[e.status]||k.submitted;return(0,r.jsxs)(j.Zp,{className:"hover:shadow-lg transition-shadow",children:[(0,r.jsx)(j.aR,{children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(j.ZB,{className:"text-lg",children:Q(e)}),(0,r.jsxs)(j.BT,{children:[e.description?.slice(0,100),"..."]})]}),(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)(g.$,{variant:"ghost",size:"sm",children:(0,r.jsx)(m.A,{className:"h-4 w-4"})}),(0,r.jsx)(g.$,{variant:"ghost",size:"sm",onClick:()=>{I(e),F(!0)},children:(0,r.jsx)(h.A,{className:"h-4 w-4"})})]})]})}),(0,r.jsx)(j.Wu,{children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Status:"}),(0,r.jsxs)(b.E,{variant:"approved"===e.status?"default":"secondary",children:[(0,r.jsx)(s,{className:"w-3 h-3 mr-1"}),t.label]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Priority:"}),(0,r.jsx)(b.E,{variant:"high"===e.priority||"critical"===e.priority?"destructive":"secondary",children:e.priority||"medium"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Budget:"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:["$",(e.estimated_budget||0).toLocaleString()]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Created:"}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:J(e.created_at)})]})]})})]},e.id)})})})]})]})}):(0,r.jsx)(y.A,{children:(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("p",{className:"text-gray-600",children:"Please select a tenant to view work requests."})})})}},92515:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>a.a,__next_app__:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>o});var r=t(65239),i=t(48088),l=t(88170),a=t.n(l),n=t(30893),d={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);t.d(s,d);let o={children:["",{children:["work-requests",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,71641)),"/home/ubuntu/ETLA-Platform/frontend/src/app/work-requests/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,94431)),"/home/ubuntu/ETLA-Platform/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/home/ubuntu/ETLA-Platform/frontend/src/app/work-requests/page.tsx"],x={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/work-requests/page",pathname:"/work-requests",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},94870:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(19377).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[197,147,671,897,1],()=>t(92515));module.exports=r})();