(()=>{var e={};e.id=685,e.ids=[685],e.modules={2643:(e,s,t)=>{"use strict";t.d(s,{$:()=>i});var a=t(60687),r=t(43210),l=t(4780);let i=r.forwardRef(({className:e,variant:s="default",size:t="default",...r},i)=>(0,a.jsx)("button",{className:(0,l.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-blue-600 text-white hover:bg-blue-700":"default"===s,"bg-red-600 text-white hover:bg-red-700":"destructive"===s,"border border-gray-300 bg-white hover:bg-gray-50":"outline"===s,"bg-gray-100 text-gray-900 hover:bg-gray-200":"secondary"===s,"hover:bg-gray-100":"ghost"===s,"text-blue-600 underline-offset-4 hover:underline":"link"===s},{"h-10 px-4 py-2":"default"===t,"h-9 rounded-md px-3":"sm"===t,"h-11 rounded-md px-8":"lg"===t,"h-10 w-10":"icon"===t},e),ref:i,...r}));i.displayName="Button"},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4463:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},7130:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},9235:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},9362:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]])},10041:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},13682:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},16073:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},16189:(e,s,t)=>{"use strict";var a=t(65773);t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},16973:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/ubuntu/ETLA-Platform/frontend/src/app/access-control/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/ubuntu/ETLA-Platform/frontend/src/app/access-control/page.tsx","default")},18188:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]])},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},23323:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,pages:()=>o,routeModule:()=>m,tree:()=>d});var a=t(65239),r=t(48088),l=t(88170),i=t.n(l),n=t(30893),c={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d={children:["",{children:["access-control",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,16973)),"/home/ubuntu/ETLA-Platform/frontend/src/app/access-control/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,94431)),"/home/ubuntu/ETLA-Platform/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,o=["/home/ubuntu/ETLA-Platform/frontend/src/app/access-control/page.tsx"],x={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/access-control/page",pathname:"/access-control",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},26228:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},27529:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29446:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},30983:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},31884:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},33873:e=>{"use strict";e.exports=require("path")},34074:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])},35377:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},35514:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},37907:(e,s,t)=>{Promise.resolve().then(t.bind(t,78060))},42633:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},44572:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]])},49987:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},53106:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},55591:e=>{"use strict";e.exports=require("https")},58320:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},60152:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},62420:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]])},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},75479:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])},77473:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},78060:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>U});var a=t(60687),r=t(43210),l=t(13732),i=t(61523),n=t(60149),c=t(28749),d=t(2643),o=t(78520),x=t(53106),m=t(4463),u=t(19377);let h=(0,u.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var p=t(35377),y=t(16073),g=t(62420),v=t(9362),j=t(49987),f=t(30983),b=t(26228),N=t(18188),_=t(16391),w=t(29446),k=t(77473),A=t(42633),C=t(82457),M=t(9235);function q({isOpen:e,onClose:s,onSuccess:t,tenants:l}){let[i,n]=(0,r.useState)({email:"",full_name:"",phone:"",department:"",job_title:"",role:"user",role_level:"sub_client",tenant_id:"",password:"",can_invite_users:!1,can_manage_sub_clients:!1,permission_scope:"own"}),[o,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(""),p=(e,s)=>{if(n(t=>({...t,[e]:s})),"role_level"===e){let e="host"===s?"all":"primary_client"===s?"tenant":"own";n(s=>({...s,permission_scope:e}))}},y=async e=>{e.preventDefault(),m(!0),h("");try{if(!i.email||!i.full_name||!i.tenant_id||!i.password)return void h("Please fill in all required fields");let e={email:i.email,full_name:i.full_name,phone:i.phone||void 0,department:i.department||void 0,job_title:i.job_title||void 0,role:i.role,role_level:i.role_level,tenant_id:i.tenant_id,password:i.password,can_invite_users:i.can_invite_users,can_manage_sub_clients:i.can_manage_sub_clients,permission_scope:i.permission_scope},a=await _.Lr.createUser(e);a.success?(t(),s(),n({email:"",full_name:"",phone:"",department:"",job_title:"",role:"user",role_level:"sub_client",tenant_id:"",password:"",can_invite_users:!1,can_manage_sub_clients:!1,permission_scope:"own"})):h(a.error||"Failed to create user")}catch(e){h("An error occurred while creating the user"),console.error("User creation error:",e)}finally{m(!1)}};return e?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(c.Zp,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(c.ZB,{className:"flex items-center",children:[(0,a.jsx)(w.A,{className:"h-5 w-5 mr-2"}),"Create New User"]}),(0,a.jsx)(c.BT,{children:"Add a new user to the system with appropriate role and permissions"})]}),(0,a.jsx)(d.$,{variant:"outline",size:"sm",onClick:s,children:(0,a.jsx)(k.A,{className:"h-4 w-4"})})]})}),(0,a.jsx)(c.Wu,{children:(0,a.jsxs)("form",{onSubmit:y,className:"space-y-6",children:[u&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,a.jsx)("p",{className:"text-sm text-red-600",children:u})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Basic Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 inline mr-1"}),"Email Address *"]}),(0,a.jsx)("input",{type:"email",required:!0,value:i.email,onChange:e=>p("email",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"user@company.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,a.jsx)(w.A,{className:"h-4 w-4 inline mr-1"}),"Full Name *"]}),(0,a.jsx)("input",{type:"text",required:!0,value:i.full_name,onChange:e=>p("full_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,a.jsx)(A.A,{className:"h-4 w-4 inline mr-1"}),"Phone Number"]}),(0,a.jsx)("input",{type:"tel",value:i.phone,onChange:e=>p("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+1 (555) 123-4567"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,a.jsx)(C.A,{className:"h-4 w-4 inline mr-1"}),"Job Title"]}),(0,a.jsx)("input",{type:"text",value:i.job_title,onChange:e=>p("job_title",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Software Engineer"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,a.jsx)(M.A,{className:"h-4 w-4 inline mr-1"}),"Department"]}),(0,a.jsx)("input",{type:"text",value:i.department,onChange:e=>p("department",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Engineering"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Role and Permissions"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 inline mr-1"}),"Role Level *"]}),(0,a.jsxs)("select",{required:!0,value:i.role_level,onChange:e=>p("role_level",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"sub_client",children:"Sub Client"}),(0,a.jsx)("option",{value:"primary_client",children:"Primary Client"}),(0,a.jsx)("option",{value:"host",children:"Host Admin"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),(0,a.jsxs)("select",{required:!0,value:i.role,onChange:e=>p("role",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"viewer",children:"Viewer"}),(0,a.jsx)("option",{value:"user",children:"User"}),(0,a.jsx)("option",{value:"manager",children:"Manager"}),(0,a.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,a.jsx)(M.A,{className:"h-4 w-4 inline mr-1"}),"Tenant *"]}),(0,a.jsxs)("select",{required:!0,value:i.tenant_id,onChange:e=>p("tenant_id",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Select Tenant"}),l.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.tenant_type,")"]},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Permission Scope"}),(0,a.jsxs)("select",{value:i.permission_scope,onChange:e=>p("permission_scope",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"own",children:"Own Data Only"}),(0,a.jsx)("option",{value:"tenant",children:"Tenant Scope"}),(0,a.jsx)("option",{value:"all",children:"All Data"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"can_invite_users",checked:i.can_invite_users,onChange:e=>p("can_invite_users",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"can_invite_users",className:"ml-2 text-sm text-gray-700",children:"Can invite other users"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"can_manage_sub_clients",checked:i.can_manage_sub_clients,onChange:e=>p("can_manage_sub_clients",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"can_manage_sub_clients",className:"ml-2 text-sm text-gray-700",children:"Can manage sub-client users"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Authentication"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Temporary Password *"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("input",{type:"text",required:!0,value:i.password,onChange:e=>p("password",e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter temporary password"}),(0,a.jsx)(d.$,{type:"button",onClick:()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*",s="";for(let t=0;t<12;t++)s+=e.charAt(Math.floor(Math.random()*e.length));n(e=>({...e,password:s}))},variant:"outline",children:"Generate"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"User will be required to change password on first login"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,a.jsx)(d.$,{type:"button",variant:"outline",onClick:s,disabled:o,children:"Cancel"}),(0,a.jsx)(d.$,{type:"submit",disabled:o,children:o?"Creating...":"Create User"})]})]})})]})}):null}let S=(0,u.A)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);function P({isOpen:e,onClose:s,onSuccess:t,tenants:l}){let[i,n]=(0,r.useState)({emails:"",role:"user",role_level:"sub_client",tenant_id:"",message:"",expires_in_days:7}),[o,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(""),[p,v]=(0,r.useState)(0),j=(e,s)=>{n(t=>({...t,[e]:s})),"emails"===e&&v(s.split(/[,\n]/).filter(e=>e.trim().length>0).length)},f=e=>{let s=e.split(/[,\n]/).map(e=>e.trim()).filter(e=>e.length>0),t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,a=[],r=[];if(s.forEach(e=>{t.test(e)?a.push(e):r.push(e)}),r.length>0)throw Error(`Invalid email addresses: ${r.join(", ")}`);return a},b=async e=>{e.preventDefault(),m(!0),h("");try{let e=f(i.emails);if(0===e.length)throw Error("Please enter at least one valid email address");if(!i.tenant_id)throw Error("Please select a tenant");let a={emails:e,role:i.role,role_level:i.role_level,tenant_id:i.tenant_id,message:i.message||void 0,expires_in_days:i.expires_in_days},r=await _.Lr.inviteUsers(a);r.success?(t(),s(),n({emails:"",role:"user",role_level:"sub_client",tenant_id:"",message:"",expires_in_days:7}),v(0)):h(r.error||"Failed to send invitations")}catch(e){h(e instanceof Error?e.message:"An error occurred while sending invitations"),console.error("Invitation error:",e)}finally{m(!1)}};return e?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(c.Zp,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(c.ZB,{className:"flex items-center",children:[(0,a.jsx)(x.A,{className:"h-5 w-5 mr-2"}),"Invite Users"]}),(0,a.jsx)(c.BT,{children:"Send email invitations to new users to join the platform"})]}),(0,a.jsx)(d.$,{variant:"outline",size:"sm",onClick:s,children:(0,a.jsx)(k.A,{className:"h-4 w-4"})})]})}),(0,a.jsx)(c.Wu,{children:(0,a.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[u&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,a.jsx)("p",{className:"text-sm text-red-600",children:u})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Recipients"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 inline mr-1"}),"Email Addresses *"]}),(0,a.jsx)("textarea",{required:!0,rows:4,value:i.emails,onChange:e=>j("emails",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email addresses separated by commas or new lines: user1@company.com user2@company.com, user3@company.com"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:p>0?`${p} email${p>1?"s":""} to be invited`:"Separate multiple emails with commas or new lines"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Role Assignment"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 inline mr-1"}),"Role Level *"]}),(0,a.jsxs)("select",{required:!0,value:i.role_level,onChange:e=>j("role_level",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"sub_client",children:"Sub Client"}),(0,a.jsx)("option",{value:"primary_client",children:"Primary Client"}),(0,a.jsx)("option",{value:"host",children:"Host Admin"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),(0,a.jsxs)("select",{required:!0,value:i.role,onChange:e=>j("role",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"viewer",children:"Viewer"}),(0,a.jsx)("option",{value:"user",children:"User"}),(0,a.jsx)("option",{value:"manager",children:"Manager"}),(0,a.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,a.jsx)(M.A,{className:"h-4 w-4 inline mr-1"}),"Tenant *"]}),(0,a.jsxs)("select",{required:!0,value:i.tenant_id,onChange:e=>j("tenant_id",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Select Tenant"}),l.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.tenant_type,")"]},e.id))]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Invitation Settings"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expires In (Days)"}),(0,a.jsxs)("select",{value:i.expires_in_days,onChange:e=>j("expires_in_days",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:1,children:"1 Day"}),(0,a.jsx)("option",{value:3,children:"3 Days"}),(0,a.jsx)("option",{value:7,children:"7 Days"}),(0,a.jsx)("option",{value:14,children:"14 Days"}),(0,a.jsx)("option",{value:30,children:"30 Days"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Custom Message"}),(0,a.jsx)("textarea",{rows:3,value:i.message,onChange:e=>j("message",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:(()=>{let e=l.find(e=>e.id===i.tenant_id);return`You have been invited to join ${e?.name||"our organization"} on the ETLA Platform. Please click the link below to accept your invitation and set up your account.`})()}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to use the default invitation message"})]})]}),p>0&&i.tenant_id&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 inline mr-1"}),"Invitation Preview"]}),(0,a.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:p})," user",p>1?"s":""," will be invited as ",(0,a.jsx)("strong",{children:i.role})," (",i.role_level,") to ",(0,a.jsx)("strong",{children:l.find(e=>e.id===i.tenant_id)?.name})]}),(0,a.jsxs)("p",{className:"mt-1",children:["Invitations will expire in ",(0,a.jsxs)("strong",{children:[i.expires_in_days," day",i.expires_in_days>1?"s":""]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,a.jsx)(d.$,{type:"button",variant:"outline",onClick:s,disabled:o,children:"Cancel"}),(0,a.jsxs)(d.$,{type:"submit",disabled:o||0===p,children:[(0,a.jsx)(S,{className:"h-4 w-4 mr-2"}),o?"Sending...":`Send ${p} Invitation${p>1?"s":""}`]})]})]})})]})}):null}function U(){let{user:e,isAuthenticated:s,isDemoMode:t,tenantUser:u}=(0,l.h)(),{selectedTenant:w}=(0,i.K)(),[k,A]=(0,r.useState)([]),[C,M]=(0,r.useState)([]),[S,U]=(0,r.useState)([]),[E,z]=(0,r.useState)([]),[R,L]=(0,r.useState)(!0),[D,T]=(0,r.useState)(null),[$,I]=(0,r.useState)(""),[Z,B]=(0,r.useState)("all"),[H,V]=(0,r.useState)("all"),[F,W]=(0,r.useState)(!1),[O,G]=(0,r.useState)(!1),[K,J]=(0,r.useState)(!1),[X,Y]=(0,r.useState)(!1),[Q,ee]=(0,r.useState)(null),[es,et]=(0,r.useState)("overview"),ea=u?.role||e?.role,er="host_admin"===ea,el="client_admin"===ea,ei=e?.email==="demo@company.com"||t,en=er||el||ei;console.log("\uD83D\uDD0D Access Control Permission Debug:",{user:e?.email,userRole:ea,tenantUserRole:u?.role,isAuthenticated:s,isDemoMode:t,canManageUsers:en,isHostAdmin:er,isClientAdmin:el,isDemoUser:ei});let ec=async()=>{L(!0),T(null);try{await Promise.all([ed(),eo(),ex(),em()])}catch(e){console.error("Error loading data:",e),T("Failed to load data. Please try again.")}finally{L(!1)}},ed=async()=>{try{let s=_.ND.from("profiles").select(`
          *,
          tenant_users!inner(
            role,
            role_level,
            is_active,
            tenant_id,
            is_primary_tenant,
            requires_password_change,
            permission_scope,
            can_invite_users,
            can_manage_sub_clients,
            tenants(name, code)
          )
        `).order("created_at",{ascending:!1});console.log("\uD83D\uDD0D Access Control Debug:",{isHostAdmin:er,selectedTenant:w?.name,userRole:e?.role,userEmail:e?.email,willFilter:!er&&w}),!er&&w?(console.log("\uD83D\uDEAB Applying tenant filter for tenant:",w.name),s=s.eq("tenant_users.tenant_id",w.id)):console.log("✅ No tenant filtering - showing all users");let{data:t,error:a}=await s;if(console.log("\uD83D\uDCCA Query Results:",{userCount:t?.length||0,users:t?.map(e=>({email:e.email,role:e.tenant_users?.[0]?.role}))||[]}),a)throw console.error("Error loading users:",a),a;let r=t?.map(e=>{let s=e.tenant_users[0]||{},t=s.tenants||{};return{id:e.id,email:e.email||"N/A",full_name:e.full_name||"Unknown",phone:e.phone,department:e.department,job_title:e.job_title,role:s.role||"user",role_level:s.role_level,tenant_id:s.tenant_id,tenant_name:t.name||"No Tenant",is_active:s.is_active??!0,status:e.status||"active",created_at:e.created_at,last_sign_in_at:e.last_sign_in_at,can_invite_users:s.can_invite_users||!1,can_manage_sub_clients:s.can_manage_sub_clients||!1,permission_scope:s.permission_scope||"own",requires_password_change:s.requires_password_change||!1,is_primary_tenant:s.is_primary_tenant||!1}})||[];A(r)}catch(e){throw console.error("Error loading users:",e),e}},eo=async()=>{try{let{data:e,error:s}=await _.ND.from("tenants").select("*").eq("is_active",!0).order("name");if(s)throw s;M(e||[])}catch(e){throw console.error("Error loading tenants:",e),e}},ex=async()=>{try{let e=_.ND.from("user_invitations").select(`
          *,
          tenants(name),
          invited_by_profile:profiles!user_invitations_invited_by_fkey(full_name)
        `).order("created_at",{ascending:!1});!er&&w&&(e=e.eq("tenant_id",w.id));let{data:s,error:t}=await e;if(t)throw t;let a=s?.map(e=>({id:e.id,email:e.email,full_name:e.full_name,tenant_name:e.tenants?.name||"Unknown Tenant",role:e.role,status:e.status,created_at:e.created_at,expires_at:e.expires_at,invited_by_name:e.invited_by_profile?.full_name||"Unknown"}))||[];U(a)}catch(e){throw console.error("Error loading invitations:",e),e}},em=async()=>{try{let{data:s,error:t}=await _.ND.from("admin_notifications").select("*").eq("admin_id",e?.id).order("created_at",{ascending:!1}).limit(50);if(t)throw t;z(s||[])}catch(e){throw console.error("Error loading notifications:",e),e}},eu=k.filter(e=>{let s=e.full_name.toLowerCase().includes($.toLowerCase())||e.email.toLowerCase().includes($.toLowerCase()),t="all"===Z||e.role===Z,a="all"===H||e.status===H;return s&&t&&a}),eh={totalUsers:k.length,activeUsers:k.filter(e=>e.is_active&&"active"===e.status).length,pendingUsers:k.filter(e=>"pending_assignment"===e.status).length,pendingInvites:S.filter(e=>"pending"===e.status).length,unreadNotifications:E.filter(e=>!e.is_read).length},ep=k.reduce((e,s)=>(e[s.role]=(e[s.role]||0)+1,e),{});return(console.log("\uD83D\uDD0D Final Access Check:",{canManageUsers:en,isHostAdmin:er,isClientAdmin:el,isDemoUser:ei,userEmail:e?.email,userRole:ea,tenantUserRole:u?.role,isAuthenticated:s,isDemoMode:t}),en)?(console.log("✅ Access granted - rendering Access Control page"),(0,a.jsxs)(n.A,{children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Access Control & Security"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Comprehensive user management, RBAC, and security controls"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)(d.$,{onClick:()=>G(!0),variant:"outline",className:"flex items-center space-x-2",children:[(0,a.jsx)(x.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Invite User"})]}),(0,a.jsxs)(d.$,{onClick:()=>W(!0),className:"flex items-center space-x-2",children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Create User"})]})]})]}),D&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(o.A,{className:"h-5 w-5 text-red-400"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,a.jsx)("p",{className:"text-sm text-red-700 mt-1",children:D}),(0,a.jsxs)(d.$,{onClick:ec,variant:"outline",size:"sm",className:"mt-2",children:[(0,a.jsx)(h,{className:"h-4 w-4 mr-2"}),"Retry"]})]})]})}),(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:p.A},{id:"users",label:"Users",icon:y.A},{id:"roles",label:"Roles & Permissions",icon:g.A},{id:"invites",label:"Invitations",icon:x.A},{id:"notifications",label:"Notifications",icon:o.A}].map(e=>(0,a.jsxs)("button",{onClick:()=>et(e.id),className:`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ${es===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[(0,a.jsx)(e.icon,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.label}),"notifications"===e.id&&eh.unreadNotifications>0&&(0,a.jsx)("span",{className:"bg-red-500 text-white text-xs rounded-full px-2 py-1",children:eh.unreadNotifications})]},e.id))})}),"overview"===es&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(y.A,{className:"h-8 w-8 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Users"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:eh.totalUsers})]})]})})}),(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(v.A,{className:"h-8 w-8 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Active Users"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:eh.activeUsers})]})]})})}),(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(j.A,{className:"h-8 w-8 text-yellow-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Pending Assignment"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:eh.pendingUsers})]})]})})}),(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(x.A,{className:"h-8 w-8 text-purple-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Pending Invites"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:eh.pendingInvites})]})]})})}),(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(o.A,{className:"h-8 w-8 text-red-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Notifications"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:eh.unreadNotifications})]})]})})})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsx)(c.ZB,{children:"Role Distribution"}),(0,a.jsx)(c.BT,{children:"Current user distribution across roles and levels"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"space-y-4",children:Object.entries(ep).map(([e,s])=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)("span",{className:"font-medium capitalize",children:e.replace("_"," ")})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[s," users"]}),(0,a.jsx)("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${s/eh.totalUsers*100}%`}})})]})]},e))})})]})]}),"users"===es&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,a.jsx)("input",{type:"text",placeholder:"Search users...",value:$,onChange:e=>I(e.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]})}),(0,a.jsxs)("select",{value:Z,onChange:e=>B(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Roles"}),(0,a.jsx)("option",{value:"host_admin",children:"Host Admin"}),(0,a.jsx)("option",{value:"client_admin",children:"Client Admin"}),(0,a.jsx)("option",{value:"user",children:"User"})]}),(0,a.jsxs)("select",{value:H,onChange:e=>V(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"active",children:"Active"}),(0,a.jsx)("option",{value:"pending_assignment",children:"Pending Assignment"}),(0,a.jsx)("option",{value:"suspended",children:"Suspended"})]}),(0,a.jsx)(d.$,{onClick:ec,variant:"outline",disabled:R,children:(0,a.jsx)(h,{className:`h-4 w-4 ${R?"animate-spin":""}`})})]}),(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-0",children:R?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(h,{className:"h-8 w-8 animate-spin text-gray-400"})}):0===eu.length?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(y.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Users Found"}),(0,a.jsx)("p",{className:"text-gray-500",children:0===k.length?"No users have been created yet.":"No users match your search criteria."}),0===k.length&&(0,a.jsxs)(d.$,{onClick:()=>W(!0),className:"mt-4",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Create First User"]})]})}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role & Tenant"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Login"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:eu.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.full_name.charAt(0).toUpperCase()})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.full_name,e.is_primary_tenant&&(0,a.jsx)("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Primary"})]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.email}),e.job_title&&(0,a.jsx)("div",{className:"text-xs text-gray-400",children:e.job_title})]})]})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm text-gray-900 capitalize",children:e.role.replace("_"," ")}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.tenant_name}),e.role_level&&(0,a.jsx)("div",{className:"text-xs text-gray-400 capitalize",children:e.role_level.replace("_"," ")})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,a.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${e.is_active&&"active"===e.status?"bg-green-100 text-green-800":"pending_assignment"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:e.is_active&&"active"===e.status?"Active":"pending_assignment"===e.status?"Pending":"Inactive"}),e.requires_password_change&&(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:"Password Reset Required"})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.last_sign_in_at?new Date(e.last_sign_in_at).toLocaleDateString():"Never"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(d.$,{onClick:()=>{ee(e),J(!0)},variant:"outline",size:"sm",children:(0,a.jsx)(b.A,{className:"h-4 w-4"})}),(0,a.jsx)(d.$,{onClick:()=>{ee(e),Y(!0)},variant:"outline",size:"sm",children:(0,a.jsx)(N.A,{className:"h-4 w-4"})})]})})]},e.id))})]})})})})]}),"invites"===es&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsx)(c.ZB,{children:"Pending Invitations"}),(0,a.jsx)(c.BT,{children:"Manage user invitations and track their status"})]}),(0,a.jsx)(c.Wu,{children:0===S.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(x.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Invitations"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No user invitations have been sent yet."})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invitee"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role & Tenant"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invited By"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expires"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.full_name||"N/A"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm text-gray-900 capitalize",children:e.role.replace("_"," ")}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.tenant_name})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${"pending"===e.status?"bg-yellow-100 text-yellow-800":"accepted"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.status})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.invited_by_name}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.expires_at).toLocaleDateString()})]},e.id))})]})})})]})})]}),F&&(0,a.jsx)(q,{isOpen:F,onClose:()=>W(!1),onSuccess:()=>{ec(),W(!1)},tenants:C}),O&&(0,a.jsx)(P,{isOpen:O,onClose:()=>G(!1),onSuccess:()=>{ec(),G(!1)},tenants:C})]})):(console.log("❌ Access denied - canManageUsers is false"),(0,a.jsx)(n.A,{children:(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(o.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-500",children:"You don't have permission to access user management."})]})})}))}},78520:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},79432:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},79551:e=>{"use strict";e.exports=require("url")},80761:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},81630:e=>{"use strict";e.exports=require("http")},82457:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]])},83435:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},84763:(e,s,t)=>{Promise.resolve().then(t.bind(t,16973))},85704:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},91412:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]])},99145:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},99712:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19377).A)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[197,147,897,1],()=>t(23323));module.exports=a})();