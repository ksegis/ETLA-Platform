(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{347:()=>{},6651:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,347,23)),Promise.resolve().then(n.bind(n,7020)),Promise.resolve().then(n.bind(n,7737))},7737:(e,t,n)=>{"use strict";n.d(t,{Ku:()=>u,TenantProvider:()=>s,un:()=>c,wz:()=>d});var r=n(5155),a=n(2115),i=n(2099),l=n(7020);let o=(0,a.createContext)(void 0);function s(e){let{children:t}=e,{user:n,tenantUser:s,isAuthenticated:u,isDemoMode:d}=(0,l.h)(),[c,f]=(0,a.useState)(null),[m,_]=(0,a.useState)([]),[v,h]=(0,a.useState)(!0),w={id:"99883779-9517-4ca9-a3f8-7fdc59051f0e",name:"Demo Company",domain:"demo.company.com",status:"active",subscription_plan:"professional",subscription_start_date:new Date().toISOString(),max_users:25,current_users:5,settings:{},tenant_id:"99883779-9517-4ca9-a3f8-7fdc59051f0e",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},p=async()=>{if(d){_([w]),f(w),h(!1);return}if(!u||!n){_([]),f(null),h(!1);return}try{if((null==s?void 0:s.role)==="host_admin"){let{data:e,error:t}=await i.ND.from("tenants").select("*").order("name");if(t)throw t;_(e||[]);let n=(null==e?void 0:e[0])||null;f(n)}else{let{data:e,error:t}=await i.ND.from("tenant_users").select("tenant_id").eq("user_id",n.id).eq("is_active",!0);if(t)throw t;if(e&&e.length>0){let t=e.map(e=>e.tenant_id),{data:n,error:r}=await i.ND.from("tenants").select("*").in("id",t).order("name");if(r)throw r;_(n||[]);let a=(null==n?void 0:n.find(e=>e.id===(null==s?void 0:s.tenant_id)))||(null==n?void 0:n[0])||null;f(a)}else _([]),f(null)}}catch(e){console.error("Error loading tenants:",e),_([]),f(null)}finally{h(!1)}};return(0,a.useEffect)(()=>{p()},[u,n,s,d]),(0,r.jsx)(o.Provider,{value:{selectedTenant:c,setSelectedTenant:f,currentTenant:c,availableTenants:m,isLoading:v,loadAvailableTenants:p,canSelectTenant:()=>!d&&((null==s?void 0:s.role)==="host_admin"||(null==s?void 0:s.role)==="program_manager"),getAllAccessibleTenantIds:()=>d?[w.id]:m.map(e=>e.id),isMultiTenant:()=>m.length>1,isDemoMode:d},children:t})}function u(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useTenant must be used within a TenantProvider");return e}function d(){let{getAllAccessibleTenantIds:e}=u();return e()}function c(){let{isMultiTenant:e,selectedTenant:t,availableTenants:n}=u();return{isMultiTenant:e(),selectedTenant:t,availableTenants:n}}}},e=>{var t=t=>e(e.s=t);e.O(0,[7690,2354,2099,4660,8441,1684,7358],()=>t(6651)),_N_E=e.O()}]);