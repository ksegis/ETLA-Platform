(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4685],{92:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(7140).A)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},936:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(7140).A)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},1073:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(7140).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},3465:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(7140).A)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},3741:(e,s,t)=>{"use strict";t.d(s,{$:()=>n});var l=t(5155),r=t(2115),a=t(9434);let n=r.forwardRef((e,s)=>{let{className:t,variant:r="default",size:n="default",...i}=e;return(0,l.jsx)("button",{className:(0,a.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-blue-600 text-white hover:bg-blue-700":"default"===r,"bg-red-600 text-white hover:bg-red-700":"destructive"===r,"border border-gray-300 bg-white hover:bg-gray-50":"outline"===r,"bg-gray-100 text-gray-900 hover:bg-gray-200":"secondary"===r,"hover:bg-gray-100":"ghost"===r,"text-blue-600 underline-offset-4 hover:underline":"link"===r},{"h-10 px-4 py-2":"default"===n,"h-9 rounded-md px-3":"sm"===n,"h-11 rounded-md px-8":"lg"===n,"h-10 w-10":"icon"===n},t),ref:s,...i})});n.displayName="Button"},6358:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(7140).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},6836:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(7140).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},7808:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(7140).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},7934:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>q});var l=t(5155),r=t(2115),a=t(7020),n=t(858),i=t(7703),c=t(3741),d=t(1073),o=t(8156),m=t(2550),x=t(3408),u=t(6358),h=t(3465),p=t(5639),j=t(403),g=t(782),v=t(3388),b=t(2539),y=t(7159),f=t(8499),N=t(7140);let w=(0,N.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var _=t(7808),A=t(6836),k=t(936);let C=(0,N.A)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);var S=t(8513),U=t(477),D=t(4139),R=t(8839),I=t(9356),E=t(2099);function T(e){let{isOpen:s,onClose:t,onSuccess:a,tenants:n}=e,[d,o]=(0,r.useState)({email:"",full_name:"",phone:"",department:"",job_title:"",role:"user",role_level:"sub_client",tenant_id:"",password:"",can_invite_users:!1,can_manage_sub_clients:!1,permission_scope:"own"}),[m,h]=(0,r.useState)(!1),[p,j]=(0,r.useState)(""),g=(e,s)=>{if(o(t=>({...t,[e]:s})),"role_level"===e){let e="host"===s?"all":"primary_client"===s?"tenant":"own";o(s=>({...s,permission_scope:e}))}},v=async e=>{e.preventDefault(),h(!0),j("");try{if(!d.email||!d.full_name||!d.tenant_id||!d.password)return void j("Please fill in all required fields");let e={email:d.email,full_name:d.full_name,phone:d.phone||void 0,department:d.department||void 0,job_title:d.job_title||void 0,role:d.role,role_level:d.role_level,tenant_id:d.tenant_id,password:d.password,can_invite_users:d.can_invite_users,can_manage_sub_clients:d.can_manage_sub_clients,permission_scope:d.permission_scope},s=await E.Lr.createUser(e);s.success?(a(),t(),o({email:"",full_name:"",phone:"",department:"",job_title:"",role:"user",role_level:"sub_client",tenant_id:"",password:"",can_invite_users:!1,can_manage_sub_clients:!1,permission_scope:"own"})):j(s.error||"Failed to create user")}catch(e){j("An error occurred while creating the user"),console.error("User creation error:",e)}finally{h(!1)}};return s?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)(i.Zp,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,l.jsx)(i.aR,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)(i.ZB,{className:"flex items-center",children:[(0,l.jsx)(U.A,{className:"h-5 w-5 mr-2"}),"Create New User"]}),(0,l.jsx)(i.BT,{children:"Add a new user to the system with appropriate role and permissions"})]}),(0,l.jsx)(c.$,{variant:"outline",size:"sm",onClick:t,children:(0,l.jsx)(D.A,{className:"h-4 w-4"})})]})}),(0,l.jsx)(i.Wu,{children:(0,l.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[p&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,l.jsx)("p",{className:"text-sm text-red-600",children:p})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Basic Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(u.A,{className:"h-4 w-4 inline mr-1"}),"Email Address *"]}),(0,l.jsx)("input",{type:"email",required:!0,value:d.email,onChange:e=>g("email",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"user@company.com"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(U.A,{className:"h-4 w-4 inline mr-1"}),"Full Name *"]}),(0,l.jsx)("input",{type:"text",required:!0,value:d.full_name,onChange:e=>g("full_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(R.A,{className:"h-4 w-4 inline mr-1"}),"Phone Number"]}),(0,l.jsx)("input",{type:"tel",value:d.phone,onChange:e=>g("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+1 (555) 123-4567"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(I.A,{className:"h-4 w-4 inline mr-1"}),"Job Title"]}),(0,l.jsx)("input",{type:"text",value:d.job_title,onChange:e=>g("job_title",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Software Engineer"})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(b.A,{className:"h-4 w-4 inline mr-1"}),"Department"]}),(0,l.jsx)("input",{type:"text",value:d.department,onChange:e=>g("department",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Engineering"})]})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Role and Permissions"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(x.A,{className:"h-4 w-4 inline mr-1"}),"Role Level *"]}),(0,l.jsxs)("select",{required:!0,value:d.role_level,onChange:e=>g("role_level",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"sub_client",children:"Sub Client"}),(0,l.jsx)("option",{value:"primary_client",children:"Primary Client"}),(0,l.jsx)("option",{value:"host",children:"Host Admin"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),(0,l.jsxs)("select",{required:!0,value:d.role,onChange:e=>g("role",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"viewer",children:"Viewer"}),(0,l.jsx)("option",{value:"user",children:"User"}),(0,l.jsx)("option",{value:"manager",children:"Manager"}),(0,l.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(b.A,{className:"h-4 w-4 inline mr-1"}),"Tenant *"]}),(0,l.jsxs)("select",{required:!0,value:d.tenant_id,onChange:e=>g("tenant_id",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select Tenant"}),n.map(e=>(0,l.jsxs)("option",{value:e.id,children:[e.name," (",e.tenant_type,")"]},e.id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Permission Scope"}),(0,l.jsxs)("select",{value:d.permission_scope,onChange:e=>g("permission_scope",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"own",children:"Own Data Only"}),(0,l.jsx)("option",{value:"tenant",children:"Tenant Scope"}),(0,l.jsx)("option",{value:"all",children:"All Data"})]})]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"can_invite_users",checked:d.can_invite_users,onChange:e=>g("can_invite_users",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,l.jsx)("label",{htmlFor:"can_invite_users",className:"ml-2 text-sm text-gray-700",children:"Can invite other users"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"can_manage_sub_clients",checked:d.can_manage_sub_clients,onChange:e=>g("can_manage_sub_clients",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,l.jsx)("label",{htmlFor:"can_manage_sub_clients",className:"ml-2 text-sm text-gray-700",children:"Can manage sub-client users"})]})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Authentication"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Temporary Password *"}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("input",{type:"text",required:!0,value:d.password,onChange:e=>g("password",e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter temporary password"}),(0,l.jsx)(c.$,{type:"button",onClick:()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*",s="";for(let t=0;t<12;t++)s+=e.charAt(Math.floor(Math.random()*e.length));o(e=>({...e,password:s}))},variant:"outline",children:"Generate"})]}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"User will be required to change password on first login"})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,l.jsx)(c.$,{type:"button",variant:"outline",onClick:t,disabled:m,children:"Cancel"}),(0,l.jsx)(c.$,{type:"submit",disabled:m,children:m?"Creating...":"Create User"})]})]})})]})}):null}function P(e){var s;let{isOpen:t,onClose:a,onSuccess:n,tenants:d}=e,[o,m]=(0,r.useState)({emails:"",role:"user",role_level:"sub_client",tenant_id:"",message:"",expires_in_days:7}),[h,p]=(0,r.useState)(!1),[g,v]=(0,r.useState)(""),[y,f]=(0,r.useState)(0),N=(e,s)=>{m(t=>({...t,[e]:s})),"emails"===e&&f(s.split(/[,\n]/).filter(e=>e.trim().length>0).length)},w=e=>{let s=e.split(/[,\n]/).map(e=>e.trim()).filter(e=>e.length>0),t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,l=[],r=[];if(s.forEach(e=>{t.test(e)?l.push(e):r.push(e)}),r.length>0)throw Error("Invalid email addresses: ".concat(r.join(", ")));return l},_=async e=>{e.preventDefault(),p(!0),v("");try{let e=w(o.emails);if(0===e.length)throw Error("Please enter at least one valid email address");if(!o.tenant_id)throw Error("Please select a tenant");let s={emails:e,role:o.role,role_level:o.role_level,tenant_id:o.tenant_id,message:o.message||void 0,expires_in_days:o.expires_in_days},t=await E.Lr.inviteUsers(s);t.success?(n(),a(),m({emails:"",role:"user",role_level:"sub_client",tenant_id:"",message:"",expires_in_days:7}),f(0)):v(t.error||"Failed to send invitations")}catch(e){v(e instanceof Error?e.message:"An error occurred while sending invitations"),console.error("Invitation error:",e)}finally{p(!1)}};return t?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)(i.Zp,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,l.jsx)(i.aR,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)(i.ZB,{className:"flex items-center",children:[(0,l.jsx)(u.A,{className:"h-5 w-5 mr-2"}),"Invite Users"]}),(0,l.jsx)(i.BT,{children:"Send email invitations to new users to join the platform"})]}),(0,l.jsx)(c.$,{variant:"outline",size:"sm",onClick:a,children:(0,l.jsx)(D.A,{className:"h-4 w-4"})})]})}),(0,l.jsx)(i.Wu,{children:(0,l.jsxs)("form",{onSubmit:_,className:"space-y-6",children:[g&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,l.jsx)("p",{className:"text-sm text-red-600",children:g})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Recipients"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(u.A,{className:"h-4 w-4 inline mr-1"}),"Email Addresses *"]}),(0,l.jsx)("textarea",{required:!0,rows:4,value:o.emails,onChange:e=>N("emails",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email addresses separated by commas or new lines: user1@company.com user2@company.com, user3@company.com"}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:y>0?"".concat(y," email").concat(y>1?"s":""," to be invited"):"Separate multiple emails with commas or new lines"})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Role Assignment"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(x.A,{className:"h-4 w-4 inline mr-1"}),"Role Level *"]}),(0,l.jsxs)("select",{required:!0,value:o.role_level,onChange:e=>N("role_level",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"sub_client",children:"Sub Client"}),(0,l.jsx)("option",{value:"primary_client",children:"Primary Client"}),(0,l.jsx)("option",{value:"host",children:"Host Admin"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),(0,l.jsxs)("select",{required:!0,value:o.role,onChange:e=>N("role",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"viewer",children:"Viewer"}),(0,l.jsx)("option",{value:"user",children:"User"}),(0,l.jsx)("option",{value:"manager",children:"Manager"}),(0,l.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(b.A,{className:"h-4 w-4 inline mr-1"}),"Tenant *"]}),(0,l.jsxs)("select",{required:!0,value:o.tenant_id,onChange:e=>N("tenant_id",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select Tenant"}),d.map(e=>(0,l.jsxs)("option",{value:e.id,children:[e.name," (",e.tenant_type,")"]},e.id))]})]})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Invitation Settings"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expires In (Days)"}),(0,l.jsxs)("select",{value:o.expires_in_days,onChange:e=>N("expires_in_days",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:1,children:"1 Day"}),(0,l.jsx)("option",{value:3,children:"3 Days"}),(0,l.jsx)("option",{value:7,children:"7 Days"}),(0,l.jsx)("option",{value:14,children:"14 Days"}),(0,l.jsx)("option",{value:30,children:"30 Days"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Custom Message"}),(0,l.jsx)("textarea",{rows:3,value:o.message,onChange:e=>N("message",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:(()=>{let e=d.find(e=>e.id===o.tenant_id);return"You have been invited to join ".concat((null==e?void 0:e.name)||"our organization"," on the ETLA Platform. Please click the link below to accept your invitation and set up your account.")})()}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to use the default invitation message"})]})]}),y>0&&o.tenant_id&&(0,l.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[(0,l.jsxs)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:[(0,l.jsx)(j.A,{className:"h-4 w-4 inline mr-1"}),"Invitation Preview"]}),(0,l.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:y})," user",y>1?"s":""," will be invited as ",(0,l.jsx)("strong",{children:o.role})," (",o.role_level,") to ",(0,l.jsx)("strong",{children:null==(s=d.find(e=>e.id===o.tenant_id))?void 0:s.name})]}),(0,l.jsxs)("p",{className:"mt-1",children:["Invitations will expire in ",(0,l.jsxs)("strong",{children:[o.expires_in_days," day",o.expires_in_days>1?"s":""]})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,l.jsx)(c.$,{type:"button",variant:"outline",onClick:a,disabled:h,children:"Cancel"}),(0,l.jsxs)(c.$,{type:"submit",disabled:h||0===y,children:[(0,l.jsx)(C,{className:"h-4 w-4 mr-2"}),h?"Sending...":"Send ".concat(y," Invitation").concat(y>1?"s":"")]})]})]})})]})}):null}var L=t(92);function $(e){let{isOpen:s,onClose:t,onSuccess:a,user:n,tenants:d}=e,[o,m]=(0,r.useState)({full_name:"",phone:"",department:"",job_title:"",role:"user",role_level:"sub_client",tenant_id:"",is_active:!0,can_invite_users:!1,can_manage_sub_clients:!1,permission_scope:"own"}),[u,h]=(0,r.useState)(!1),[p,j]=(0,r.useState)("");(0,r.useEffect)(()=>{n&&m({full_name:n.full_name||"",phone:n.phone||"",department:n.department||"",job_title:n.job_title||"",role:n.role,role_level:n.role_level,tenant_id:n.tenant_id,is_active:n.is_active,can_invite_users:n.can_invite_users,can_manage_sub_clients:n.can_manage_sub_clients,permission_scope:n.permission_scope})},[n]);let g=(e,s)=>{if(m(t=>({...t,[e]:s})),"role_level"===e){let e="host"===s?"all":"primary_client"===s?"tenant":"own";m(s=>({...s,permission_scope:e}))}},v=async e=>{e.preventDefault(),h(!0),j("");try{if(!o.full_name||!o.tenant_id)return void j("Please fill in all required fields");let e={full_name:o.full_name,phone:o.phone||void 0,department:o.department||void 0,job_title:o.job_title||void 0,role:o.role,role_level:o.role_level,tenant_id:o.tenant_id,is_active:o.is_active,can_invite_users:o.can_invite_users,can_manage_sub_clients:o.can_manage_sub_clients,permission_scope:o.permission_scope},s=await E.Lr.updateUser(n.id,e);s.success?(a(),t()):j(s.error||"Failed to update user")}catch(e){j("An error occurred while updating the user"),console.error("User update error:",e)}finally{h(!1)}},y=async()=>{if(window.confirm("Are you sure you want to deactivate this user? They will lose access to the system.")){h(!0),j("");try{let e=await E.Lr.deactivateUser(n.id);e.success?(a(),t()):j(e.error||"Failed to deactivate user")}catch(e){j("An error occurred while deactivating the user"),console.error("User deactivation error:",e)}finally{h(!1)}}},f=async()=>{h(!0),j("");try{let e=await E.Lr.activateUser(n.id);e.success?(a(),t()):j(e.error||"Failed to activate user")}catch(e){j("An error occurred while activating the user"),console.error("User activation error:",e)}finally{h(!1)}};return s&&n?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)(i.Zp,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,l.jsx)(i.aR,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)(i.ZB,{className:"flex items-center",children:[(0,l.jsx)(U.A,{className:"h-5 w-5 mr-2"}),"Edit User: ",n.full_name]}),(0,l.jsx)(i.BT,{children:"Update user information, role, and permissions"})]}),(0,l.jsx)(c.$,{variant:"outline",size:"sm",onClick:t,children:(0,l.jsx)(D.A,{className:"h-4 w-4"})})]})}),(0,l.jsx)(i.Wu,{children:(0,l.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[p&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,l.jsx)("p",{className:"text-sm text-red-600",children:p})}),(0,l.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"Account Status"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:n.email})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(n.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:n.is_active?"Active":"Inactive"}),n.is_active?(0,l.jsx)(c.$,{type:"button",size:"sm",variant:"outline",onClick:y,disabled:u,children:"Deactivate"}):(0,l.jsx)(c.$,{type:"button",size:"sm",onClick:f,disabled:u,children:"Activate"})]})]})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Basic Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(U.A,{className:"h-4 w-4 inline mr-1"}),"Full Name *"]}),(0,l.jsx)("input",{type:"text",required:!0,value:o.full_name,onChange:e=>g("full_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(R.A,{className:"h-4 w-4 inline mr-1"}),"Phone Number"]}),(0,l.jsx)("input",{type:"tel",value:o.phone,onChange:e=>g("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+1 (555) 123-4567"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(I.A,{className:"h-4 w-4 inline mr-1"}),"Job Title"]}),(0,l.jsx)("input",{type:"text",value:o.job_title,onChange:e=>g("job_title",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Software Engineer"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(b.A,{className:"h-4 w-4 inline mr-1"}),"Department"]}),(0,l.jsx)("input",{type:"text",value:o.department,onChange:e=>g("department",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Engineering"})]})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Role and Permissions"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(x.A,{className:"h-4 w-4 inline mr-1"}),"Role Level *"]}),(0,l.jsxs)("select",{required:!0,value:o.role_level,onChange:e=>g("role_level",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"sub_client",children:"Sub Client"}),(0,l.jsx)("option",{value:"primary_client",children:"Primary Client"}),(0,l.jsx)("option",{value:"host",children:"Host Admin"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),(0,l.jsxs)("select",{required:!0,value:o.role,onChange:e=>g("role",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"viewer",children:"Viewer"}),(0,l.jsx)("option",{value:"user",children:"User"}),(0,l.jsx)("option",{value:"manager",children:"Manager"}),(0,l.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,l.jsx)(b.A,{className:"h-4 w-4 inline mr-1"}),"Tenant *"]}),(0,l.jsxs)("select",{required:!0,value:o.tenant_id,onChange:e=>g("tenant_id",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select Tenant"}),d.map(e=>(0,l.jsxs)("option",{value:e.id,children:[e.name," (",e.tenant_type,")"]},e.id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Permission Scope"}),(0,l.jsxs)("select",{value:o.permission_scope,onChange:e=>g("permission_scope",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"own",children:"Own Data Only"}),(0,l.jsx)("option",{value:"tenant",children:"Tenant Scope"}),(0,l.jsx)("option",{value:"all",children:"All Data"})]})]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"can_invite_users",checked:o.can_invite_users,onChange:e=>g("can_invite_users",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,l.jsx)("label",{htmlFor:"can_invite_users",className:"ml-2 text-sm text-gray-700",children:"Can invite other users"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"can_manage_sub_clients",checked:o.can_manage_sub_clients,onChange:e=>g("can_manage_sub_clients",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,l.jsx)("label",{htmlFor:"can_manage_sub_clients",className:"ml-2 text-sm text-gray-700",children:"Can manage sub-client users"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"is_active",checked:o.is_active,onChange:e=>g("is_active",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,l.jsx)("label",{htmlFor:"is_active",className:"ml-2 text-sm text-gray-700",children:"Account is active"})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,l.jsx)(c.$,{type:"button",variant:"outline",onClick:t,disabled:u,children:"Cancel"}),(0,l.jsxs)(c.$,{type:"submit",disabled:u,children:[(0,l.jsx)(L.A,{className:"h-4 w-4 mr-2"}),u?"Saving...":"Save Changes"]})]})]})})]})}):null}function M(e){let{isOpen:s,onClose:t,onSuccess:a,user:n}=e,[d,o]=(0,r.useState)(!1),[x,h]=(0,r.useState)(""),[p,j]=(0,r.useState)(!1),[v,b]=(0,r.useState)("email"),[y,f]=(0,r.useState)(""),N=async()=>{o(!0),h("");try{let e=await E.Lr.resetUserPassword(n.email);e.success?(j(!0),setTimeout(()=>{a(),_()},2e3)):h(e.error||"Failed to send password reset email")}catch(e){h(e.message||"Failed to send password reset email")}finally{o(!1)}},w=async()=>{if(!y||y.length<8)return void h("Password must be at least 8 characters long");o(!0),h("");try{let e=await E.Lr.resetUserPassword(n.email,y);e.success?(j(!0),setTimeout(()=>{a(),_()},2e3)):h(e.error||"Failed to reset password")}catch(e){h(e.message||"Failed to reset password")}finally{o(!1)}},_=()=>{h(""),j(!1),f(""),b("email"),t()};return s&&n?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)(i.Zp,{className:"w-full max-w-md",children:[(0,l.jsx)(i.aR,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)(i.ZB,{className:"flex items-center",children:[(0,l.jsx)(g.A,{className:"h-5 w-5 mr-2"}),"Reset Password"]}),(0,l.jsxs)(i.BT,{children:["Reset password for ",n.full_name]})]}),(0,l.jsx)(c.$,{variant:"outline",size:"sm",onClick:_,children:(0,l.jsx)(D.A,{className:"h-4 w-4"})})]})}),(0,l.jsxs)(i.Wu,{className:"space-y-6",children:[x&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(k.A,{className:"h-4 w-4 text-red-600 mr-2"}),(0,l.jsx)("p",{className:"text-sm text-red-600",children:x})]})}),p&&(0,l.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-md p-3",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(m.A,{className:"h-4 w-4 text-green-600 mr-2"}),(0,l.jsx)("p",{className:"text-sm text-green-600",children:"email"===v?"Password reset email sent successfully!":"Password reset successfully!"})]})}),!p&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-3",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(u.A,{className:"h-4 w-4 text-gray-600 mr-2"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-900",children:n.full_name}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:n.email})]})]})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Reset Method"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"radio",id:"email_reset",name:"reset_method",value:"email",checked:"email"===v,onChange:e=>b(e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),(0,l.jsx)("label",{htmlFor:"email_reset",className:"ml-2 text-sm text-gray-700",children:"Send reset email to user"})]}),(0,l.jsx)("p",{className:"text-xs text-gray-500 ml-6",children:"User will receive an email with instructions to reset their password"}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"radio",id:"direct_reset",name:"reset_method",value:"direct",checked:"direct"===v,onChange:e=>b(e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),(0,l.jsx)("label",{htmlFor:"direct_reset",className:"ml-2 text-sm text-gray-700",children:"Set new password directly"})]}),(0,l.jsx)("p",{className:"text-xs text-gray-500 ml-6",children:"Set a temporary password that the user must change on next login"})]})]}),"direct"===v&&(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"New Temporary Password"}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("input",{type:"text",value:y,onChange:e=>f(e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter new password"}),(0,l.jsx)(c.$,{type:"button",onClick:()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*",s="";for(let t=0;t<12;t++)s+=e.charAt(Math.floor(Math.random()*e.length));f(s)},variant:"outline",size:"sm",children:"Generate"})]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"User will be required to change this password on their next login"})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,l.jsx)(c.$,{variant:"outline",onClick:_,disabled:d,children:"Cancel"}),(0,l.jsx)(c.$,{onClick:"email"===v?N:w,disabled:d||"direct"===v&&!y,children:d?"Processing...":"email"===v?"Send Reset Email":"Reset Password"})]})]})]})]})}):null}var B=t(2540),F=t(9169);function Z(e){let{isOpen:s,onClose:t,onSuccess:a}=e,[n,d]=(0,r.useState)(!1),[o,x]=(0,r.useState)(""),[u,h]=(0,r.useState)(!1),[p,g]=(0,r.useState)("options"),[v,b]=(0,r.useState)({deleteInactiveUsers:!1,deleteUnconfirmedUsers:!0,deleteExpiredInvites:!0,inactiveDays:90,unconfirmedDays:30}),[y,f]=(0,r.useState)(null),N=(e,s)=>{b(t=>({...t,[e]:s}))},w=async()=>{d(!0),x("");try{let e={deleteInactiveUsers:v.deleteInactiveUsers,deleteUnconfirmedUsers:v.deleteUnconfirmedUsers,deleteExpiredInvites:v.deleteExpiredInvites,inactiveDays:v.inactiveDays,unconfirmedDays:v.unconfirmedDays},s=await E.Lr.previewUserCleanup(e);s.success&&s.data?(f(s.data),g("preview")):x(s.error||"Failed to generate cleanup preview")}catch(e){x("An error occurred while generating the cleanup preview"),console.error("Cleanup preview error:",e)}finally{d(!1)}},_=async()=>{d(!0),x("");try{let e={deleteInactiveUsers:v.deleteInactiveUsers,deleteUnconfirmedUsers:v.deleteUnconfirmedUsers,deleteExpiredInvites:v.deleteExpiredInvites,inactiveDays:v.inactiveDays,unconfirmedDays:v.unconfirmedDays},s=await E.Lr.executeUserCleanup(e);s.success?(h(!0),setTimeout(()=>{a(),C()},3e3)):x(s.error||"Failed to execute cleanup")}catch(e){x("An error occurred while executing the cleanup"),console.error("Cleanup execution error:",e)}finally{d(!1)}},C=()=>{x(""),h(!1),g("options"),f(null),b({deleteInactiveUsers:!1,deleteUnconfirmedUsers:!0,deleteExpiredInvites:!0,inactiveDays:90,unconfirmedDays:30}),t()};return s?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)(i.Zp,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,l.jsx)(i.aR,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)(i.ZB,{className:"flex items-center",children:[(0,l.jsx)(B.A,{className:"h-5 w-5 mr-2"}),"User Cleanup Utility"]}),(0,l.jsx)(i.BT,{children:"Clean up inactive users, unconfirmed accounts, and expired invitations"})]}),(0,l.jsx)(c.$,{variant:"outline",size:"sm",onClick:C,children:(0,l.jsx)(D.A,{className:"h-4 w-4"})})]})}),(0,l.jsxs)(i.Wu,{className:"space-y-6",children:[o&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(k.A,{className:"h-4 w-4 text-red-600 mr-2"}),(0,l.jsx)("p",{className:"text-sm text-red-600",children:o})]})}),u&&(0,l.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-md p-3",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(m.A,{className:"h-4 w-4 text-green-600 mr-2"}),(0,l.jsx)("p",{className:"text-sm text-green-600",children:"User cleanup completed successfully! The system has been cleaned up."})]})}),!u&&(0,l.jsxs)(l.Fragment,{children:["options"===p&&(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)(k.A,{className:"h-5 w-5 text-yellow-600 mr-2 mt-0.5"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-yellow-800",children:"Warning"}),(0,l.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"This operation will permanently delete user accounts and cannot be undone. Please review your selections carefully."})]})]})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Cleanup Options"}),(0,l.jsxs)("div",{className:"border border-gray-200 rounded-md p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"deleteInactiveUsers",checked:v.deleteInactiveUsers,onChange:e=>N("deleteInactiveUsers",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,l.jsx)("label",{htmlFor:"deleteInactiveUsers",className:"ml-2 text-sm font-medium text-gray-900",children:"Delete inactive users"})]}),(0,l.jsx)(j.A,{className:"h-4 w-4 text-gray-400"})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Remove users who haven't logged in for a specified period"}),v.deleteInactiveUsers&&(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("label",{className:"text-sm text-gray-700",children:"Inactive for more than:"}),(0,l.jsxs)("select",{value:v.inactiveDays,onChange:e=>N("inactiveDays",parseInt(e.target.value)),className:"px-2 py-1 border border-gray-300 rounded text-sm",children:[(0,l.jsx)("option",{value:30,children:"30 days"}),(0,l.jsx)("option",{value:60,children:"60 days"}),(0,l.jsx)("option",{value:90,children:"90 days"}),(0,l.jsx)("option",{value:180,children:"180 days"}),(0,l.jsx)("option",{value:365,children:"1 year"})]})]})]}),(0,l.jsxs)("div",{className:"border border-gray-200 rounded-md p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"deleteUnconfirmedUsers",checked:v.deleteUnconfirmedUsers,onChange:e=>N("deleteUnconfirmedUsers",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,l.jsx)("label",{htmlFor:"deleteUnconfirmedUsers",className:"ml-2 text-sm font-medium text-gray-900",children:"Delete unconfirmed users"})]}),(0,l.jsx)(F.A,{className:"h-4 w-4 text-gray-400"})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Remove users who haven't confirmed their email addresses"}),v.deleteUnconfirmedUsers&&(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("label",{className:"text-sm text-gray-700",children:"Created more than:"}),(0,l.jsxs)("select",{value:v.unconfirmedDays,onChange:e=>N("unconfirmedDays",parseInt(e.target.value)),className:"px-2 py-1 border border-gray-300 rounded text-sm",children:[(0,l.jsx)("option",{value:7,children:"7 days"}),(0,l.jsx)("option",{value:14,children:"14 days"}),(0,l.jsx)("option",{value:30,children:"30 days"}),(0,l.jsx)("option",{value:60,children:"60 days"})]}),(0,l.jsx)("span",{className:"text-sm text-gray-700",children:"ago"})]})]}),(0,l.jsxs)("div",{className:"border border-gray-200 rounded-md p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"deleteExpiredInvites",checked:v.deleteExpiredInvites,onChange:e=>N("deleteExpiredInvites",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,l.jsx)("label",{htmlFor:"deleteExpiredInvites",className:"ml-2 text-sm font-medium text-gray-900",children:"Delete expired invitations"})]}),(0,l.jsx)(F.A,{className:"h-4 w-4 text-gray-400"})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Remove invitation records that have expired and are no longer valid"})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,l.jsx)(c.$,{variant:"outline",onClick:C,disabled:n,children:"Cancel"}),(0,l.jsx)(c.$,{onClick:w,disabled:n||!v.deleteInactiveUsers&&!v.deleteUnconfirmedUsers&&!v.deleteExpiredInvites,children:n?"Generating...":"Preview Cleanup"})]})]}),"preview"===p&&y&&(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Cleanup Preview"}),(0,l.jsx)("p",{className:"text-sm text-blue-700",children:"Review what will be deleted before proceeding with the cleanup."})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[v.deleteInactiveUsers&&(0,l.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(j.A,{className:"h-8 w-8 text-gray-600"}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:y.inactiveUsers}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Inactive Users"})]})]})}),v.deleteUnconfirmedUsers&&(0,l.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(F.A,{className:"h-8 w-8 text-yellow-600"}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:y.unconfirmedUsers}),(0,l.jsx)("p",{className:"text-sm text-yellow-700",children:"Unconfirmed Users"})]})]})}),v.deleteExpiredInvites&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(A.A,{className:"h-8 w-8 text-red-600"}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-red-900",children:y.expiredInvites}),(0,l.jsx)("p",{className:"text-sm text-red-700",children:"Expired Invites"})]})]})})]}),(0,l.jsx)("div",{className:"bg-gray-900 text-white rounded-md p-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-lg font-medium",children:"Total items to be deleted:"}),(0,l.jsx)("span",{className:"text-2xl font-bold",children:y.totalToDelete})]})}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,l.jsx)(c.$,{variant:"outline",onClick:()=>g("options"),disabled:n,children:"Back"}),(0,l.jsx)(c.$,{onClick:()=>g("confirm"),disabled:n||0===y.totalToDelete,variant:y.totalToDelete>0?"destructive":"outline",children:y.totalToDelete>0?"Proceed to Confirm":"Nothing to Clean"})]})]}),"confirm"===p&&y&&(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)(k.A,{className:"h-5 w-5 text-red-600 mr-2 mt-0.5"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-red-800",children:"Final Confirmation"}),(0,l.jsxs)("p",{className:"text-sm text-red-700 mt-1",children:["You are about to permanently delete ",(0,l.jsx)("strong",{children:y.totalToDelete})," items from the system. This action cannot be undone."]})]})]})}),(0,l.jsxs)("div",{className:"bg-white border border-gray-200 rounded-md p-4",children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Summary of actions:"}),(0,l.jsxs)("ul",{className:"space-y-2 text-sm text-gray-600",children:[v.deleteInactiveUsers&&(0,l.jsxs)("li",{children:["• Delete ",y.inactiveUsers," users inactive for more than ",v.inactiveDays," days"]}),v.deleteUnconfirmedUsers&&(0,l.jsxs)("li",{children:["• Delete ",y.unconfirmedUsers," unconfirmed users created more than ",v.unconfirmedDays," days ago"]}),v.deleteExpiredInvites&&(0,l.jsxs)("li",{children:["• Delete ",y.expiredInvites," expired invitation records"]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,l.jsx)(c.$,{variant:"outline",onClick:()=>g("preview"),disabled:n,children:"Back"}),(0,l.jsx)(c.$,{onClick:_,disabled:n,variant:"destructive",children:n?"Executing Cleanup...":"Execute Cleanup"})]})]})]})]})]})}):null}function q(){let{user:e,isAuthenticated:s,tenant:t}=(0,a.h)(),{hasPermission:N,currentRole:U,isHostAdmin:D}=(0,S.Sk)(),[R,I]=(0,r.useState)([]),[L,B]=(0,r.useState)([]),[F,q]=(0,r.useState)([]),[z,O]=(0,r.useState)([]),[W,H]=(0,r.useState)(!0),[V,G]=(0,r.useState)(""),[J,Y]=(0,r.useState)(""),[K,Q]=(0,r.useState)("all"),[X,ee]=(0,r.useState)("all"),[es,et]=(0,r.useState)("overview"),[el,er]=(0,r.useState)(!1),[ea,en]=(0,r.useState)(!1),[ei,ec]=(0,r.useState)(!1),[ed,eo]=(0,r.useState)(!1),[em,ex]=(0,r.useState)(!1),[eu,eh]=(0,r.useState)(null),ep=N("user-management","manage")&&D(),ej=N("user-management","view")||ep;(0,r.useEffect)(()=>{s&&ej&&eg()},[s,ej]);let eg=async()=>{H(!0);try{await Promise.all([ev(),eb(),ey(),ef()])}catch(e){console.error("Error loading data:",e)}finally{H(!1)}},ev=async()=>{try{let{data:e,error:s}=await E.ND.from("profiles").select("\n          *,\n          tenant_users!inner(\n            role,\n            role_level,\n            is_active,\n            tenant_id,\n            tenants(name)\n          )\n        ").order("created_at",{ascending:!1});if(s)throw s;let t=(null==e?void 0:e.map(e=>{var s,t,l,r,a,n,i,c,d,o;return{id:e.id,email:e.email||"N/A",full_name:e.full_name||"Unknown",role:(null==(s=e.tenant_users[0])?void 0:s.role)||"user",role_level:(null==(t=e.tenant_users[0])?void 0:t.role_level)||"sub_client",tenant_name:(null==(r=e.tenant_users[0])||null==(l=r.tenants)?void 0:l.name)||"No Tenant",tenant_id:null==(a=e.tenant_users[0])?void 0:a.tenant_id,is_active:null==(o=null==(n=e.tenant_users[0])?void 0:n.is_active)||o,created_at:e.created_at,last_sign_in_at:e.last_sign_in_at,phone:e.phone,department:e.department,job_title:e.job_title,can_invite_users:["admin","manager"].includes((null==(i=e.tenant_users[0])?void 0:i.role)||""),can_manage_sub_clients:(null==(c=e.tenant_users[0])?void 0:c.role_level)==="primary_client",permission_scope:(null==(d=e.tenant_users[0])?void 0:d.permission_scope)||"own"}}))||[];I(t)}catch(e){console.error("Error loading users:",e),G("Failed to load users")}},eb=async()=>{try{let{data:e,error:s}=await E.ND.from("tenants").select("*").order("name");if(s)throw s;B(e||[])}catch(e){console.error("Error loading tenants:",e),G("Failed to load tenants")}},ey=async()=>{try{q([])}catch(e){console.error("Error loading invites:",e),G("Failed to load invites")}},ef=async()=>{try{let{data:e,error:s}=await E.ND.from("tenant_users").select("role, role_level");if(s)throw s;let t=Object.entries((null==e?void 0:e.reduce((e,s)=>{let t="".concat(s.role_level,"_").concat(s.role);return e[t]=(e[t]||0)+1,e},{}))||{}).map(e=>{let[s,t]=e,[l,r]=s.split("_");return{role:r,role_level:l,count:t,description:"".concat(l," ").concat(r,"s")}});O(t)}catch(e){console.error("Error loading role stats:",e),G("Failed to load role stats")}},eN=async e=>{if(window.confirm("Are you sure you want to delete this user? This action cannot be undone."))try{let{error:s}=await E.ND.from("tenant_users").delete().eq("user_id",e);if(s)throw s;let{error:t}=await E.ND.from("profiles").delete().eq("id",e);if(t)throw t;console.log("User deleted from profiles and tenant_users. Auth user may need manual cleanup."),await ev()}catch(e){console.error("Error deleting user:",e),G("Failed to delete user")}},ew=(e,s)=>{eh(R.find(s=>s.id===e)||null),eo(!0)},e_=async e=>{try{console.log("Resending invite:",e),await ey()}catch(e){console.error("Error resending invite:",e),G("Failed to resend invite")}},eA=()=>{let e=new Blob([["Email,Name,Role,Level,Tenant,Status,Last Login,Created",...ek.map(e=>[e.email,e.full_name,e.role,e.role_level,e.tenant_name,e.is_active?"Active":"Inactive",e.last_sign_in_at?new Date(e.last_sign_in_at).toLocaleDateString():"Never",new Date(e.created_at).toLocaleDateString()].join(","))].join("\n")],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="users-export-".concat(new Date().toISOString().split("T")[0],".csv"),t.click(),window.URL.revokeObjectURL(s)},ek=R.filter(e=>{let s=e.email.toLowerCase().includes(J.toLowerCase())||e.full_name.toLowerCase().includes(J.toLowerCase()),t="all"===K||e.tenant_id===K,l="all"===X||e.role===X;return s&&t&&l}),eC=(e,s)=>"host"===s?"bg-purple-100 text-purple-800":"primary_client"===s?"bg-blue-100 text-blue-800":"sub_client"===s?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",eS=e=>e.email_confirmed_at?e.is_active?(0,l.jsx)(m.A,{className:"h-4 w-4 text-green-500"}):(0,l.jsx)(o.A,{className:"h-4 w-4 text-red-500"}):(0,l.jsx)(d.A,{className:"h-4 w-4 text-yellow-500"});return s?ej?(0,l.jsxs)(n.A,{children:[(0,l.jsxs)("div",{className:"p-6 lg:p-8",children:[(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Access Control & Security"}),(0,l.jsx)("p",{className:"mt-2 text-gray-600",children:ep?"Comprehensive user management, RBAC, and security controls":"User management and security overview for ".concat(null==t?void 0:t.name)})]}),ep&&(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsxs)(c.$,{onClick:()=>en(!0),variant:"outline",children:[(0,l.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Invite User"]}),(0,l.jsxs)(c.$,{onClick:()=>er(!0),children:[(0,l.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Create User"]})]})]})}),(0,l.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,l.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:p.A},{id:"users",label:"Users",icon:j.A},{id:"roles",label:"Roles & Permissions",icon:x.A},{id:"sso",label:"SSO Configuration",icon:g.A},...ep?[{id:"invites",label:"Invitations",icon:u.A},{id:"cleanup",label:"System Cleanup",icon:v.A}]:[]].map(e=>{let{id:s,label:t,icon:r}=e;return(0,l.jsxs)("button",{onClick:()=>et(s),className:"flex items-center py-2 px-1 border-b-2 font-medium text-sm ".concat(es===s?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,l.jsx)(r,{className:"h-4 w-4 mr-2"}),t]},s)})})}),"overview"===es&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,l.jsx)(i.Zp,{children:(0,l.jsx)(i.Wu,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:R.length})]}),(0,l.jsx)(j.A,{className:"h-8 w-8 text-blue-600"})]})})}),(0,l.jsx)(i.Zp,{children:(0,l.jsx)(i.Wu,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Tenants"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:L.filter(e=>"active"===e.status).length})]}),(0,l.jsx)(b.A,{className:"h-8 w-8 text-green-600"})]})})}),(0,l.jsx)(i.Zp,{children:(0,l.jsx)(i.Wu,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending Invites"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:F.filter(e=>"pending"===e.status).length})]}),(0,l.jsx)(u.A,{className:"h-8 w-8 text-yellow-600"})]})})}),(0,l.jsx)(i.Zp,{children:(0,l.jsx)(i.Wu,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Users"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:R.filter(e=>e.is_active).length})]}),(0,l.jsx)(m.A,{className:"h-8 w-8 text-purple-600"})]})})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{children:[(0,l.jsx)(i.ZB,{children:"Role Distribution"}),(0,l.jsx)(i.BT,{children:"Current user distribution across roles and levels"})]}),(0,l.jsx)(i.Wu,{children:(0,l.jsx)("div",{className:"space-y-4",children:z.map((e,s)=>(0,l.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(x.A,{className:"h-4 w-4 mr-2 ".concat("host"===e.role_level?"text-purple-600":"primary_client"===e.role_level?"text-blue-600":"text-green-600")}),(0,l.jsxs)("span",{className:"text-sm font-medium",children:[e.role," (",e.role_level,")"]})]}),(0,l.jsxs)("span",{className:"text-sm font-bold text-gray-900",children:[e.count," users"]})]}),(0,l.jsx)("p",{className:"text-xs text-gray-600",children:e.description})]},s))})})]}),(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{children:[(0,l.jsx)(i.ZB,{children:"Tenant Overview"}),(0,l.jsx)(i.BT,{children:"Active tenants and user distribution"})]}),(0,l.jsx)(i.Wu,{children:(0,l.jsx)("div",{className:"space-y-3",children:L.slice(0,5).map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.tenant_type})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("p",{className:"font-medium",children:[e.user_count," users"]}),(0,l.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.status})]})]},e.id))})})]})]})]}),"users"===es&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(y.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,l.jsx)("input",{type:"text",placeholder:"Search users by email or name...",value:J,onChange:e=>Y(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),(0,l.jsxs)("select",{value:K,onChange:e=>Q(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"all",children:"All Tenants"}),L.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,l.jsxs)("select",{value:X,onChange:e=>ee(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"all",children:"All Roles"}),(0,l.jsx)("option",{value:"admin",children:"Admin"}),(0,l.jsx)("option",{value:"manager",children:"Manager"}),(0,l.jsx)("option",{value:"user",children:"User"}),(0,l.jsx)("option",{value:"viewer",children:"Viewer"})]}),(0,l.jsxs)(c.$,{onClick:eA,variant:"outline",children:[(0,l.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Export"]})]}),(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{children:[(0,l.jsxs)(i.ZB,{children:["Users (",ek.length,")"]}),(0,l.jsx)(i.BT,{children:ep?"Manage all users across the platform":"View users in your organization"})]}),(0,l.jsx)(i.Wu,{children:W?(0,l.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,l.jsx)(w,{className:"h-6 w-6 animate-spin text-gray-400"}),(0,l.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading users..."})]}):(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b",children:[(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"User"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Role"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Tenant"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Status"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Last Login"}),ep&&(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:ek.map(e=>(0,l.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"py-3 px-4",children:(0,l.jsxs)("div",{className:"flex items-center",children:[eS(e),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("p",{className:"font-medium text-gray-900",children:e.full_name}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.email}),e.job_title&&(0,l.jsx)("p",{className:"text-xs text-gray-500",children:e.job_title})]})]})}),(0,l.jsx)("td",{className:"py-3 px-4",children:(0,l.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(eC(e.role,e.role_level)),children:[e.role," (",e.role_level,")"]})}),(0,l.jsx)("td",{className:"py-3 px-4",children:(0,l.jsx)("p",{className:"text-sm text-gray-900",children:e.tenant_name})}),(0,l.jsx)("td",{className:"py-3 px-4",children:(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"})}),(0,l.jsx)("td",{className:"py-3 px-4",children:(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.last_sign_in_at?new Date(e.last_sign_in_at).toLocaleDateString():"Never"})}),ep&&(0,l.jsx)("td",{className:"py-3 px-4",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(c.$,{size:"sm",variant:"outline",onClick:()=>{eh(e),ec(!0)},children:(0,l.jsx)(_.A,{className:"h-3 w-3"})}),(0,l.jsx)(c.$,{size:"sm",variant:"outline",onClick:()=>ew(e.id,e.email),children:(0,l.jsx)(g.A,{className:"h-3 w-3"})}),(0,l.jsx)(c.$,{size:"sm",variant:"outline",onClick:()=>eN(e.id),className:"text-red-600 hover:text-red-700",children:(0,l.jsx)(A.A,{className:"h-3 w-3"})})]})})]},e.id))})]})})})]})]}),"roles"===es&&(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{children:[(0,l.jsx)(i.ZB,{children:"Role-Based Access Control (RBAC)"}),(0,l.jsx)(i.BT,{children:"Manage user roles and permissions with tenant scoping"})]}),(0,l.jsxs)(i.Wu,{children:[(0,l.jsx)("div",{className:"space-y-4",children:z.map((e,s)=>(0,l.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(x.A,{className:"h-4 w-4 mr-2 ".concat("host"===e.role_level?"text-red-600":"primary_client"===e.role_level?"text-orange-600":"sub_client"===e.role_level?"text-blue-600":"text-green-600")}),(0,l.jsx)("span",{className:"text-sm font-medium",children:e.role})]}),ep&&(0,l.jsxs)("div",{className:"flex space-x-1",children:[(0,l.jsx)(c.$,{size:"sm",variant:"outline",children:(0,l.jsx)(_.A,{className:"h-3 w-3"})}),(0,l.jsx)(c.$,{size:"sm",variant:"outline",children:(0,l.jsx)(A.A,{className:"h-3 w-3"})})]})]}),(0,l.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:e.description}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("span",{className:"text-xs text-gray-500",children:[e.count," users assigned"]}),(0,l.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("host"===e.role_level?"bg-red-50 text-red-700 border border-red-200":"primary_client"===e.role_level?"bg-orange-50 text-orange-700 border border-orange-200":"sub_client"===e.role_level?"bg-blue-50 text-blue-700 border border-blue-200":"bg-green-50 text-green-700 border border-green-200"),children:"host"===e.role_level?"System-wide":"primary_client"===e.role_level?"Tenant-scoped":"sub_client"===e.role_level?"Sub-client":"Limited"})]})]},s))}),ep&&(0,l.jsx)("div",{className:"mt-4 pt-4 border-t",children:(0,l.jsx)(c.$,{size:"sm",variant:"outline",className:"w-full",children:"Create Custom Role"})})]})]}),(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{children:[(0,l.jsx)(i.ZB,{children:"Permission Matrix"}),(0,l.jsx)(i.BT,{children:"Overview of permissions by role level"})]}),(0,l.jsx)(i.Wu,{children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-xs font-medium text-gray-600 border-b pb-2",children:[(0,l.jsx)("div",{children:"Permission"}),(0,l.jsx)("div",{children:"Host"}),(0,l.jsx)("div",{children:"Primary"}),(0,l.jsx)("div",{children:"Sub"})]}),[{name:"User Management",host:!0,primary:!0,sub:!1},{name:"System Settings",host:!0,primary:!1,sub:!1},{name:"Tenant Management",host:!0,primary:!0,sub:!1},{name:"Project Management",host:!0,primary:!0,sub:!0},{name:"Reporting",host:!0,primary:!0,sub:!0},{name:"Data Export",host:!0,primary:!0,sub:!1}].map((e,s)=>(0,l.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-xs py-2 border-b",children:[(0,l.jsx)("div",{className:"font-medium",children:e.name}),(0,l.jsx)("div",{className:"text-center",children:e.host?(0,l.jsx)(m.A,{className:"h-4 w-4 text-green-500 mx-auto"}):(0,l.jsx)(o.A,{className:"h-4 w-4 text-red-500 mx-auto"})}),(0,l.jsx)("div",{className:"text-center",children:e.primary?(0,l.jsx)(m.A,{className:"h-4 w-4 text-green-500 mx-auto"}):(0,l.jsx)(o.A,{className:"h-4 w-4 text-red-500 mx-auto"})}),(0,l.jsx)("div",{className:"text-center",children:e.sub?(0,l.jsx)(m.A,{className:"h-4 w-4 text-green-500 mx-auto"}):(0,l.jsx)(o.A,{className:"h-4 w-4 text-red-500 mx-auto"})})]},s))]})})]})]}),"sso"===es&&(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{children:[(0,l.jsx)(i.ZB,{children:"Single Sign-On (SSO)"}),(0,l.jsx)(i.BT,{children:"Configure SSO providers and authentication settings"})]}),(0,l.jsxs)(i.Wu,{children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"border border-green-200 rounded-lg p-3 bg-green-50",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(m.A,{className:"h-4 w-4 text-green-600 mr-2"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"Microsoft Azure AD"})]}),(0,l.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 border border-green-200",children:"Active"})]}),(0,l.jsx)("p",{className:"text-xs text-green-700 mb-2",children:"Primary SSO provider for corporate users"}),(0,l.jsxs)("div",{className:"text-xs text-green-600",children:["Last sync: ",new Date().toLocaleDateString()," | ",R.filter(e=>e.email.includes("@")).length," users authenticated"]})]}),(0,l.jsxs)("div",{className:"border border-blue-200 rounded-lg p-3 bg-blue-50",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(m.A,{className:"h-4 w-4 text-blue-600 mr-2"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"Google Workspace"})]}),(0,l.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 border border-blue-200",children:"Active"})]}),(0,l.jsx)("p",{className:"text-xs text-blue-700 mb-2",children:"Secondary provider for external consultants"}),(0,l.jsxs)("div",{className:"text-xs text-blue-600",children:["Last sync: ",new Date().toLocaleDateString()," | ",Math.floor(.2*R.length)," users authenticated"]})]}),(0,l.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(k.A,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"SAML 2.0 Provider"})]}),(0,l.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 border border-gray-200",children:"Configured"})]}),(0,l.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:"Ready for enterprise SAML integration"}),(0,l.jsx)("div",{className:"text-xs text-gray-500",children:"Status: Ready | No active connections"})]})]}),ep&&(0,l.jsx)("div",{className:"mt-4 pt-4 border-t",children:(0,l.jsx)(c.$,{size:"sm",variant:"outline",className:"w-full",children:"Configure SSO Provider"})})]})]}),"invites"===es&&ep&&(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{children:[(0,l.jsx)(i.ZB,{children:"Pending Invitations"}),(0,l.jsx)(i.BT,{children:"Manage user invitations and track their status"})]}),(0,l.jsx)(i.Wu,{children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b",children:[(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Email"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Role"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Tenant"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Invited By"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Status"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Expires"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:F.map(e=>(0,l.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"py-3 px-4 font-medium",children:e.email}),(0,l.jsx)("td",{className:"py-3 px-4",children:e.role}),(0,l.jsx)("td",{className:"py-3 px-4",children:e.tenant_name}),(0,l.jsx)("td",{className:"py-3 px-4",children:e.invited_by}),(0,l.jsx)("td",{className:"py-3 px-4",children:(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("pending"===e.status?"bg-yellow-100 text-yellow-800":"accepted"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.status})}),(0,l.jsx)("td",{className:"py-3 px-4",children:new Date(e.expires_at).toLocaleDateString()}),(0,l.jsx)("td",{className:"py-3 px-4",children:"pending"===e.status&&(0,l.jsxs)(c.$,{size:"sm",variant:"outline",onClick:()=>e_(e.id),children:[(0,l.jsx)(C,{className:"h-3 w-3 mr-1"}),"Resend"]})})]},e.id))})]})})})]}),"cleanup"===es&&ep&&(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{children:[(0,l.jsx)(i.ZB,{children:"System Cleanup & Maintenance"}),(0,l.jsx)(i.BT,{children:"Advanced user management and cleanup operations"})]}),(0,l.jsx)(i.Wu,{children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(c.$,{onClick:()=>ex(!0),variant:"outline",className:"w-full justify-start",children:[(0,l.jsx)(A.A,{className:"h-4 w-4 mr-2"}),"Bulk User Cleanup"]}),(0,l.jsxs)(c.$,{onClick:eg,variant:"outline",className:"w-full justify-start",children:[(0,l.jsx)(w,{className:"h-4 w-4 mr-2"}),"Refresh All Data"]}),(0,l.jsxs)(c.$,{onClick:eA,variant:"outline",className:"w-full justify-start",children:[(0,l.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Export User Data"]})]})})]})]}),ep&&(0,l.jsxs)(l.Fragment,{children:[el&&(0,l.jsx)(T,{isOpen:el,onClose:()=>er(!1),onSuccess:ev,tenants:L}),ea&&(0,l.jsx)(P,{isOpen:ea,onClose:()=>en(!1),onSuccess:ey,tenants:L}),ei&&eu&&(0,l.jsx)($,{isOpen:ei,onClose:()=>{ec(!1),eh(null)},onSuccess:ev,user:eu,tenants:L}),ed&&eu&&(0,l.jsx)(M,{isOpen:ed,onClose:()=>{eo(!1),eh(null)},onSuccess:()=>{ev(),eo(!1),eh(null)},user:eu}),em&&(0,l.jsx)(Z,{isOpen:em,onClose:()=>ex(!1),onSuccess:ev})]})]}):(0,l.jsx)(n.A,{children:(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsx)(i.Zp,{className:"w-96",children:(0,l.jsxs)(i.Wu,{className:"p-6 text-center",children:[(0,l.jsx)(o.A,{className:"h-12 w-12 text-red-400 mx-auto mb-4"}),(0,l.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Access Denied"}),(0,l.jsx)("p",{className:"text-gray-600",children:"You don't have permission to access user management."}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Contact your administrator for access."})]})})})}):(0,l.jsx)(n.A,{children:(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsx)(i.Zp,{className:"w-96",children:(0,l.jsxs)(i.Wu,{className:"p-6 text-center",children:[(0,l.jsx)(x.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,l.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Authentication Required"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Please log in to access user management."})]})})})})}},8156:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(7140).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},8839:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(7140).A)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},8877:(e,s,t)=>{Promise.resolve().then(t.bind(t,7934))}},e=>{var s=s=>e(e.s=s);e.O(0,[4277,2354,8053,2099,4660,4619,8441,1684,7358],()=>s(8877)),_N_E=e.O()}]);