(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4685],{2050:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>O});var r=t(5155),l=t(2115),a=t(7020),n=t(858),i=t(7703),c=t(3741),d=t(1073),o=t(8156),m=t(2550),x=t(3408),u=t(6358),h=t(3465),p=t(5639),j=t(403),g=t(782),b=t(3388),v=t(2539),f=t(7159),y=t(8499),N=t(5847),w=t(7808),_=t(6836),A=t(936),C=t(8681),S=t(8513),k=t(477),U=t(4139),D=t(8839),I=t(9356),R=t(2099);function E(e){let{isOpen:s,onClose:t,onSuccess:a,tenants:n}=e,[d,o]=(0,l.useState)({email:"",full_name:"",phone:"",department:"",job_title:"",role:"user",role_level:"sub_client",tenant_id:"",password:"",can_invite_users:!1,can_manage_sub_clients:!1,permission_scope:"own"}),[m,h]=(0,l.useState)(!1),[p,j]=(0,l.useState)(""),g=(e,s)=>{if(o(t=>({...t,[e]:s})),"role_level"===e){let e="host"===s?"all":"primary_client"===s?"tenant":"own";o(s=>({...s,permission_scope:e}))}},b=async e=>{e.preventDefault(),h(!0),j("");try{if(!d.email||!d.full_name||!d.tenant_id||!d.password)return void j("Please fill in all required fields");let e={email:d.email,full_name:d.full_name,phone:d.phone||void 0,department:d.department||void 0,job_title:d.job_title||void 0,role:d.role,role_level:d.role_level,tenant_id:d.tenant_id,password:d.password,can_invite_users:d.can_invite_users,can_manage_sub_clients:d.can_manage_sub_clients,permission_scope:d.permission_scope},s=await R.Lr.createUser(e);s.success?(a(),t(),o({email:"",full_name:"",phone:"",department:"",job_title:"",role:"user",role_level:"sub_client",tenant_id:"",password:"",can_invite_users:!1,can_manage_sub_clients:!1,permission_scope:"own"})):j(s.error||"Failed to create user")}catch(e){j("An error occurred while creating the user"),console.error("User creation error:",e)}finally{h(!1)}};return s?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)(i.Zp,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(i.ZB,{className:"flex items-center",children:[(0,r.jsx)(k.A,{className:"h-5 w-5 mr-2"}),"Create New User"]}),(0,r.jsx)(i.BT,{children:"Add a new user to the system with appropriate role and permissions"})]}),(0,r.jsx)(c.$,{variant:"outline",size:"sm",onClick:t,children:(0,r.jsx)(U.A,{className:"h-4 w-4"})})]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[p&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,r.jsx)("p",{className:"text-sm text-red-600",children:p})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Basic Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(u.A,{className:"h-4 w-4 inline mr-1"}),"Email Address *"]}),(0,r.jsx)("input",{type:"email",required:!0,value:d.email,onChange:e=>g("email",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"user@company.com"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(k.A,{className:"h-4 w-4 inline mr-1"}),"Full Name *"]}),(0,r.jsx)("input",{type:"text",required:!0,value:d.full_name,onChange:e=>g("full_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(D.A,{className:"h-4 w-4 inline mr-1"}),"Phone Number"]}),(0,r.jsx)("input",{type:"tel",value:d.phone,onChange:e=>g("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+1 (555) 123-4567"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(I.A,{className:"h-4 w-4 inline mr-1"}),"Job Title"]}),(0,r.jsx)("input",{type:"text",value:d.job_title,onChange:e=>g("job_title",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Software Engineer"})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(v.A,{className:"h-4 w-4 inline mr-1"}),"Department"]}),(0,r.jsx)("input",{type:"text",value:d.department,onChange:e=>g("department",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Engineering"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Role and Permissions"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(x.A,{className:"h-4 w-4 inline mr-1"}),"Role Level *"]}),(0,r.jsxs)("select",{required:!0,value:d.role_level,onChange:e=>g("role_level",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"sub_client",children:"Sub Client"}),(0,r.jsx)("option",{value:"primary_client",children:"Primary Client"}),(0,r.jsx)("option",{value:"host",children:"Host Admin"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),(0,r.jsxs)("select",{required:!0,value:d.role,onChange:e=>g("role",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"viewer",children:"Viewer"}),(0,r.jsx)("option",{value:"user",children:"User"}),(0,r.jsx)("option",{value:"manager",children:"Manager"}),(0,r.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(v.A,{className:"h-4 w-4 inline mr-1"}),"Tenant *"]}),(0,r.jsxs)("select",{required:!0,value:d.tenant_id,onChange:e=>g("tenant_id",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Select Tenant"}),n.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.tenant_type,")"]},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Permission Scope"}),(0,r.jsxs)("select",{value:d.permission_scope,onChange:e=>g("permission_scope",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"own",children:"Own Data Only"}),(0,r.jsx)("option",{value:"tenant",children:"Tenant Scope"}),(0,r.jsx)("option",{value:"all",children:"All Data"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"can_invite_users",checked:d.can_invite_users,onChange:e=>g("can_invite_users",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"can_invite_users",className:"ml-2 text-sm text-gray-700",children:"Can invite other users"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"can_manage_sub_clients",checked:d.can_manage_sub_clients,onChange:e=>g("can_manage_sub_clients",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"can_manage_sub_clients",className:"ml-2 text-sm text-gray-700",children:"Can manage sub-client users"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Authentication"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Temporary Password *"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("input",{type:"text",required:!0,value:d.password,onChange:e=>g("password",e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter temporary password"}),(0,r.jsx)(c.$,{type:"button",onClick:()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*",s="";for(let t=0;t<12;t++)s+=e.charAt(Math.floor(Math.random()*e.length));o(e=>({...e,password:s}))},variant:"outline",children:"Generate"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"User will be required to change password on first login"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,r.jsx)(c.$,{type:"button",variant:"outline",onClick:t,disabled:m,children:"Cancel"}),(0,r.jsx)(c.$,{type:"submit",disabled:m,children:m?"Creating...":"Create User"})]})]})})]})}):null}function T(e){var s;let{isOpen:t,onClose:a,onSuccess:n,tenants:d}=e,[o,m]=(0,l.useState)({emails:"",role:"user",role_level:"sub_client",tenant_id:"",message:"",expires_in_days:7}),[h,p]=(0,l.useState)(!1),[g,b]=(0,l.useState)(""),[f,y]=(0,l.useState)(0),N=(e,s)=>{m(t=>({...t,[e]:s})),"emails"===e&&y(s.split(/[,\n]/).filter(e=>e.trim().length>0).length)},w=e=>{let s=e.split(/[,\n]/).map(e=>e.trim()).filter(e=>e.length>0),t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,r=[],l=[];if(s.forEach(e=>{t.test(e)?r.push(e):l.push(e)}),l.length>0)throw Error("Invalid email addresses: ".concat(l.join(", ")));return r},_=async e=>{e.preventDefault(),p(!0),b("");try{let e=w(o.emails);if(0===e.length)throw Error("Please enter at least one valid email address");if(!o.tenant_id)throw Error("Please select a tenant");let s={emails:e,role:o.role,role_level:o.role_level,tenant_id:o.tenant_id,message:o.message||void 0,expires_in_days:o.expires_in_days},t=await R.Lr.inviteUsers(s);t.success?(n(),a(),m({emails:"",role:"user",role_level:"sub_client",tenant_id:"",message:"",expires_in_days:7}),y(0)):b(t.error||"Failed to send invitations")}catch(e){b(e instanceof Error?e.message:"An error occurred while sending invitations"),console.error("Invitation error:",e)}finally{p(!1)}};return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)(i.Zp,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(i.ZB,{className:"flex items-center",children:[(0,r.jsx)(u.A,{className:"h-5 w-5 mr-2"}),"Invite Users"]}),(0,r.jsx)(i.BT,{children:"Send email invitations to new users to join the platform"})]}),(0,r.jsx)(c.$,{variant:"outline",size:"sm",onClick:a,children:(0,r.jsx)(U.A,{className:"h-4 w-4"})})]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsxs)("form",{onSubmit:_,className:"space-y-6",children:[g&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,r.jsx)("p",{className:"text-sm text-red-600",children:g})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Recipients"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(u.A,{className:"h-4 w-4 inline mr-1"}),"Email Addresses *"]}),(0,r.jsx)("textarea",{required:!0,rows:4,value:o.emails,onChange:e=>N("emails",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email addresses separated by commas or new lines: user1@company.com user2@company.com, user3@company.com"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:f>0?"".concat(f," email").concat(f>1?"s":""," to be invited"):"Separate multiple emails with commas or new lines"})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Role Assignment"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(x.A,{className:"h-4 w-4 inline mr-1"}),"Role Level *"]}),(0,r.jsxs)("select",{required:!0,value:o.role_level,onChange:e=>N("role_level",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"sub_client",children:"Sub Client"}),(0,r.jsx)("option",{value:"primary_client",children:"Primary Client"}),(0,r.jsx)("option",{value:"host",children:"Host Admin"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),(0,r.jsxs)("select",{required:!0,value:o.role,onChange:e=>N("role",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"viewer",children:"Viewer"}),(0,r.jsx)("option",{value:"user",children:"User"}),(0,r.jsx)("option",{value:"manager",children:"Manager"}),(0,r.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(v.A,{className:"h-4 w-4 inline mr-1"}),"Tenant *"]}),(0,r.jsxs)("select",{required:!0,value:o.tenant_id,onChange:e=>N("tenant_id",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Select Tenant"}),d.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.tenant_type,")"]},e.id))]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Invitation Settings"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expires In (Days)"}),(0,r.jsxs)("select",{value:o.expires_in_days,onChange:e=>N("expires_in_days",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:1,children:"1 Day"}),(0,r.jsx)("option",{value:3,children:"3 Days"}),(0,r.jsx)("option",{value:7,children:"7 Days"}),(0,r.jsx)("option",{value:14,children:"14 Days"}),(0,r.jsx)("option",{value:30,children:"30 Days"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Custom Message"}),(0,r.jsx)("textarea",{rows:3,value:o.message,onChange:e=>N("message",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:(()=>{let e=d.find(e=>e.id===o.tenant_id);return"You have been invited to join ".concat((null==e?void 0:e.name)||"our organization"," on the ETLA Platform. Please click the link below to accept your invitation and set up your account.")})()}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to use the default invitation message"})]})]}),f>0&&o.tenant_id&&(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[(0,r.jsxs)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:[(0,r.jsx)(j.A,{className:"h-4 w-4 inline mr-1"}),"Invitation Preview"]}),(0,r.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:f})," user",f>1?"s":""," will be invited as ",(0,r.jsx)("strong",{children:o.role})," (",o.role_level,") to ",(0,r.jsx)("strong",{children:null==(s=d.find(e=>e.id===o.tenant_id))?void 0:s.name})]}),(0,r.jsxs)("p",{className:"mt-1",children:["Invitations will expire in ",(0,r.jsxs)("strong",{children:[o.expires_in_days," day",o.expires_in_days>1?"s":""]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,r.jsx)(c.$,{type:"button",variant:"outline",onClick:a,disabled:h,children:"Cancel"}),(0,r.jsxs)(c.$,{type:"submit",disabled:h||0===f,children:[(0,r.jsx)(C.A,{className:"h-4 w-4 mr-2"}),h?"Sending...":"Send ".concat(f," Invitation").concat(f>1?"s":"")]})]})]})})]})}):null}var P=t(92);function L(e){let{isOpen:s,onClose:t,onSuccess:a,user:n,tenants:d}=e,[o,m]=(0,l.useState)({full_name:"",phone:"",department:"",job_title:"",role:"user",role_level:"sub_client",tenant_id:"",is_active:!0,can_invite_users:!1,can_manage_sub_clients:!1,permission_scope:"own"}),[u,h]=(0,l.useState)(!1),[p,j]=(0,l.useState)("");(0,l.useEffect)(()=>{n&&m({full_name:n.full_name||"",phone:n.phone||"",department:n.department||"",job_title:n.job_title||"",role:n.role,role_level:n.role_level,tenant_id:n.tenant_id,is_active:n.is_active,can_invite_users:n.can_invite_users,can_manage_sub_clients:n.can_manage_sub_clients,permission_scope:n.permission_scope})},[n]);let g=(e,s)=>{if(m(t=>({...t,[e]:s})),"role_level"===e){let e="host"===s?"all":"primary_client"===s?"tenant":"own";m(s=>({...s,permission_scope:e}))}},b=async e=>{e.preventDefault(),h(!0),j("");try{if(!o.full_name||!o.tenant_id)return void j("Please fill in all required fields");let e={full_name:o.full_name,phone:o.phone||void 0,department:o.department||void 0,job_title:o.job_title||void 0,role:o.role,role_level:o.role_level,tenant_id:o.tenant_id,is_active:o.is_active,can_invite_users:o.can_invite_users,can_manage_sub_clients:o.can_manage_sub_clients,permission_scope:o.permission_scope},s=await R.Lr.updateUser(n.id,e);s.success?(a(),t()):j(s.error||"Failed to update user")}catch(e){j("An error occurred while updating the user"),console.error("User update error:",e)}finally{h(!1)}},f=async()=>{if(window.confirm("Are you sure you want to deactivate this user? They will lose access to the system.")){h(!0),j("");try{let e=await R.Lr.deactivateUser(n.id);e.success?(a(),t()):j(e.error||"Failed to deactivate user")}catch(e){j("An error occurred while deactivating the user"),console.error("User deactivation error:",e)}finally{h(!1)}}},y=async()=>{h(!0),j("");try{let e=await R.Lr.activateUser(n.id);e.success?(a(),t()):j(e.error||"Failed to activate user")}catch(e){j("An error occurred while activating the user"),console.error("User activation error:",e)}finally{h(!1)}};return s&&n?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)(i.Zp,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(i.ZB,{className:"flex items-center",children:[(0,r.jsx)(k.A,{className:"h-5 w-5 mr-2"}),"Edit User: ",n.full_name]}),(0,r.jsx)(i.BT,{children:"Update user information, role, and permissions"})]}),(0,r.jsx)(c.$,{variant:"outline",size:"sm",onClick:t,children:(0,r.jsx)(U.A,{className:"h-4 w-4"})})]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[p&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,r.jsx)("p",{className:"text-sm text-red-600",children:p})}),(0,r.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"Account Status"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:n.email})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(n.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:n.is_active?"Active":"Inactive"}),n.is_active?(0,r.jsx)(c.$,{type:"button",size:"sm",variant:"outline",onClick:f,disabled:u,children:"Deactivate"}):(0,r.jsx)(c.$,{type:"button",size:"sm",onClick:y,disabled:u,children:"Activate"})]})]})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Basic Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(k.A,{className:"h-4 w-4 inline mr-1"}),"Full Name *"]}),(0,r.jsx)("input",{type:"text",required:!0,value:o.full_name,onChange:e=>g("full_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(D.A,{className:"h-4 w-4 inline mr-1"}),"Phone Number"]}),(0,r.jsx)("input",{type:"tel",value:o.phone,onChange:e=>g("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+1 (555) 123-4567"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(I.A,{className:"h-4 w-4 inline mr-1"}),"Job Title"]}),(0,r.jsx)("input",{type:"text",value:o.job_title,onChange:e=>g("job_title",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Software Engineer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(v.A,{className:"h-4 w-4 inline mr-1"}),"Department"]}),(0,r.jsx)("input",{type:"text",value:o.department,onChange:e=>g("department",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Engineering"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Role and Permissions"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(x.A,{className:"h-4 w-4 inline mr-1"}),"Role Level *"]}),(0,r.jsxs)("select",{required:!0,value:o.role_level,onChange:e=>g("role_level",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"sub_client",children:"Sub Client"}),(0,r.jsx)("option",{value:"primary_client",children:"Primary Client"}),(0,r.jsx)("option",{value:"host",children:"Host Admin"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),(0,r.jsxs)("select",{required:!0,value:o.role,onChange:e=>g("role",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"viewer",children:"Viewer"}),(0,r.jsx)("option",{value:"user",children:"User"}),(0,r.jsx)("option",{value:"manager",children:"Manager"}),(0,r.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,r.jsx)(v.A,{className:"h-4 w-4 inline mr-1"}),"Tenant *"]}),(0,r.jsxs)("select",{required:!0,value:o.tenant_id,onChange:e=>g("tenant_id",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Select Tenant"}),d.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.tenant_type,")"]},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Permission Scope"}),(0,r.jsxs)("select",{value:o.permission_scope,onChange:e=>g("permission_scope",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"own",children:"Own Data Only"}),(0,r.jsx)("option",{value:"tenant",children:"Tenant Scope"}),(0,r.jsx)("option",{value:"all",children:"All Data"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"can_invite_users",checked:o.can_invite_users,onChange:e=>g("can_invite_users",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"can_invite_users",className:"ml-2 text-sm text-gray-700",children:"Can invite other users"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"can_manage_sub_clients",checked:o.can_manage_sub_clients,onChange:e=>g("can_manage_sub_clients",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"can_manage_sub_clients",className:"ml-2 text-sm text-gray-700",children:"Can manage sub-client users"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"is_active",checked:o.is_active,onChange:e=>g("is_active",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"is_active",className:"ml-2 text-sm text-gray-700",children:"Account is active"})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,r.jsx)(c.$,{type:"button",variant:"outline",onClick:t,disabled:u,children:"Cancel"}),(0,r.jsxs)(c.$,{type:"submit",disabled:u,children:[(0,r.jsx)(P.A,{className:"h-4 w-4 mr-2"}),u?"Saving...":"Save Changes"]})]})]})})]})}):null}function $(e){let{isOpen:s,onClose:t,onSuccess:a,user:n}=e,[d,o]=(0,l.useState)(!1),[x,h]=(0,l.useState)(""),[p,j]=(0,l.useState)(!1),[b,v]=(0,l.useState)("email"),[f,y]=(0,l.useState)(""),N=async()=>{o(!0),h("");try{let e=await R.Lr.resetUserPassword(n.email);e.success?(j(!0),setTimeout(()=>{a(),_()},2e3)):h(e.error||"Failed to send password reset email")}catch(e){h(e.message||"Failed to send password reset email")}finally{o(!1)}},w=async()=>{if(!f||f.length<8)return void h("Password must be at least 8 characters long");o(!0),h("");try{let e=await R.Lr.resetUserPassword(n.email,f);e.success?(j(!0),setTimeout(()=>{a(),_()},2e3)):h(e.error||"Failed to reset password")}catch(e){h(e.message||"Failed to reset password")}finally{o(!1)}},_=()=>{h(""),j(!1),y(""),v("email"),t()};return s&&n?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)(i.Zp,{className:"w-full max-w-md",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(i.ZB,{className:"flex items-center",children:[(0,r.jsx)(g.A,{className:"h-5 w-5 mr-2"}),"Reset Password"]}),(0,r.jsxs)(i.BT,{children:["Reset password for ",n.full_name]})]}),(0,r.jsx)(c.$,{variant:"outline",size:"sm",onClick:_,children:(0,r.jsx)(U.A,{className:"h-4 w-4"})})]})}),(0,r.jsxs)(i.Wu,{className:"space-y-6",children:[x&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(A.A,{className:"h-4 w-4 text-red-600 mr-2"}),(0,r.jsx)("p",{className:"text-sm text-red-600",children:x})]})}),p&&(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-md p-3",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 text-green-600 mr-2"}),(0,r.jsx)("p",{className:"text-sm text-green-600",children:"email"===b?"Password reset email sent successfully!":"Password reset successfully!"})]})}),!p&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-3",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(u.A,{className:"h-4 w-4 text-gray-600 mr-2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:n.full_name}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:n.email})]})]})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Reset Method"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"radio",id:"email_reset",name:"reset_method",value:"email",checked:"email"===b,onChange:e=>v(e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),(0,r.jsx)("label",{htmlFor:"email_reset",className:"ml-2 text-sm text-gray-700",children:"Send reset email to user"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 ml-6",children:"User will receive an email with instructions to reset their password"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"radio",id:"direct_reset",name:"reset_method",value:"direct",checked:"direct"===b,onChange:e=>v(e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),(0,r.jsx)("label",{htmlFor:"direct_reset",className:"ml-2 text-sm text-gray-700",children:"Set new password directly"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 ml-6",children:"Set a temporary password that the user must change on next login"})]})]}),"direct"===b&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"New Temporary Password"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("input",{type:"text",value:f,onChange:e=>y(e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter new password"}),(0,r.jsx)(c.$,{type:"button",onClick:()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*",s="";for(let t=0;t<12;t++)s+=e.charAt(Math.floor(Math.random()*e.length));y(s)},variant:"outline",size:"sm",children:"Generate"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"User will be required to change this password on their next login"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,r.jsx)(c.$,{variant:"outline",onClick:_,disabled:d,children:"Cancel"}),(0,r.jsx)(c.$,{onClick:"email"===b?N:w,disabled:d||"direct"===b&&!f,children:d?"Processing...":"email"===b?"Send Reset Email":"Reset Password"})]})]})]})]})}):null}var B=t(2540),F=t(9169);function Z(e){let{isOpen:s,onClose:t,onSuccess:a}=e,[n,d]=(0,l.useState)(!1),[o,x]=(0,l.useState)(""),[u,h]=(0,l.useState)(!1),[p,g]=(0,l.useState)("options"),[b,v]=(0,l.useState)({deleteInactiveUsers:!1,deleteUnconfirmedUsers:!0,deleteExpiredInvites:!0,inactiveDays:90,unconfirmedDays:30}),[f,y]=(0,l.useState)(null),N=(e,s)=>{v(t=>({...t,[e]:s}))},w=async()=>{d(!0),x("");try{let e={deleteInactiveUsers:b.deleteInactiveUsers,deleteUnconfirmedUsers:b.deleteUnconfirmedUsers,deleteExpiredInvites:b.deleteExpiredInvites,inactiveDays:b.inactiveDays,unconfirmedDays:b.unconfirmedDays},s=await R.Lr.previewUserCleanup(e);s.success&&s.data?(y(s.data),g("preview")):x(s.error||"Failed to generate cleanup preview")}catch(e){x("An error occurred while generating the cleanup preview"),console.error("Cleanup preview error:",e)}finally{d(!1)}},C=async()=>{d(!0),x("");try{let e={deleteInactiveUsers:b.deleteInactiveUsers,deleteUnconfirmedUsers:b.deleteUnconfirmedUsers,deleteExpiredInvites:b.deleteExpiredInvites,inactiveDays:b.inactiveDays,unconfirmedDays:b.unconfirmedDays},s=await R.Lr.executeUserCleanup(e);s.success?(h(!0),setTimeout(()=>{a(),S()},3e3)):x(s.error||"Failed to execute cleanup")}catch(e){x("An error occurred while executing the cleanup"),console.error("Cleanup execution error:",e)}finally{d(!1)}},S=()=>{x(""),h(!1),g("options"),y(null),v({deleteInactiveUsers:!1,deleteUnconfirmedUsers:!0,deleteExpiredInvites:!0,inactiveDays:90,unconfirmedDays:30}),t()};return s?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)(i.Zp,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(i.ZB,{className:"flex items-center",children:[(0,r.jsx)(B.A,{className:"h-5 w-5 mr-2"}),"User Cleanup Utility"]}),(0,r.jsx)(i.BT,{children:"Clean up inactive users, unconfirmed accounts, and expired invitations"})]}),(0,r.jsx)(c.$,{variant:"outline",size:"sm",onClick:S,children:(0,r.jsx)(U.A,{className:"h-4 w-4"})})]})}),(0,r.jsxs)(i.Wu,{className:"space-y-6",children:[o&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(A.A,{className:"h-4 w-4 text-red-600 mr-2"}),(0,r.jsx)("p",{className:"text-sm text-red-600",children:o})]})}),u&&(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-md p-3",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 text-green-600 mr-2"}),(0,r.jsx)("p",{className:"text-sm text-green-600",children:"User cleanup completed successfully! The system has been cleaned up."})]})}),!u&&(0,r.jsxs)(r.Fragment,{children:["options"===p&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(A.A,{className:"h-5 w-5 text-yellow-600 mr-2 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-yellow-800",children:"Warning"}),(0,r.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"This operation will permanently delete user accounts and cannot be undone. Please review your selections carefully."})]})]})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Cleanup Options"}),(0,r.jsxs)("div",{className:"border border-gray-200 rounded-md p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"deleteInactiveUsers",checked:b.deleteInactiveUsers,onChange:e=>N("deleteInactiveUsers",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"deleteInactiveUsers",className:"ml-2 text-sm font-medium text-gray-900",children:"Delete inactive users"})]}),(0,r.jsx)(j.A,{className:"h-4 w-4 text-gray-400"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Remove users who haven't logged in for a specified period"}),b.deleteInactiveUsers&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("label",{className:"text-sm text-gray-700",children:"Inactive for more than:"}),(0,r.jsxs)("select",{value:b.inactiveDays,onChange:e=>N("inactiveDays",parseInt(e.target.value)),className:"px-2 py-1 border border-gray-300 rounded text-sm",children:[(0,r.jsx)("option",{value:30,children:"30 days"}),(0,r.jsx)("option",{value:60,children:"60 days"}),(0,r.jsx)("option",{value:90,children:"90 days"}),(0,r.jsx)("option",{value:180,children:"180 days"}),(0,r.jsx)("option",{value:365,children:"1 year"})]})]})]}),(0,r.jsxs)("div",{className:"border border-gray-200 rounded-md p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"deleteUnconfirmedUsers",checked:b.deleteUnconfirmedUsers,onChange:e=>N("deleteUnconfirmedUsers",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"deleteUnconfirmedUsers",className:"ml-2 text-sm font-medium text-gray-900",children:"Delete unconfirmed users"})]}),(0,r.jsx)(F.A,{className:"h-4 w-4 text-gray-400"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Remove users who haven't confirmed their email addresses"}),b.deleteUnconfirmedUsers&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("label",{className:"text-sm text-gray-700",children:"Created more than:"}),(0,r.jsxs)("select",{value:b.unconfirmedDays,onChange:e=>N("unconfirmedDays",parseInt(e.target.value)),className:"px-2 py-1 border border-gray-300 rounded text-sm",children:[(0,r.jsx)("option",{value:7,children:"7 days"}),(0,r.jsx)("option",{value:14,children:"14 days"}),(0,r.jsx)("option",{value:30,children:"30 days"}),(0,r.jsx)("option",{value:60,children:"60 days"})]}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:"ago"})]})]}),(0,r.jsxs)("div",{className:"border border-gray-200 rounded-md p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"deleteExpiredInvites",checked:b.deleteExpiredInvites,onChange:e=>N("deleteExpiredInvites",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"deleteExpiredInvites",className:"ml-2 text-sm font-medium text-gray-900",children:"Delete expired invitations"})]}),(0,r.jsx)(F.A,{className:"h-4 w-4 text-gray-400"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Remove invitation records that have expired and are no longer valid"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,r.jsx)(c.$,{variant:"outline",onClick:S,disabled:n,children:"Cancel"}),(0,r.jsx)(c.$,{onClick:w,disabled:n||!b.deleteInactiveUsers&&!b.deleteUnconfirmedUsers&&!b.deleteExpiredInvites,children:n?"Generating...":"Preview Cleanup"})]})]}),"preview"===p&&f&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Cleanup Preview"}),(0,r.jsx)("p",{className:"text-sm text-blue-700",children:"Review what will be deleted before proceeding with the cleanup."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[b.deleteInactiveUsers&&(0,r.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(j.A,{className:"h-8 w-8 text-gray-600"}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:f.inactiveUsers}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Inactive Users"})]})]})}),b.deleteUnconfirmedUsers&&(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(F.A,{className:"h-8 w-8 text-yellow-600"}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:f.unconfirmedUsers}),(0,r.jsx)("p",{className:"text-sm text-yellow-700",children:"Unconfirmed Users"})]})]})}),b.deleteExpiredInvites&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(_.A,{className:"h-8 w-8 text-red-600"}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-2xl font-bold text-red-900",children:f.expiredInvites}),(0,r.jsx)("p",{className:"text-sm text-red-700",children:"Expired Invites"})]})]})})]}),(0,r.jsx)("div",{className:"bg-gray-900 text-white rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-lg font-medium",children:"Total items to be deleted:"}),(0,r.jsx)("span",{className:"text-2xl font-bold",children:f.totalToDelete})]})}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,r.jsx)(c.$,{variant:"outline",onClick:()=>g("options"),disabled:n,children:"Back"}),(0,r.jsx)(c.$,{onClick:()=>g("confirm"),disabled:n||0===f.totalToDelete,variant:f.totalToDelete>0?"destructive":"outline",children:f.totalToDelete>0?"Proceed to Confirm":"Nothing to Clean"})]})]}),"confirm"===p&&f&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(A.A,{className:"h-5 w-5 text-red-600 mr-2 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-red-800",children:"Final Confirmation"}),(0,r.jsxs)("p",{className:"text-sm text-red-700 mt-1",children:["You are about to permanently delete ",(0,r.jsx)("strong",{children:f.totalToDelete})," items from the system. This action cannot be undone."]})]})]})}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-md p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Summary of actions:"}),(0,r.jsxs)("ul",{className:"space-y-2 text-sm text-gray-600",children:[b.deleteInactiveUsers&&(0,r.jsxs)("li",{children:["• Delete ",f.inactiveUsers," users inactive for more than ",b.inactiveDays," days"]}),b.deleteUnconfirmedUsers&&(0,r.jsxs)("li",{children:["• Delete ",f.unconfirmedUsers," unconfirmed users created more than ",b.unconfirmedDays," days ago"]}),b.deleteExpiredInvites&&(0,r.jsxs)("li",{children:["• Delete ",f.expiredInvites," expired invitation records"]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,r.jsx)(c.$,{variant:"outline",onClick:()=>g("preview"),disabled:n,children:"Back"}),(0,r.jsx)(c.$,{onClick:C,disabled:n,variant:"destructive",children:n?"Executing Cleanup...":"Execute Cleanup"})]})]})]})]})]})}):null}function O(){let{user:e,isAuthenticated:s,tenant:t}=(0,a.h)(),{hasPermission:k,currentRole:U,isHostAdmin:D}=(0,S.Sk)(),[I,P]=(0,l.useState)([]),[B,F]=(0,l.useState)([]),[O,z]=(0,l.useState)([]),[M,q]=(0,l.useState)([]),[W,V]=(0,l.useState)(!0),[G,H]=(0,l.useState)(""),[J,Y]=(0,l.useState)(""),[K,Q]=(0,l.useState)("all"),[X,ee]=(0,l.useState)("all"),[es,et]=(0,l.useState)("overview"),[er,el]=(0,l.useState)(!1),[ea,en]=(0,l.useState)(!1),[ei,ec]=(0,l.useState)(!1),[ed,eo]=(0,l.useState)(!1),[em,ex]=(0,l.useState)(!1),[eu,eh]=(0,l.useState)(null),ep=k("user-management","manage")&&D(),ej=k("user-management","view")||ep;(0,l.useEffect)(()=>{s&&ej&&eg()},[s,ej]);let eg=async()=>{V(!0);try{await Promise.all([eb(),ev(),ef(),ey()])}catch(e){console.error("Error loading data:",e)}finally{V(!1)}},eb=async()=>{try{let{data:e,error:s}=await R.ND.from("profiles").select("\n          *,\n          tenant_users!inner(\n            role,\n            role_level,\n            is_active,\n            tenant_id,\n            tenants(name)\n          )\n        ").order("created_at",{ascending:!1});if(s)throw s;let t=(null==e?void 0:e.map(e=>{var s,t,r,l,a,n,i,c,d,o;return{id:e.id,email:e.email||"N/A",full_name:e.full_name||"Unknown",role:(null==(s=e.tenant_users[0])?void 0:s.role)||"user",role_level:(null==(t=e.tenant_users[0])?void 0:t.role_level)||"sub_client",tenant_name:(null==(l=e.tenant_users[0])||null==(r=l.tenants)?void 0:r.name)||"No Tenant",tenant_id:null==(a=e.tenant_users[0])?void 0:a.tenant_id,is_active:null==(o=null==(n=e.tenant_users[0])?void 0:n.is_active)||o,created_at:e.created_at,last_sign_in_at:e.last_sign_in_at,phone:e.phone,department:e.department,job_title:e.job_title,can_invite_users:["admin","manager"].includes((null==(i=e.tenant_users[0])?void 0:i.role)||""),can_manage_sub_clients:(null==(c=e.tenant_users[0])?void 0:c.role_level)==="primary_client",permission_scope:(null==(d=e.tenant_users[0])?void 0:d.permission_scope)||"own"}}))||[];P(t)}catch(e){console.error("Error loading users:",e),H("Failed to load users")}},ev=async()=>{try{let{data:e,error:s}=await R.ND.from("tenants").select("*").order("name");if(s)throw s;F(e||[])}catch(e){console.error("Error loading tenants:",e),H("Failed to load tenants")}},ef=async()=>{try{z([])}catch(e){console.error("Error loading invites:",e),H("Failed to load invites")}},ey=async()=>{try{let{data:e,error:s}=await R.ND.from("tenant_users").select("role, role_level");if(s)throw s;let t=Object.entries((null==e?void 0:e.reduce((e,s)=>{let t="".concat(s.role_level,"_").concat(s.role);return e[t]=(e[t]||0)+1,e},{}))||{}).map(e=>{let[s,t]=e,[r,l]=s.split("_");return{role:l,role_level:r,count:t,description:"".concat(r," ").concat(l,"s")}});q(t)}catch(e){console.error("Error loading role stats:",e),H("Failed to load role stats")}},eN=async e=>{if(window.confirm("Are you sure you want to delete this user? This action cannot be undone."))try{let{error:s}=await R.ND.from("tenant_users").delete().eq("user_id",e);if(s)throw s;let{error:t}=await R.ND.from("profiles").delete().eq("id",e);if(t)throw t;console.log("User deleted from profiles and tenant_users. Auth user may need manual cleanup."),await eb()}catch(e){console.error("Error deleting user:",e),H("Failed to delete user")}},ew=(e,s)=>{eh(I.find(s=>s.id===e)||null),eo(!0)},e_=async e=>{try{console.log("Resending invite:",e),await ef()}catch(e){console.error("Error resending invite:",e),H("Failed to resend invite")}},eA=()=>{let e=new Blob([["Email,Name,Role,Level,Tenant,Status,Last Login,Created",...eC.map(e=>[e.email,e.full_name,e.role,e.role_level,e.tenant_name,e.is_active?"Active":"Inactive",e.last_sign_in_at?new Date(e.last_sign_in_at).toLocaleDateString():"Never",new Date(e.created_at).toLocaleDateString()].join(","))].join("\n")],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="users-export-".concat(new Date().toISOString().split("T")[0],".csv"),t.click(),window.URL.revokeObjectURL(s)},eC=I.filter(e=>{let s=e.email.toLowerCase().includes(J.toLowerCase())||e.full_name.toLowerCase().includes(J.toLowerCase()),t="all"===K||e.tenant_id===K,r="all"===X||e.role===X;return s&&t&&r}),eS=(e,s)=>"host"===s?"bg-purple-100 text-purple-800":"primary_client"===s?"bg-blue-100 text-blue-800":"sub_client"===s?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",ek=e=>e.email_confirmed_at?e.is_active?(0,r.jsx)(m.A,{className:"h-4 w-4 text-green-500"}):(0,r.jsx)(o.A,{className:"h-4 w-4 text-red-500"}):(0,r.jsx)(d.A,{className:"h-4 w-4 text-yellow-500"});return s?ej?(0,r.jsxs)(n.A,{children:[(0,r.jsxs)("div",{className:"p-6 lg:p-8",children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Access Control & Security"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:ep?"Comprehensive user management, RBAC, and security controls":"User management and security overview for ".concat(null==t?void 0:t.name)})]}),ep&&(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)(c.$,{onClick:()=>en(!0),variant:"outline",children:[(0,r.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Invite User"]}),(0,r.jsxs)(c.$,{onClick:()=>el(!0),children:[(0,r.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Create User"]})]})]})}),(0,r.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,r.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:p.A},{id:"users",label:"Users",icon:j.A},{id:"roles",label:"Roles & Permissions",icon:x.A},{id:"sso",label:"SSO Configuration",icon:g.A},...ep?[{id:"invites",label:"Invitations",icon:u.A},{id:"cleanup",label:"System Cleanup",icon:b.A}]:[]].map(e=>{let{id:s,label:t,icon:l}=e;return(0,r.jsxs)("button",{onClick:()=>et(s),className:"flex items-center py-2 px-1 border-b-2 font-medium text-sm ".concat(es===s?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,r.jsx)(l,{className:"h-4 w-4 mr-2"}),t]},s)})})}),"overview"===es&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,r.jsx)(i.Zp,{children:(0,r.jsx)(i.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:I.length})]}),(0,r.jsx)(j.A,{className:"h-8 w-8 text-blue-600"})]})})}),(0,r.jsx)(i.Zp,{children:(0,r.jsx)(i.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Tenants"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:B.filter(e=>"active"===e.status).length})]}),(0,r.jsx)(v.A,{className:"h-8 w-8 text-green-600"})]})})}),(0,r.jsx)(i.Zp,{children:(0,r.jsx)(i.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending Invites"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:O.filter(e=>"pending"===e.status).length})]}),(0,r.jsx)(u.A,{className:"h-8 w-8 text-yellow-600"})]})})}),(0,r.jsx)(i.Zp,{children:(0,r.jsx)(i.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Users"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:I.filter(e=>e.is_active).length})]}),(0,r.jsx)(m.A,{className:"h-8 w-8 text-purple-600"})]})})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,r.jsxs)(i.Zp,{children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsx)(i.ZB,{children:"Role Distribution"}),(0,r.jsx)(i.BT,{children:"Current user distribution across roles and levels"})]}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("div",{className:"space-y-4",children:M.map((e,s)=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(x.A,{className:"h-4 w-4 mr-2 ".concat("host"===e.role_level?"text-purple-600":"primary_client"===e.role_level?"text-blue-600":"text-green-600")}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:[e.role," (",e.role_level,")"]})]}),(0,r.jsxs)("span",{className:"text-sm font-bold text-gray-900",children:[e.count," users"]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-600",children:e.description})]},s))})})]}),(0,r.jsxs)(i.Zp,{children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsx)(i.ZB,{children:"Tenant Overview"}),(0,r.jsx)(i.BT,{children:"Active tenants and user distribution"})]}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("div",{className:"space-y-3",children:B.slice(0,5).map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.tenant_type})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"font-medium",children:[e.user_count," users"]}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.status})]})]},e.id))})})]})]})]}),"users"===es&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,r.jsx)("input",{type:"text",placeholder:"Search users by email or name...",value:J,onChange:e=>Y(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),(0,r.jsxs)("select",{value:K,onChange:e=>Q(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"all",children:"All Tenants"}),B.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,r.jsxs)("select",{value:X,onChange:e=>ee(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"all",children:"All Roles"}),(0,r.jsx)("option",{value:"admin",children:"Admin"}),(0,r.jsx)("option",{value:"manager",children:"Manager"}),(0,r.jsx)("option",{value:"user",children:"User"}),(0,r.jsx)("option",{value:"viewer",children:"Viewer"})]}),(0,r.jsxs)(c.$,{onClick:eA,variant:"outline",children:[(0,r.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Export"]})]}),(0,r.jsxs)(i.Zp,{children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsxs)(i.ZB,{children:["Users (",eC.length,")"]}),(0,r.jsx)(i.BT,{children:ep?"Manage all users across the platform":"View users in your organization"})]}),(0,r.jsx)(i.Wu,{children:W?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)(N.A,{className:"h-6 w-6 animate-spin text-gray-400"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading users..."})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"User"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Role"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Tenant"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Status"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Last Login"}),ep&&(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:eC.map(e=>(0,r.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[ek(e),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.full_name}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.email}),e.job_title&&(0,r.jsx)("p",{className:"text-xs text-gray-500",children:e.job_title})]})]})}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(eS(e.role,e.role_level)),children:[e.role," (",e.role_level,")"]})}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsx)("p",{className:"text-sm text-gray-900",children:e.tenant_name})}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"})}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.last_sign_in_at?new Date(e.last_sign_in_at).toLocaleDateString():"Never"})}),ep&&(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(c.$,{size:"sm",variant:"outline",onClick:()=>{eh(e),ec(!0)},children:(0,r.jsx)(w.A,{className:"h-3 w-3"})}),(0,r.jsx)(c.$,{size:"sm",variant:"outline",onClick:()=>ew(e.id,e.email),children:(0,r.jsx)(g.A,{className:"h-3 w-3"})}),(0,r.jsx)(c.$,{size:"sm",variant:"outline",onClick:()=>eN(e.id),className:"text-red-600 hover:text-red-700",children:(0,r.jsx)(_.A,{className:"h-3 w-3"})})]})})]},e.id))})]})})})]})]}),"roles"===es&&(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(i.Zp,{children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsx)(i.ZB,{children:"Role-Based Access Control (RBAC)"}),(0,r.jsx)(i.BT,{children:"Manage user roles and permissions with tenant scoping"})]}),(0,r.jsxs)(i.Wu,{children:[(0,r.jsx)("div",{className:"space-y-4",children:M.map((e,s)=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(x.A,{className:"h-4 w-4 mr-2 ".concat("host"===e.role_level?"text-red-600":"primary_client"===e.role_level?"text-orange-600":"sub_client"===e.role_level?"text-blue-600":"text-green-600")}),(0,r.jsx)("span",{className:"text-sm font-medium",children:e.role})]}),ep&&(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)(c.$,{size:"sm",variant:"outline",children:(0,r.jsx)(w.A,{className:"h-3 w-3"})}),(0,r.jsx)(c.$,{size:"sm",variant:"outline",children:(0,r.jsx)(_.A,{className:"h-3 w-3"})})]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[e.count," users assigned"]}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("host"===e.role_level?"bg-red-50 text-red-700 border border-red-200":"primary_client"===e.role_level?"bg-orange-50 text-orange-700 border border-orange-200":"sub_client"===e.role_level?"bg-blue-50 text-blue-700 border border-blue-200":"bg-green-50 text-green-700 border border-green-200"),children:"host"===e.role_level?"System-wide":"primary_client"===e.role_level?"Tenant-scoped":"sub_client"===e.role_level?"Sub-client":"Limited"})]})]},s))}),ep&&(0,r.jsx)("div",{className:"mt-4 pt-4 border-t",children:(0,r.jsx)(c.$,{size:"sm",variant:"outline",className:"w-full",children:"Create Custom Role"})})]})]}),(0,r.jsxs)(i.Zp,{children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsx)(i.ZB,{children:"Permission Matrix"}),(0,r.jsx)(i.BT,{children:"Overview of permissions by role level"})]}),(0,r.jsx)(i.Wu,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-xs font-medium text-gray-600 border-b pb-2",children:[(0,r.jsx)("div",{children:"Permission"}),(0,r.jsx)("div",{children:"Host"}),(0,r.jsx)("div",{children:"Primary"}),(0,r.jsx)("div",{children:"Sub"})]}),[{name:"User Management",host:!0,primary:!0,sub:!1},{name:"System Settings",host:!0,primary:!1,sub:!1},{name:"Tenant Management",host:!0,primary:!0,sub:!1},{name:"Project Management",host:!0,primary:!0,sub:!0},{name:"Reporting",host:!0,primary:!0,sub:!0},{name:"Data Export",host:!0,primary:!0,sub:!1}].map((e,s)=>(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-xs py-2 border-b",children:[(0,r.jsx)("div",{className:"font-medium",children:e.name}),(0,r.jsx)("div",{className:"text-center",children:e.host?(0,r.jsx)(m.A,{className:"h-4 w-4 text-green-500 mx-auto"}):(0,r.jsx)(o.A,{className:"h-4 w-4 text-red-500 mx-auto"})}),(0,r.jsx)("div",{className:"text-center",children:e.primary?(0,r.jsx)(m.A,{className:"h-4 w-4 text-green-500 mx-auto"}):(0,r.jsx)(o.A,{className:"h-4 w-4 text-red-500 mx-auto"})}),(0,r.jsx)("div",{className:"text-center",children:e.sub?(0,r.jsx)(m.A,{className:"h-4 w-4 text-green-500 mx-auto"}):(0,r.jsx)(o.A,{className:"h-4 w-4 text-red-500 mx-auto"})})]},s))]})})]})]}),"sso"===es&&(0,r.jsxs)(i.Zp,{children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsx)(i.ZB,{children:"Single Sign-On (SSO)"}),(0,r.jsx)(i.BT,{children:"Configure SSO providers and authentication settings"})]}),(0,r.jsxs)(i.Wu,{children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"border border-green-200 rounded-lg p-3 bg-green-50",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 text-green-600 mr-2"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"Microsoft Azure AD"})]}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 border border-green-200",children:"Active"})]}),(0,r.jsx)("p",{className:"text-xs text-green-700 mb-2",children:"Primary SSO provider for corporate users"}),(0,r.jsxs)("div",{className:"text-xs text-green-600",children:["Last sync: ",new Date().toLocaleDateString()," | ",I.filter(e=>e.email.includes("@")).length," users authenticated"]})]}),(0,r.jsxs)("div",{className:"border border-blue-200 rounded-lg p-3 bg-blue-50",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 text-blue-600 mr-2"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"Google Workspace"})]}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 border border-blue-200",children:"Active"})]}),(0,r.jsx)("p",{className:"text-xs text-blue-700 mb-2",children:"Secondary provider for external consultants"}),(0,r.jsxs)("div",{className:"text-xs text-blue-600",children:["Last sync: ",new Date().toLocaleDateString()," | ",Math.floor(.2*I.length)," users authenticated"]})]}),(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(A.A,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"SAML 2.0 Provider"})]}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 border border-gray-200",children:"Configured"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:"Ready for enterprise SAML integration"}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"Status: Ready | No active connections"})]})]}),ep&&(0,r.jsx)("div",{className:"mt-4 pt-4 border-t",children:(0,r.jsx)(c.$,{size:"sm",variant:"outline",className:"w-full",children:"Configure SSO Provider"})})]})]}),"invites"===es&&ep&&(0,r.jsxs)(i.Zp,{children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsx)(i.ZB,{children:"Pending Invitations"}),(0,r.jsx)(i.BT,{children:"Manage user invitations and track their status"})]}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Email"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Role"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Tenant"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Invited By"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Status"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Expires"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:O.map(e=>(0,r.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"py-3 px-4 font-medium",children:e.email}),(0,r.jsx)("td",{className:"py-3 px-4",children:e.role}),(0,r.jsx)("td",{className:"py-3 px-4",children:e.tenant_name}),(0,r.jsx)("td",{className:"py-3 px-4",children:e.invited_by}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("pending"===e.status?"bg-yellow-100 text-yellow-800":"accepted"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.status})}),(0,r.jsx)("td",{className:"py-3 px-4",children:new Date(e.expires_at).toLocaleDateString()}),(0,r.jsx)("td",{className:"py-3 px-4",children:"pending"===e.status&&(0,r.jsxs)(c.$,{size:"sm",variant:"outline",onClick:()=>e_(e.id),children:[(0,r.jsx)(C.A,{className:"h-3 w-3 mr-1"}),"Resend"]})})]},e.id))})]})})})]}),"cleanup"===es&&ep&&(0,r.jsxs)(i.Zp,{children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsx)(i.ZB,{children:"System Cleanup & Maintenance"}),(0,r.jsx)(i.BT,{children:"Advanced user management and cleanup operations"})]}),(0,r.jsx)(i.Wu,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)(c.$,{onClick:()=>ex(!0),variant:"outline",className:"w-full justify-start",children:[(0,r.jsx)(_.A,{className:"h-4 w-4 mr-2"}),"Bulk User Cleanup"]}),(0,r.jsxs)(c.$,{onClick:eg,variant:"outline",className:"w-full justify-start",children:[(0,r.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Refresh All Data"]}),(0,r.jsxs)(c.$,{onClick:eA,variant:"outline",className:"w-full justify-start",children:[(0,r.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Export User Data"]})]})})]})]}),ep&&(0,r.jsxs)(r.Fragment,{children:[er&&(0,r.jsx)(E,{isOpen:er,onClose:()=>el(!1),onSuccess:eb,tenants:B}),ea&&(0,r.jsx)(T,{isOpen:ea,onClose:()=>en(!1),onSuccess:ef,tenants:B}),ei&&eu&&(0,r.jsx)(L,{isOpen:ei,onClose:()=>{ec(!1),eh(null)},onSuccess:eb,user:eu,tenants:B}),ed&&eu&&(0,r.jsx)($,{isOpen:ed,onClose:()=>{eo(!1),eh(null)},onSuccess:()=>{eb(),eo(!1),eh(null)},user:eu}),em&&(0,r.jsx)(Z,{isOpen:em,onClose:()=>ex(!1),onSuccess:eb})]})]}):(0,r.jsx)(n.A,{children:(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsx)(i.Zp,{className:"w-96",children:(0,r.jsxs)(i.Wu,{className:"p-6 text-center",children:[(0,r.jsx)(o.A,{className:"h-12 w-12 text-red-400 mx-auto mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Access Denied"}),(0,r.jsx)("p",{className:"text-gray-600",children:"You don't have permission to access user management."}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Contact your administrator for access."})]})})})}):(0,r.jsx)(n.A,{children:(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsx)(i.Zp,{className:"w-96",children:(0,r.jsxs)(i.Wu,{className:"p-6 text-center",children:[(0,r.jsx)(x.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Authentication Required"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Please log in to access user management."})]})})})})}},3741:(e,s,t)=>{"use strict";t.d(s,{$:()=>n});var r=t(5155),l=t(2115),a=t(9434);let n=l.forwardRef((e,s)=>{let{className:t,variant:l="default",size:n="default",...i}=e;return(0,r.jsx)("button",{className:(0,a.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-blue-600 text-white hover:bg-blue-700":"default"===l,"bg-red-600 text-white hover:bg-red-700":"destructive"===l,"border border-gray-300 bg-white hover:bg-gray-50":"outline"===l,"bg-gray-100 text-gray-900 hover:bg-gray-200":"secondary"===l,"hover:bg-gray-100":"ghost"===l,"text-blue-600 underline-offset-4 hover:underline":"link"===l},{"h-10 px-4 py-2":"default"===n,"h-9 rounded-md px-3":"sm"===n,"h-11 rounded-md px-8":"lg"===n,"h-10 w-10":"icon"===n},t),ref:s,...i})});n.displayName="Button"},8877:(e,s,t)=>{Promise.resolve().then(t.bind(t,2050))}},e=>{var s=s=>e(e.s=s);e.O(0,[7590,2354,1761,2099,4660,4619,8441,1684,7358],()=>s(8877)),_N_E=e.O()}]);