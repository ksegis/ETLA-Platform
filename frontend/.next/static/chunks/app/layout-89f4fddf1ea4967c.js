(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{347:()=>{},6651:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,347,23)),Promise.resolve().then(n.bind(n,7020)),Promise.resolve().then(n.bind(n,7737))},7737:(e,t,n)=>{"use strict";n.d(t,{K:()=>d,O:()=>u,TenantProvider:()=>s});var r=n(5155),i=n(2115),a=n(2099),l=n(7020);let o=(0,i.createContext)(void 0);function s(e){let{children:t}=e,{user:n,tenantUser:s,isAuthenticated:d,isDemoMode:u}=(0,l.As)(),[c,m]=(0,i.useState)(null),[_,f]=(0,i.useState)([]),[v,h]=(0,i.useState)(!0),w=(0,a.createClient)(),p={id:"demo-tenant-id",name:"Demo Company",domain:"demo.company.com",status:"active",subscription_plan:"professional",subscription_start_date:new Date().toISOString(),max_users:100,current_users:5,settings:{},tenant_id:"demo-tenant-id",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},S=async()=>{if(u){f([p]),m(p),h(!1);return}if(!d||!n){f([]),m(null),h(!1);return}try{if((null==s?void 0:s.role)==="host_admin"){let{data:e,error:t}=await w.from("tenants").select("*").order("name");if(t)throw t;f(e||[]);let n=(null==e?void 0:e[0])||null;m(n)}else{let{data:e,error:t}=await w.from("user_tenant_access").select("tenant_id").eq("user_id",n.id).eq("is_active",!0);if(t)throw t;if(e&&e.length>0){let t=e.map(e=>e.tenant_id),{data:n,error:r}=await w.from("tenants").select("*").in("id",t).order("name");if(r)throw r;f(n||[]);let i=(null==n?void 0:n.find(e=>e.id===(null==s?void 0:s.tenant_id)))||(null==n?void 0:n[0])||null;m(i)}else f([]),m(null)}}catch(e){console.error("Error loading tenants:",e),f([]),m(null)}finally{h(!1)}};return(0,i.useEffect)(()=>{S()},[d,n,s,u]),(0,r.jsx)(o.Provider,{value:{selectedTenant:c,setSelectedTenant:m,availableTenants:_,isLoading:v,loadAvailableTenants:S,canSelectTenant:()=>!u&&((null==s?void 0:s.role)==="host_admin"||(null==s?void 0:s.role)==="program_manager"),isDemoMode:u},children:t})}function d(){let e=(0,i.useContext)(o);if(void 0===e)throw Error("useTenant must be used within a TenantProvider");return e}function u(){let{selectedTenant:e,isDemoMode:t}=d();return t?"demo-tenant-id":(null==e?void 0:e.id)||null}}},e=>{var t=t=>e(e.s=t);e.O(0,[7690,2354,4660,2099,8441,1684,7358],()=>t(6651)),_N_E=e.O()}]);