(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2415],{2814:(e,t,s)=>{"use strict";s.d(t,{E:()=>a});var r=s(5155),l=s(2115),i=s(9434);let a=l.forwardRef((e,t)=>{let{className:s,variant:l="default",...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",{"border-transparent bg-blue-600 text-white hover:bg-blue-700":"default"===l,"border-transparent bg-gray-100 text-gray-900 hover:bg-gray-200":"secondary"===l,"border-transparent bg-red-600 text-white hover:bg-red-700":"destructive"===l,"text-gray-950 border-gray-200 bg-white hover:bg-gray-50":"outline"===l},s),...a})});a.displayName="Badge"},3741:(e,t,s)=>{"use strict";s.d(t,{$:()=>a});var r=s(5155),l=s(2115),i=s(9434);let a=l.forwardRef((e,t)=>{let{className:s,variant:l="default",size:a="default",...n}=e;return(0,r.jsx)("button",{className:(0,i.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-blue-600 text-white hover:bg-blue-700":"default"===l,"bg-red-600 text-white hover:bg-red-700":"destructive"===l,"border border-gray-300 bg-white hover:bg-gray-50":"outline"===l,"bg-gray-100 text-gray-900 hover:bg-gray-200":"secondary"===l,"hover:bg-gray-100":"ghost"===l,"text-blue-600 underline-offset-4 hover:underline":"link"===l},{"h-10 px-4 py-2":"default"===a,"h-9 rounded-md px-3":"sm"===a,"h-11 rounded-md px-8":"lg"===a,"h-10 w-10":"icon"===a},s),ref:t,...n})});a.displayName="Button"},3878:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(7140).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},3915:(e,t,s)=>{"use strict";s.d(t,{p:()=>a});var r=s(5155),l=s(2115),i=s(9434);let a=l.forwardRef((e,t)=>{let{className:s,type:l,...a}=e;return(0,r.jsx)("input",{type:l,className:(0,i.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});a.displayName="Input"},5851:(e,t,s)=>{Promise.resolve().then(s.bind(s,7517))},7517:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>C});var r=s(5155),l=s(2115),i=s(1073),a=s(8156),n=s(2550),d=s(3878),o=s(4139),c=s(3715),u=s(7159),x=s(907),m=s(412),h=s(9076),p=s(7808),g=s(6836),f=s(3741),j=s(3915),v=s(7703),b=s(2814),y=s(858),w=s(2099),N=s(7020),_=s(7737);let k={draft:{icon:i.A,color:"text-gray-600",bg:"bg-gray-100",label:"Draft"},submitted:{icon:i.A,color:"text-blue-600",bg:"bg-blue-100",label:"Submitted"},under_review:{icon:a.A,color:"text-yellow-600",bg:"bg-yellow-100",label:"Under Review"},approved:{icon:n.A,color:"text-green-600",bg:"bg-green-100",label:"Approved"},declined:{icon:d.A,color:"text-red-600",bg:"bg-red-100",label:"Declined"},in_progress:{icon:i.A,color:"text-indigo-600",bg:"bg-indigo-100",label:"In Progress"},completed:{icon:n.A,color:"text-green-600",bg:"bg-green-100",label:"Completed"},cancelled:{icon:d.A,color:"text-gray-600",bg:"bg-gray-100",label:"Cancelled"}},q=e=>{let{isOpen:t,onClose:s,onSave:i,request:a=null,title:n="Create New Work Request"}=e,[d,c]=(0,l.useState)({title:"",description:"",category:"",priority:"medium",status:"submitted",business_justification:"",estimated_budget:"",requested_completion_date:"",impact_assessment:""});return((0,l.useEffect)(()=>{if(a){var e;c({title:a.title||"",description:a.description||"",category:a.category||"",priority:a.priority||"medium",status:a.status||"submitted",business_justification:a.business_justification||"",estimated_budget:(null==(e=a.estimated_budget)?void 0:e.toString())||"",requested_completion_date:a.requested_completion_date||"",impact_assessment:a.impact_assessment||""})}else c({title:"",description:"",category:"",priority:"medium",status:"submitted",business_justification:"",estimated_budget:"",requested_completion_date:"",impact_assessment:""})},[a,t]),t)?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-6 border-b",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:n}),(0,r.jsx)(f.$,{variant:"ghost",size:"sm",onClick:s,children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})]}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),i({...d,estimated_budget:d.estimated_budget?parseFloat(d.estimated_budget):void 0})},className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),(0,r.jsx)(j.p,{value:d.title,onChange:e=>c(t=>({...t,title:e.target.value})),placeholder:"Enter work request title",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,r.jsxs)("select",{value:d.category,onChange:e=>c(t=>({...t,category:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Select Category"}),(0,r.jsx)("option",{value:"development",children:"Development"}),(0,r.jsx)("option",{value:"infrastructure",children:"Infrastructure"}),(0,r.jsx)("option",{value:"security",children:"Security"}),(0,r.jsx)("option",{value:"maintenance",children:"Maintenance"}),(0,r.jsx)("option",{value:"enhancement",children:"Enhancement"}),(0,r.jsx)("option",{value:"support",children:"Support"}),(0,r.jsx)("option",{value:"other",children:"Other"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority *"}),(0,r.jsxs)("select",{value:d.priority,onChange:e=>c(t=>({...t,priority:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,r.jsx)("option",{value:"low",children:"Low"}),(0,r.jsx)("option",{value:"medium",children:"Medium"}),(0,r.jsx)("option",{value:"high",children:"High"}),(0,r.jsx)("option",{value:"critical",children:"Critical"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,r.jsxs)("select",{value:d.status,onChange:e=>c(t=>({...t,status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"draft",children:"Draft"}),(0,r.jsx)("option",{value:"submitted",children:"Submitted"}),(0,r.jsx)("option",{value:"under_review",children:"Under Review"}),(0,r.jsx)("option",{value:"approved",children:"Approved"}),(0,r.jsx)("option",{value:"declined",children:"Declined"}),(0,r.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,r.jsx)("option",{value:"completed",children:"Completed"}),(0,r.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Budget"}),(0,r.jsx)(j.p,{type:"number",value:d.estimated_budget,onChange:e=>c(t=>({...t,estimated_budget:e.target.value})),placeholder:"0.00",min:"0",step:"0.01"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Requested Completion Date"}),(0,r.jsx)(j.p,{type:"date",value:d.requested_completion_date,onChange:e=>c(t=>({...t,requested_completion_date:e.target.value}))})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,r.jsx)("textarea",{value:d.description,onChange:e=>c(t=>({...t,description:e.target.value})),placeholder:"Describe the work request in detail",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Justification"}),(0,r.jsx)("textarea",{value:d.business_justification,onChange:e=>c(t=>({...t,business_justification:e.target.value})),placeholder:"Explain the business need and expected benefits",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Impact Assessment"}),(0,r.jsx)("textarea",{value:d.impact_assessment,onChange:e=>c(t=>({...t,impact_assessment:e.target.value})),placeholder:"Describe the potential impact if this request is not fulfilled",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,r.jsx)(f.$,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),(0,r.jsx)(f.$,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:a?"Update Request":"Create Request"})]})]})]})}):null};function C(){let[e,t]=(0,l.useState)([]),[s,o]=(0,l.useState)([]),[C,S]=(0,l.useState)(!0),[A,D]=(0,l.useState)(null),[E,R]=(0,l.useState)(""),[P,$]=(0,l.useState)(""),[L,W]=(0,l.useState)(""),[I,z]=(0,l.useState)("list"),[O,Z]=(0,l.useState)(!1),[B,F]=(0,l.useState)(!1),[T,U]=(0,l.useState)(null),[M,H]=(0,l.useState)({total:0,submitted:0,under_review:0,approved:0,in_progress:0,completed:0}),{user:K}=(0,N.h)(),{selectedTenant:G}=(0,_.K)(),J=async()=>{if(!(null==G?void 0:G.id)){console.log("No tenant selected, skipping load"),S(!1);return}try{S(!0),D(null),console.log("Loading work requests for tenant:",G.id,G.name);let{data:e,error:s}=await w.ND.from("work_requests").select("*").eq("tenant_id",G.id).order("created_at",{ascending:!1});if(s){console.error("Database query error:",s),D("Failed to load work requests: ".concat(s.message||"Unknown error")),t([]),o([]);return}console.log("Loaded work requests:",e),t(e||[]),o(e||[]);let r={total:(null==e?void 0:e.length)||0,submitted:(null==e?void 0:e.filter(e=>"submitted"===e.status).length)||0,under_review:(null==e?void 0:e.filter(e=>"under_review"===e.status).length)||0,approved:(null==e?void 0:e.filter(e=>"approved"===e.status).length)||0,in_progress:(null==e?void 0:e.filter(e=>"in_progress"===e.status).length)||0,completed:(null==e?void 0:e.filter(e=>"completed"===e.status).length)||0};H(r)}catch(e){console.error("Error loading work requests:",e),D("Failed to load work requests"),t([]),o([])}finally{S(!1)}},X=async e=>{if(!(null==G?void 0:G.id)||!(null==K?void 0:K.id))return void D("Missing tenant or user information");try{let s={...e,tenant_id:G.id,customer_id:G.id,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("Creating work request:",s);let{data:r,error:l}=await w.ND.from("work_requests").insert([s]).select().single();if(l){console.error("Error creating work request:",l),D("Failed to create work request: ".concat(l.message));return}console.log("Created work request:",r),t(e=>[r,...e]),Z(!1),J(),D(null)}catch(e){console.error("Error creating work request:",e),D("Failed to create work request. Please try again.")}},Q=async(e,s)=>{try{let{data:r,error:l}=await w.ND.from("work_requests").update({...s,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(l){console.error("Error updating work request:",l),D("Failed to update work request: ".concat(l.message));return}t(t=>t.map(t=>t.id===e?r:t)),F(!1),U(null),J(),D(null)}catch(e){console.error("Error updating work request:",e),D("Failed to update work request. Please try again.")}},V=async e=>{if(confirm("Are you sure you want to delete this work request?"))try{let{error:s}=await w.ND.from("work_requests").delete().eq("id",e);if(s){console.error("Error deleting work request:",s),D("Failed to delete work request: ".concat(s.message));return}t(t=>t.filter(t=>t.id!==e)),J(),D(null)}catch(e){console.error("Error deleting work request:",e),D("Failed to delete work request. Please try again.")}};(0,l.useEffect)(()=>{let t=e;E&&(t=t.filter(e=>{var t,s,r;return(null==(t=e.title)?void 0:t.toLowerCase().includes(E.toLowerCase()))||(null==(s=e.description)?void 0:s.toLowerCase().includes(E.toLowerCase()))||(null==(r=e.business_justification)?void 0:r.toLowerCase().includes(E.toLowerCase()))})),P&&(t=t.filter(e=>e.status===P)),L&&(t=t.filter(e=>e.priority===L)),o(t)},[e,E,P,L]),(0,l.useEffect)(()=>{J()},[null==G?void 0:G.id]);let Y=e=>new Date(e).toLocaleDateString(),ee=e=>{var t;return e.title||"Request ".concat(null==(t=e.id)?void 0:t.slice(0,8))};return G?(0,r.jsx)(y.A,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[A&&(0,r.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(d.A,{className:"h-5 w-5 text-red-400"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("p",{className:"text-sm text-red-700",children:A}),(0,r.jsx)("button",{onClick:()=>D(null),className:"text-red-700 underline text-sm mt-1",children:"Dismiss"})]})]})}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Work Requests"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Manage and track your work requests"})]}),(0,r.jsxs)(f.$,{onClick:()=>Z(!0),className:"bg-blue-600 hover:bg-blue-700",children:[(0,r.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"New Request"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[(0,r.jsx)(v.Zp,{children:(0,r.jsx)(v.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.total})]}),(0,r.jsx)(i.A,{className:"h-8 w-8 text-gray-400"})]})})}),(0,r.jsx)(v.Zp,{children:(0,r.jsx)(v.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Submitted"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:M.submitted})]}),(0,r.jsx)(i.A,{className:"h-8 w-8 text-blue-500"})]})})}),(0,r.jsx)(v.Zp,{children:(0,r.jsx)(v.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-yellow-600",children:"Under Review"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:M.under_review})]}),(0,r.jsx)(a.A,{className:"h-8 w-8 text-yellow-500"})]})})}),(0,r.jsx)(v.Zp,{children:(0,r.jsx)(v.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Approved"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-900",children:M.approved})]}),(0,r.jsx)(n.A,{className:"h-8 w-8 text-green-500"})]})})}),(0,r.jsx)(v.Zp,{children:(0,r.jsx)(v.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-indigo-600",children:"In Progress"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-indigo-900",children:M.in_progress})]}),(0,r.jsx)(i.A,{className:"h-8 w-8 text-indigo-500"})]})})}),(0,r.jsx)(v.Zp,{children:(0,r.jsx)(v.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Completed"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-900",children:M.completed})]}),(0,r.jsx)(n.A,{className:"h-8 w-8 text-green-500"})]})})})]}),(0,r.jsx)(v.Zp,{children:(0,r.jsx)(v.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,r.jsx)(j.p,{placeholder:"Search requests...",value:E,onChange:e=>R(e.target.value),className:"pl-10"})]})}),(0,r.jsxs)("select",{value:P,onChange:e=>$(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"All Status"}),(0,r.jsx)("option",{value:"submitted",children:"Submitted"}),(0,r.jsx)("option",{value:"under_review",children:"Under Review"}),(0,r.jsx)("option",{value:"approved",children:"Approved"}),(0,r.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,r.jsx)("option",{value:"completed",children:"Completed"})]}),(0,r.jsxs)("select",{value:L,onChange:e=>W(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"All Priority"}),(0,r.jsx)("option",{value:"low",children:"Low"}),(0,r.jsx)("option",{value:"medium",children:"Medium"}),(0,r.jsx)("option",{value:"high",children:"High"}),(0,r.jsx)("option",{value:"critical",children:"Critical"})]}),(0,r.jsxs)("div",{className:"flex border border-gray-300 rounded-md",children:[(0,r.jsx)(f.$,{variant:"list"===I?"default":"ghost",size:"sm",onClick:()=>z("list"),className:"rounded-r-none",children:(0,r.jsx)(x.A,{className:"h-4 w-4"})}),(0,r.jsx)(f.$,{variant:"grid"===I?"default":"ghost",size:"sm",onClick:()=>z("grid"),className:"rounded-l-none",children:(0,r.jsx)(m.A,{className:"h-4 w-4"})})]})]})})}),(0,r.jsxs)(v.Zp,{children:[(0,r.jsxs)(v.aR,{children:[(0,r.jsxs)(v.ZB,{children:["Work Requests (",s.length,")"]}),(0,r.jsxs)(v.BT,{children:[s.length," of ",e.length," requests",G&&(0,r.jsxs)("span",{className:"ml-2",children:["| Tenant: ",G.name]})]})]}),(0,r.jsx)(v.Wu,{children:C?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Loading work requests..."})]}):0===s.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No work requests found"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:0===e.length?"Get started by creating your first work request.":"Try adjusting your search or filter criteria."}),0===e.length&&(0,r.jsxs)(f.$,{onClick:()=>Z(!0),children:[(0,r.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Create First Request"]})]}):"list"===I?(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Request"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Budget"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>{var t,s;let l=(null==(t=k[e.status])?void 0:t.icon)||i.A,a=k[e.status]||k.submitted;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:ee(e)}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[null==(s=e.description)?void 0:s.slice(0,100),"..."]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)(b.E,{variant:"approved"===e.status?"default":"secondary",children:[(0,r.jsx)(l,{className:"w-3 h-3 mr-1"}),a.label]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)(b.E,{variant:"high"===e.priority||"critical"===e.priority?"destructive":"secondary",children:e.priority||"medium"})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",(e.estimated_budget||0).toLocaleString()]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y(e.created_at)}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(f.$,{variant:"ghost",size:"sm",children:(0,r.jsx)(h.A,{className:"h-4 w-4"})}),(0,r.jsx)(f.$,{variant:"ghost",size:"sm",onClick:()=>{U(e),F(!0)},children:(0,r.jsx)(p.A,{className:"h-4 w-4"})}),(0,r.jsx)(f.$,{variant:"ghost",size:"sm",onClick:()=>V(e.id),children:(0,r.jsx)(g.A,{className:"h-4 w-4"})})]})})]},e.id)})})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>{var t,s;let l=(null==(t=k[e.status])?void 0:t.icon)||i.A,a=k[e.status]||k.submitted;return(0,r.jsxs)(v.Zp,{className:"hover:shadow-lg transition-shadow",children:[(0,r.jsx)(v.aR,{children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(v.ZB,{className:"text-lg",children:ee(e)}),(0,r.jsxs)(v.BT,{children:[null==(s=e.description)?void 0:s.slice(0,100),"..."]})]}),(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)(f.$,{variant:"ghost",size:"sm",children:(0,r.jsx)(h.A,{className:"h-4 w-4"})}),(0,r.jsx)(f.$,{variant:"ghost",size:"sm",onClick:()=>{U(e),F(!0)},children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})]})]})}),(0,r.jsx)(v.Wu,{children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Status:"}),(0,r.jsxs)(b.E,{variant:"approved"===e.status?"default":"secondary",children:[(0,r.jsx)(l,{className:"w-3 h-3 mr-1"}),a.label]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Priority:"}),(0,r.jsx)(b.E,{variant:"high"===e.priority||"critical"===e.priority?"destructive":"secondary",children:e.priority||"medium"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Budget:"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:["$",(e.estimated_budget||0).toLocaleString()]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Created:"}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:Y(e.created_at)})]})]})})]},e.id)})})})]}),(0,r.jsx)(q,{isOpen:O,onClose:()=>Z(!1),onSave:X,title:"Create New Work Request"}),(0,r.jsx)(q,{isOpen:B,onClose:()=>{F(!1),U(null)},onSave:e=>T&&Q(T.id,e),request:T,title:"Edit Work Request"})]})}):(0,r.jsx)(y.A,{children:(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("p",{className:"text-gray-600",children:"Please select a tenant to view work requests."})})})}},7737:(e,t,s)=>{"use strict";s.d(t,{K:()=>o,TenantProvider:()=>d});var r=s(5155),l=s(2115),i=s(2099),a=s(7020);let n=(0,l.createContext)(void 0);function d(e){let{children:t}=e,{user:s,tenantUser:d,isAuthenticated:o,isDemoMode:c}=(0,a.h)(),[u,x]=(0,l.useState)(null),[m,h]=(0,l.useState)([]),[p,g]=(0,l.useState)(!0),f={id:"demo-tenant-id",name:"Demo Company",domain:"demo.company.com",status:"active",subscription_plan:"professional",subscription_start_date:new Date().toISOString(),max_users:100,current_users:5,settings:{},tenant_id:"demo-tenant-id",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},j=async()=>{if(c){h([f]),x(f),g(!1);return}if(!o||!s){h([]),x(null),g(!1);return}try{if((null==d?void 0:d.role)==="host_admin"){let{data:e,error:t}=await i.ND.from("tenants").select("*").order("name");if(t)throw t;h(e||[]);let s=(null==e?void 0:e[0])||null;x(s)}else{let{data:e,error:t}=await i.ND.from("tenant_users").select("tenant_id").eq("user_id",s.id).eq("is_active",!0);if(t)throw t;if(e&&e.length>0){let t=e.map(e=>e.tenant_id),{data:s,error:r}=await i.ND.from("tenants").select("*").in("id",t).order("name");if(r)throw r;h(s||[]);let l=(null==s?void 0:s.find(e=>e.id===(null==d?void 0:d.tenant_id)))||(null==s?void 0:s[0])||null;x(l)}else h([]),x(null)}}catch(e){console.error("Error loading tenants:",e),h([]),x(null)}finally{g(!1)}};return(0,l.useEffect)(()=>{j()},[o,s,d,c]),(0,r.jsx)(n.Provider,{value:{selectedTenant:u,setSelectedTenant:x,availableTenants:m,isLoading:p,loadAvailableTenants:j,canSelectTenant:()=>!c&&((null==d?void 0:d.role)==="host_admin"||(null==d?void 0:d.role)==="program_manager"),isDemoMode:c},children:t})}function o(){let e=(0,l.useContext)(n);if(void 0===e)throw Error("useTenant must be used within a TenantProvider");return e}},8156:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(7140).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[7590,2354,305,2099,4660,4619,8441,1684,7358],()=>t(5851)),_N_E=e.O()}]);