(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3159],{477:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},936:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},1073:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},1106:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>D});var r=t(5155),a=t(2115),n=t(5695),l=t(1073),i=t(8156),c=t(2550),o=t(3878),d=t(9169),m=t(7235),u=t(1644),x=t(7808),h=t(936),g=t(477),p=t(6358);let y=(0,t(7140).A)("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);var j=t(2539),f=t(7691),N=t(7141),w=t(6191),v=t(9489),b=t(3741),k=t(7703),A=t(2099);class _{getCurrentUserId(){if(this.currentUserId)return this.currentUserId;try{let e=localStorage.getItem("etla-auth-context");if(e)return JSON.parse(e).userId}catch(e){console.warn("Failed to get user ID from auth context:",e)}return null}async initialize(e,s){e&&s?(this.currentUserId=e,this.currentTenantId=s,this.isInitialized=!0,console.log("✅ PMBOK Service: Initialized with user context:",{userId:e,tenantId:s})):console.log("⚠️ PMBOK Service: Using demo context - no user/tenant provided")}updateUserContext(e,s){(this.currentUserId!==e||this.currentTenantId!==s)&&(console.log("\uD83D\uDD04 PMBOK Service: Updating user context:",{from:{userId:this.currentUserId,tenantId:this.currentTenantId},to:{userId:e,tenantId:s}}),this.currentUserId=e,this.currentTenantId=s,this.isInitialized=!0)}async handleMissingCustomers(e){let s=Array.from(new Set(e.map(e=>e.customer_id).filter(Boolean)));if(0===s.length)return console.log("⚠️ No customer IDs found in work requests"),e.map(e=>({...e,customer_name:"Unknown Customer"}));try{console.log("\uD83D\uDC65 Fetching customer information for IDs:",s);let{data:t,error:r}=await this.supabase.from("profiles").select("id, name, email").in("id",s);if(r)return console.error("❌ Error fetching customer profiles:",r),e.map(e=>({...e,customer_name:"Unknown Customer"}));console.log("✅ Profile query succeeded, found:",(null==t?void 0:t.length)||0,"profiles");let a=new Map;return null==t||t.forEach(e=>{a.set(e.id,e.name||e.email||"Unknown Customer")}),e.map(e=>({...e,customer_name:a.get(e.customer_id)||"Missing Customer"}))}catch(s){return console.error("❌ Exception during customer lookup:",s),e.map(e=>({...e,customer_name:"Unknown Customer"}))}}async getWorkRequests(){try{console.log("\uD83D\uDD0D Loading work requests from database...");let e=this.getCurrentUserId();console.log("\uD83C\uDFE2 Current context:",{userId:e,tenantId:this.currentTenantId,initialized:this.isInitialized});let{data:s,error:t}=await this.supabase.from("work_requests").select("*").eq("tenant_id",this.currentTenantId).order("created_at",{ascending:!1});if(t)throw console.error("❌ Error fetching work requests:",t),t;if(console.log("✅ Work requests query succeeded, found:",(null==s?void 0:s.length)||0,"records"),s&&s.length>0){console.log("\uD83D\uDCCB Sample work request:",s[0]);let e=await this.handleMissingCustomers(s);return console.log("✅ Data transformation completed, returning",e.length,"records"),e}return[]}catch(e){return console.error("❌ Error in getWorkRequests:",e),[]}}async getProjects(){try{console.log("\uD83D\uDCCA Loading projects from database...");let{data:e,error:s}=await this.supabase.from("project_charters").select("*").eq("tenant_id",this.currentTenantId).order("created_at",{ascending:!1});if(s)throw console.error("❌ Error fetching projects:",s),s;return console.log("✅ Projects query succeeded, found:",(null==e?void 0:e.length)||0,"records"),e||[]}catch(e){return console.error("❌ Error in getProjects:",e),[]}}async getRisks(){try{console.log("⚠️ Loading risks from database...");let{data:e,error:s}=await this.supabase.from("risks").select("*").eq("tenant_id",this.currentTenantId).order("created_at",{ascending:!1});if(s)throw console.error("❌ Error fetching risks:",s),s;return console.log("✅ Risks query succeeded, found:",(null==e?void 0:e.length)||0,"records"),e||[]}catch(e){return console.error("❌ Error in getRisks:",e),[]}}async approveWorkRequest(e,s){try{console.log("✅ Approving work request:",e);let{error:s}=await this.supabase.from("work_requests").update({approval_status:"converted_to_project",approved_by:this.getCurrentUserId(),approved_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e).eq("tenant_id",this.currentTenantId);if(s)return console.error("❌ Error updating work request:",s),{success:!1,error:s.message};return console.log("✅ Work request approved successfully"),{success:!0,projectId:"proj_".concat(Date.now())}}catch(e){return console.error("❌ Error in approveWorkRequest:",e),{success:!1,error:"Failed to approve work request"}}}async declineWorkRequest(e,s){try{console.log("❌ Declining work request:",e,"Reason:",s);let{error:t}=await this.supabase.from("work_requests").update({approval_status:"declined",decline_reason:s,reviewed_by:this.getCurrentUserId(),reviewed_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e).eq("tenant_id",this.currentTenantId);if(t)return console.error("❌ Error declining work request:",t),{success:!1,error:t.message};return console.log("✅ Work request declined successfully"),{success:!0}}catch(e){return console.error("❌ Error in declineWorkRequest:",e),{success:!1,error:"Failed to decline work request"}}}async setWorkRequestUnderReview(e){try{console.log("\uD83D\uDD0D Setting work request under review:",e);let{error:s}=await this.supabase.from("work_requests").update({approval_status:"under_review",reviewed_by:this.getCurrentUserId(),reviewed_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e).eq("tenant_id",this.currentTenantId);if(s)return console.error("❌ Error setting work request under review:",s),{success:!1,error:s.message};return console.log("✅ Work request set under review successfully"),{success:!0}}catch(e){return console.error("❌ Error in setWorkRequestUnderReview:",e),{success:!1,error:"Failed to set work request under review"}}}async createMissingCustomer(e,s){try{console.log("\uD83D\uDC64 Creating missing customer:",{name:e,email:s});let t="cust_".concat(Date.now()),{data:r,error:a}=await this.supabase.from("profiles").insert({id:t,name:e,email:s,tenant_id:this.currentTenantId,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(a)return console.error("❌ Error creating customer:",a),{success:!1,error:a.message};return console.log("✅ Customer created successfully:",t),{success:!0,customerId:t}}catch(e){return console.error("❌ Error in createMissingCustomer:",e),{success:!1,error:"Failed to create customer"}}}async linkWorkRequestToCustomer(e,s){try{console.log("\uD83D\uDD17 Linking work request to customer:",{workRequestId:e,customerId:s});let{error:t}=await this.supabase.from("work_requests").update({customer_id:s,updated_at:new Date().toISOString()}).eq("id",e).eq("tenant_id",this.currentTenantId);if(t)return console.error("❌ Error linking work request to customer:",t),{success:!1,error:t.message};return console.log("✅ Work request linked to customer successfully"),{success:!0}}catch(e){return console.error("❌ Error in linkWorkRequestToCustomer:",e),{success:!1,error:"Failed to link work request to customer"}}}async getAvailableCustomers(){try{let{data:e,error:s}=await this.supabase.from("profiles").select("id, name, email").eq("tenant_id",this.currentTenantId).order("name",{ascending:!0});if(s)return console.error("❌ Error fetching available customers:",s),[];return e||[]}catch(e){return console.error("❌ Error in getAvailableCustomers:",e),[]}}async getWorkRequestStats(){try{let e=await this.getWorkRequests();return{total:e.length,pending:e.filter(e=>"submitted"===e.approval_status||"under_review"===e.approval_status||"submitted"===e.status||"under_review"===e.status).length,approved:e.filter(e=>"approved"===e.approval_status).length,declined:e.filter(e=>"declined"===e.approval_status).length,converted:e.filter(e=>"converted_to_project"===e.approval_status).length}}catch(e){return console.error("❌ Error getting work request stats:",e),{total:0,pending:0,approved:0,declined:0,converted:0}}}constructor(){this.currentUserId=null,this.currentTenantId="54afbd1d-e72a-41e1-9d39-2c8a08a257ff",this.isInitialized=!1,this.supabase=A.ND,console.log("\uD83D\uDD27 PMBOK Service: Created with default demo context")}}let q=new _,I={id:"1",tenant_id:"54afbd1d-e72a-41e1-9d39-2c8a08a257ff",title:"Payroll System Integration",description:"Need to integrate new payroll system with existing HR database. This includes mapping employee data, setting up automated data sync, and ensuring compliance with current reporting requirements. The integration should support bi-directional data flow and include error handling for data validation.",category:"system_integration",priority:"high",urgency:"medium",status:"under_review",customer_id:"customer-1",customer_name:"TechCorp Solutions",customer_email:"contact@techcorp.com",submittedAt:"2024-08-15T10:30:00Z",updatedAt:"2024-08-15T14:45:00Z",created_at:"2024-08-15T10:30:00Z",updated_at:"2024-08-15T14:45:00Z",requested_by:"alice.johnson@techcorp.com",estimated_hours:120,estimated_cost:25e3,required_completion_date:"2024-09-30T00:00:00Z",assignedTo:"John Smith",scheduledStartDate:"2024-08-20T09:00:00Z",scheduledEndDate:"2024-09-15T17:00:00Z",tags:["integration","payroll","hr","database"],attachments:[{id:"1",filename:"payroll_requirements.pdf",size:2048576,uploadedAt:"2024-08-15T10:35:00Z",downloadUrl:"#"},{id:"2",filename:"hr_database_schema.sql",size:512e3,uploadedAt:"2024-08-15T10:40:00Z",downloadUrl:"#"}],comments:[{id:"1",authorName:"Alice Johnson",authorRole:"customer",content:"We need this integration completed by end of September to align with our Q4 payroll processing. Please prioritize data accuracy and security.",createdAt:"2024-08-15T11:00:00Z",isInternal:!1},{id:"2",authorName:"John Smith",authorRole:"project_manager",content:"Initial assessment completed. The scope looks manageable within the timeline. Will need access to the HR database schema and test environment.",createdAt:"2024-08-15T13:15:00Z",isInternal:!0},{id:"3",authorName:"Sarah Johnson",authorRole:"program_manager",content:"Initial analysis complete. The integration is more complex than initially estimated due to custom fields in the HR system.",createdAt:"2024-08-14T14:30:00Z",isInternal:!1}]},S={submitted:{color:"bg-blue-100 text-blue-800",icon:l.A},under_review:{color:"bg-yellow-100 text-yellow-800",icon:i.A},approved:{color:"bg-green-100 text-green-800",icon:c.A},declined:{color:"bg-red-100 text-red-800",icon:o.A},converted_to_project:{color:"bg-green-100 text-green-800",icon:c.A},rejected:{color:"bg-red-100 text-red-800",icon:o.A},scheduled:{color:"bg-purple-100 text-purple-800",icon:d.A},in_progress:{color:"bg-indigo-100 text-indigo-800",icon:i.A},completed:{color:"bg-green-100 text-green-800",icon:c.A},cancelled:{color:"bg-gray-100 text-gray-800",icon:o.A}},R={low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",urgent:"bg-red-100 text-red-800",critical:"bg-red-100 text-red-800"},C={customer:"bg-blue-100 text-blue-800",project_manager:"bg-green-100 text-green-800",developer:"bg-purple-100 text-purple-800",admin:"bg-red-100 text-red-800",program_manager:"bg-orange-100 text-orange-800"},T=e=>R[e]||R.medium;function D(e){let{params:s}=e,t=(0,n.useRouter)(),[i,A]=(0,a.useState)(null),[_,R]=(0,a.useState)(!0),[D,M]=(0,a.useState)(null),[E,U]=(0,a.useState)(""),[W,Z]=(0,a.useState)(!1),[B,P]=(0,a.useState)(!0),[z,F]=(0,a.useState)("");(0,a.useEffect)(()=>{(async()=>{F((await s).id)})()},[s]),(0,a.useEffect)(()=>{z&&O()},[z]);let O=async()=>{try{if(R(!0),M(null),console.log("\uD83D\uDD0D Loading work request:",z),B)try{let e=(await q.getWorkRequests()).find(e=>e.id===z);if(e){let s={...I,...e,tags:I.tags,attachments:I.attachments,comments:I.comments,submittedAt:e.created_at,updatedAt:e.updated_at,assignedTo:I.assignedTo,scheduledStartDate:I.scheduledStartDate,scheduledEndDate:I.scheduledEndDate};A(s),console.log("✅ Real work request loaded and enhanced:",s);return}}catch(e){console.warn("⚠️ Failed to load real data, falling back to mock:",e)}"1"!==z&&B?(M("Work request not found"),console.error("❌ Work request not found:",z)):(A(I),console.log("✅ Mock work request loaded:",I))}catch(e){console.error("❌ Error loading work request:",e),M("Failed to load work request")}finally{R(!1)}},L=async()=>{if(E.trim()){Z(!0);try{let e={id:Date.now().toString(),authorName:"Current User",authorRole:"project_manager",content:E,createdAt:new Date().toISOString(),isInternal:!1};A(s=>s?{...s,comments:[...s.comments,e]}:null),U(""),console.log("✅ Comment added successfully")}catch(e){console.error("❌ Error adding comment:",e),alert("Failed to add comment. Please try again.")}finally{Z(!1)}}},$=e=>e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),H=e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]},J=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),K=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),Q=e=>new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return _?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(m.A,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading work request..."})]})}):D||!i?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(o.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Work Request Not Found"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:D||"The requested work request could not be found."}),(0,r.jsxs)(b.$,{onClick:()=>t.push("/project-management"),className:"mr-4",children:[(0,r.jsx)(u.A,{className:"w-4 h-4 mr-2"}),"Back to Project Management"]}),(0,r.jsx)(b.$,{onClick:()=>t.push("/work-requests"),variant:"outline",children:"View All Work Requests"})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)(b.$,{variant:"outline",onClick:()=>t.push("/project-management"),className:"flex items-center",children:[(0,r.jsx)(u.A,{className:"w-4 h-4 mr-2"}),"Back to Project Management"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:i.title}),(0,r.jsxs)("p",{className:"text-gray-600 mt-1",children:["Work Request #",i.id.substring(0,8)]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(e=>{let s=e.approval_status||e.status,t=S[s]||S.submitted,a=t.icon;return(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(t.color),children:[(0,r.jsx)(a,{className:"w-3 h-3 mr-1"}),$(s)]})})(i),(0,r.jsxs)(b.$,{variant:"outline",className:"flex items-center",children:[(0,r.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Edit Request"]})]})]})}),i.customer_missing&&(0,r.jsx)(k.Zp,{className:"mb-6 border-orange-200 bg-orange-50",children:(0,r.jsx)(k.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(h.A,{className:"h-5 w-5 text-orange-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-orange-800",children:"Customer Data Issue"}),(0,r.jsx)("p",{className:"text-sm text-orange-700",children:i.customer_error||"Customer information is missing or incomplete."})]})]})})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.aR,{children:(0,r.jsx)(k.ZB,{children:"Request Details"})}),(0,r.jsxs)(k.Wu,{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Description"}),(0,r.jsx)("p",{className:"text-gray-700 leading-relaxed",children:i.description})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Category"}),(0,r.jsx)("p",{className:"text-gray-700",children:(i.category||"").split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Customer"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(g.A,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,r.jsx)("span",{className:"text-gray-700",children:i.customer_name||"Unknown Customer"}),i.customer_missing&&(0,r.jsx)("span",{className:"ml-2 text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded",children:"Missing Data"})]}),i.customer_email&&(0,r.jsxs)("div",{className:"flex items-center mt-1",children:[(0,r.jsx)(p.A,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:i.customer_email})]})]})]}),i.assignedTo&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Assigned To"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(g.A,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,r.jsx)("span",{className:"text-gray-700",children:i.assignedTo})]})]}),i.decline_reason&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-red-900 mb-2",children:"Decline Reason"}),(0,r.jsx)("p",{className:"text-red-700",children:i.decline_reason})]}),i.tags&&i.tags.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Tags"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:i.tags.map((e,s)=>(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[(0,r.jsx)(y,{className:"w-3 h-3 mr-1"}),e]},s))})]})]})]}),(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.aR,{children:(0,r.jsxs)(k.ZB,{className:"flex items-center",children:[(0,r.jsx)(j.A,{className:"w-5 h-5 mr-2"}),"Project Information"]})}),(0,r.jsx)(k.Wu,{children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Priority"}),(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(T(i.priority)),children:[(0,r.jsx)(h.A,{className:"w-3 h-3 mr-1"}),i.priority.toUpperCase()]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Urgency"}),(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(T(i.urgency||"medium")),children:[(0,r.jsx)(l.A,{className:"w-3 h-3 mr-1"}),(i.urgency||"medium").toUpperCase()]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Estimated Hours"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(l.A,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,r.jsx)("span",{className:"text-gray-700",children:i.estimated_hours||"Not specified"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Estimated Budget"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(f.A,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,r.jsx)("span",{className:"text-gray-700",children:i.estimated_cost?J(i.estimated_cost):"Not specified"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Required Completion"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.A,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,r.jsx)("span",{className:"text-gray-700",children:i.required_completion_date?K(i.required_completion_date):"Not specified"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Requested By"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(g.A,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,r.jsx)("span",{className:"text-gray-700",children:i.requested_by||"Unknown"})]})]})]})})]}),(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.aR,{children:(0,r.jsxs)(k.ZB,{className:"flex items-center",children:[(0,r.jsx)(d.A,{className:"w-5 h-5 mr-2"}),"Timeline"]})}),(0,r.jsx)(k.Wu,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(N.A,{className:"w-4 h-4 text-blue-600"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:"Request Submitted"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:Q(i.submittedAt)})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(l.A,{className:"w-4 h-4 text-yellow-600"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:"Last Updated"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:Q(i.updatedAt)})]})]}),i.scheduledStartDate&&(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(c.A,{className:"w-4 h-4 text-green-600"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:"Scheduled Start"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:Q(i.scheduledStartDate)})]})]}),i.scheduledEndDate&&(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(d.A,{className:"w-4 h-4 text-purple-600"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:"Scheduled End"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:Q(i.scheduledEndDate)})]})]})]})})]}),i.attachments&&i.attachments.length>0&&(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.aR,{children:(0,r.jsxs)(k.ZB,{className:"flex items-center",children:[(0,r.jsx)(w.A,{className:"w-5 h-5 mr-2"}),"Attachments (",i.attachments.length,")"]})}),(0,r.jsx)(k.Wu,{children:(0,r.jsx)("div",{className:"space-y-3",children:i.attachments.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(w.A,{className:"w-5 h-5 text-blue-600"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.filename}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[H(e.size)," • Uploaded ",K(e.uploadedAt)]})]})]}),(0,r.jsx)(b.$,{size:"sm",variant:"outline",children:"Download"})]},e.id))})})]}),(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.aR,{children:(0,r.jsxs)(k.ZB,{className:"flex items-center",children:[(0,r.jsx)(v.A,{className:"w-5 h-5 mr-2"}),"Comments (",i.comments.length,")"]})}),(0,r.jsxs)(k.Wu,{children:[(0,r.jsx)("div",{className:"space-y-6",children:i.comments.map(e=>(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(g.A,{className:"w-4 h-4 text-gray-600"})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,r.jsx)("span",{className:"font-medium text-gray-900",children:e.authorName}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ".concat(C[e.authorRole]),children:$(e.authorRole)}),e.isInternal&&(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Internal"}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:Q(e.createdAt)})]}),(0,r.jsx)("p",{className:"text-gray-700",children:e.content})]})]},e.id))}),(0,r.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("textarea",{value:E,onChange:e=>U(e.target.value),placeholder:"Add a comment...",className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("label",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,r.jsx)("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,r.jsx)("span",{children:"Internal comment (not visible to customer)"})]}),(0,r.jsxs)(b.$,{onClick:L,disabled:!E.trim()||W,className:"flex items-center",children:[W?(0,r.jsx)(m.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,r.jsx)(v.A,{className:"w-4 h-4 mr-2"}),W?"Adding...":"Add Comment"]})]})]})})]})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.aR,{children:(0,r.jsx)(k.ZB,{children:"Quick Actions"})}),(0,r.jsxs)(k.Wu,{className:"space-y-3",children:[(0,r.jsxs)(b.$,{className:"w-full justify-start",variant:"outline",children:[(0,r.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Edit Request"]}),("under_review"===i.status||"under_review"===i.approval_status)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(b.$,{className:"w-full justify-start bg-green-600 hover:bg-green-700 text-white",children:[(0,r.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Approve Request"]}),(0,r.jsxs)(b.$,{className:"w-full justify-start bg-red-600 hover:bg-red-700 text-white",children:[(0,r.jsx)(o.A,{className:"w-4 h-4 mr-2"}),"Decline Request"]})]}),("approved"===i.status||"approved"===i.approval_status)&&(0,r.jsxs)(b.$,{className:"w-full justify-start bg-blue-600 hover:bg-blue-700 text-white",children:[(0,r.jsx)(d.A,{className:"w-4 h-4 mr-2"}),"Schedule Work"]}),(0,r.jsxs)(b.$,{className:"w-full justify-start",variant:"outline",children:[(0,r.jsx)(N.A,{className:"w-4 h-4 mr-2"}),"Generate Report"]})]})]}),(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.aR,{children:(0,r.jsx)(k.ZB,{children:"Request Metrics"})}),(0,r.jsxs)(k.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Estimated Hours"}),(0,r.jsx)("span",{className:"font-medium",children:i.estimated_hours||"N/A"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Estimated Budget"}),(0,r.jsx)("span",{className:"font-medium",children:i.estimated_cost?J(i.estimated_cost):"N/A"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Days Since Submitted"}),(0,r.jsx)("span",{className:"font-medium",children:Math.floor((new Date().getTime()-new Date(i.submittedAt).getTime())/864e5)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Comments"}),(0,r.jsx)("span",{className:"font-medium",children:i.comments.length})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Attachments"}),(0,r.jsx)("span",{className:"font-medium",children:i.attachments.length})]})]})]}),(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.aR,{children:(0,r.jsx)(k.ZB,{children:"Contact Information"})}),(0,r.jsxs)(k.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Customer Contact"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(g.A,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:i.customer_name||"Unknown Customer"})]}),i.customer_email&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(p.A,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:i.customer_email})]})]})]}),i.assignedTo&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Assigned Project Manager"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(g.A,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:i.assignedTo})]})]})]})]}),(0,r.jsxs)(k.Zp,{className:"border-dashed",children:[(0,r.jsx)(k.aR,{children:(0,r.jsx)(k.ZB,{className:"text-sm",children:"Debug Information"})}),(0,r.jsx)(k.Wu,{children:(0,r.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-500",children:"Request ID:"}),(0,r.jsx)("span",{className:"font-mono",children:i.id})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-500",children:"Tenant ID:"}),(0,r.jsx)("span",{className:"font-mono",children:i.tenant_id})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-500",children:"Data Source:"}),(0,r.jsx)("span",{className:B?"text-green-600":"text-orange-600",children:B?"Real Data":"Mock Data"})]}),(0,r.jsxs)(b.$,{onClick:()=>P(!B),size:"sm",variant:"outline",className:"w-full mt-2",children:["Switch to ",B?"Mock":"Real"," Data"]})]})})]})]})]})]})})}},1644:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1715:(e,s,t)=>{Promise.resolve().then(t.bind(t,1106))},2539:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},2550:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]])},3741:(e,s,t)=>{"use strict";t.d(s,{$:()=>l});var r=t(5155),a=t(2115),n=t(9434);let l=a.forwardRef((e,s)=>{let{className:t,variant:a="default",size:l="default",...i}=e;return(0,r.jsx)("button",{className:(0,n.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-blue-600 text-white hover:bg-blue-700":"default"===a,"bg-red-600 text-white hover:bg-red-700":"destructive"===a,"border border-gray-300 bg-white hover:bg-gray-50":"outline"===a,"bg-gray-100 text-gray-900 hover:bg-gray-200":"secondary"===a,"hover:bg-gray-100":"ghost"===a,"text-blue-600 underline-offset-4 hover:underline":"link"===a},{"h-10 px-4 py-2":"default"===l,"h-9 rounded-md px-3":"sm"===l,"h-11 rounded-md px-8":"lg"===l,"h-10 w-10":"icon"===l},t),ref:s,...i})});l.displayName="Button"},3878:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},5695:(e,s,t)=>{"use strict";var r=t(8999);t.o(r,"usePathname")&&t.d(s,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},6191:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]])},6358:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},7141:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},7235:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},7691:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},7703:(e,s,t)=>{"use strict";t.d(s,{BT:()=>o,Wu:()=>d,ZB:()=>c,Zp:()=>l,aR:()=>i});var r=t(5155),a=t(2115),n=t(9434);let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("rounded-lg border border-gray-200 bg-white text-gray-950 shadow-sm",t),...a})});l.displayName="Card";let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...a})});i.displayName="CardHeader";let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("h3",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});c.displayName="CardTitle";let o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("p",{ref:s,className:(0,n.cn)("text-sm text-gray-500",t),...a})});o.displayName="CardDescription";let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",t),...a})});d.displayName="CardContent",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"},7808:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},8156:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},9169:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},9434:(e,s,t)=>{"use strict";t.d(s,{cn:()=>n});var r=t(2596),a=t(9688);function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,a.QP)((0,r.$)(s))}},9489:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7140).A)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[7590,2354,2099,8441,1684,7358],()=>s(1715)),_N_E=e.O()}]);