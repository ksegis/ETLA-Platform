(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{347:()=>{},6651:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,347,23)),Promise.resolve().then(n.bind(n,7020)),Promise.resolve().then(n.bind(n,7737))},7737:(e,t,n)=>{"use strict";n.d(t,{K:()=>d,TenantProvider:()=>s});var r=n(5155),a=n(2115),i=n(2099),o=n(7020);let l=(0,a.createContext)(void 0);function s(e){let{children:t}=e,{user:n,tenantUser:s,isAuthenticated:d,isDemoMode:u}=(0,o.h)(),[c,m]=(0,a.useState)(null),[_,f]=(0,a.useState)([]),[v,h]=(0,a.useState)(!0),w={id:"demo-tenant-id",name:"Demo Company",domain:"demo.company.com",status:"active",subscription_plan:"professional",subscription_start_date:new Date().toISOString(),max_users:100,current_users:5,settings:{},tenant_id:"demo-tenant-id",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},p=async()=>{if(u){f([w]),m(w),h(!1);return}if(!d||!n){f([]),m(null),h(!1);return}try{if((null==s?void 0:s.role)==="host_admin"){let{data:e,error:t}=await i.ND.from("tenants").select("*").order("name");if(t)throw t;f(e||[]);let n=(null==e?void 0:e[0])||null;m(n)}else{let{data:e,error:t}=await i.ND.from("tenant_users").select("tenant_id").eq("user_id",n.id).eq("is_active",!0);if(t)throw t;if(e&&e.length>0){let t=e.map(e=>e.tenant_id),{data:n,error:r}=await i.ND.from("tenants").select("*").in("id",t).order("name");if(r)throw r;f(n||[]);let a=(null==n?void 0:n.find(e=>e.id===(null==s?void 0:s.tenant_id)))||(null==n?void 0:n[0])||null;m(a)}else f([]),m(null)}}catch(e){console.error("Error loading tenants:",e),f([]),m(null)}finally{h(!1)}};return(0,a.useEffect)(()=>{p()},[d,n,s,u]),(0,r.jsx)(l.Provider,{value:{selectedTenant:c,setSelectedTenant:m,availableTenants:_,isLoading:v,loadAvailableTenants:p,canSelectTenant:()=>!u&&((null==s?void 0:s.role)==="host_admin"||(null==s?void 0:s.role)==="program_manager"),isDemoMode:u},children:t})}function d(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useTenant must be used within a TenantProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[7690,2354,2099,4660,8441,1684,7358],()=>t(6651)),_N_E=e.O()}]);